#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

Процедура ОбработкаПроведения(Отказ, Режим)
	// регистр ЗатратыНаЛиквидациюРисков Приход
	Движения.ЗатратыНаЛиквидациюРисков.Записывать = Истина;
	Движение = Движения.ЗатратыНаЛиквидациюРисков.Добавить();
	Движение.ВидДвижения = ВидДвиженияНакопления.Приход;
	Движение.Период				 = Дата;
	Движение.РисковоеСобытие	 = Ссылка;
	Движение.Стадия				 = Справочники.СтадииМероприятий.ВводРисковогоСобытия;
	Движение.Сумма				 = ПлановыеЗатраты;
	Движение.Автор				 = Ответственный;
КонецПроцедуры

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	Ответственный = Пользователи.ТекущийПользователь();
	Если ТипЗнч(ДанныеЗаполнения) = Тип("СправочникСсылка.Риски") Тогда
		ИсточникРиска	 = ДанныеЗаполнения.ИсточникРиска;
		Организация		 = ДанныеЗаполнения.Организация;
		Основание		 = ДанныеЗаполнения.Основание;
		Проект			 = ДанныеЗаполнения.Проект;
		Риск			 = ДанныеЗаполнения.Ссылка;
		ТипОснования	 = ДанныеЗаполнения.ТипОснования;
		Цель			 = ДанныеЗаполнения.Цель;
		ЦФО				 = ДанныеЗаполнения.ЦФО;
		Если СокрЛП(НаименованиеСобытия) = "" Тогда
			НаименованиеСобытия = НСтр("ru = 'Инцидент по риску %Риск% от %Дата%'");
			НаименованиеСобытия = СтрЗаменить(НаименованиеСобытия, "%Риск%", Строка(ДанныеЗаполнения));
			НаименованиеСобытия = СтрЗаменить(НаименованиеСобытия, "%Дата%", Строка(ТекущаяДатаСеанса()));
		Иначе
			// Наименование уже установлено.
		КонецЕсли;	
	Иначе
		// Неизвестный вариант заполнения.
	КонецЕсли;
КонецПроцедуры

#КонецЕсли