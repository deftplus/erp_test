// Возвращает ссылку на документ Ответ на запрос данных налогового мониторинга, 
// который сопоставлен документу ДокументЗапросВход.
&НаСервере
Функция НайтиОтветНаЗапросДанных(ДокументЗапросВход, ЗапросОтклоненВход)
	РезультатФункции = Документы.ОтветНаЗапросНалоговогоМониторинга.НайтиОтветНаЗапросДанных(ДокументЗапросВход, ЗапросОтклоненВход);
	Возврат РезультатФункции;
КонецФункции		 // НайтиОтветНаЗапросДанных()

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	НайденныйОтвет = НайтиОтветНаЗапросДанных(ПараметрКоманды, Ложь);
	ЕстьОтветНаЗапрос = ЗначениеЗаполнено(НайденныйОтвет);
	Если НЕ ЕстьОтветНаЗапрос Тогда
		НайденныйОтвет = НайтиОтветНаЗапросДанных(ПараметрКоманды, Истина);
		Если ЗначениеЗаполнено(НайденныйОтвет) Тогда
			// Ответ найден. Откроем его.
			ПараметрыФормы = Новый Структура;
			ПараметрыФормы.Вставить("Ключ", НайденныйОтвет);
			ОткрытьФорму("Документ.ОтветНаЗапросНалоговогоМониторинга.Форма.ФормаДокументаОтклонения", ПараметрыФормы);
		Иначе
			ПараметрыФормы = Новый Структура("Основание", ПараметрКоманды);
			ОткрытьФорму("Документ.ОтветНаЗапросНалоговогоМониторинга.Форма.ФормаДокументаОтклонения", ПараметрыФормы, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно, ПараметрыВыполненияКоманды.НавигационнаяСсылка);
		КонецЕсли;
	Иначе
		ТекстСообщения = НСтр("ru = 'По запросу %Запрос% введен ответ. Операция отменена.'");
		ТекстСообщения = СтрЗаменить(ТекстСообщения, "%Запрос%", Строка(ПараметрКоманды));
		ОбщегоНазначенияУХ.СообщитьОбОшибке(ТекстСообщения);
	КонецЕсли;
КонецПроцедуры
