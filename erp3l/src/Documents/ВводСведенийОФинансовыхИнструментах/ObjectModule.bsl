
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)

	ТипДанныхЗаполнения = ТипЗнч(ДанныеЗаполнения);
	
	Если ДанныеЗаполнения = Неопределено Тогда 
		
		ИнициализироватьДокумент(ДанныеЗаполнения);
		
	ИначеЕсли ТипДанныхЗаполнения = Тип("Структура") Тогда 
		
		Если ДанныеЗаполнения.Свойство("ЗаполнитьДокумент") И ДанныеЗаполнения.ЗаполнитьДокумент = Истина Тогда
			
			ЗаполнениеДокументов.Заполнить(ЭтотОбъект, ДанныеЗаполнения);
			Документы.ВводСведенийОФинансовыхИнструментах.ЗаполнитьДокумент(ЭтотОбъект);
			
		ИначеЕсли ДанныеЗаполнения.Свойство("ИсточникЗаполнения") И ДанныеЗаполнения.ИсточникЗаполнения = "ДокументыОснования" Тогда
			
			ЗаполнитьПоДокументамОснованиям(ДанныеЗаполнения);
			
		ИначеЕсли ДанныеЗаполнения.Свойство("ЗаполнитьПриИмпорте") И ДанныеЗаполнения.ЗаполнитьПриИмпорте = Истина Тогда
		
			Если ЭтотОбъект.Проценты.Количество() > 0 Тогда
				
				ПараметрыЗаполнения = Новый Структура("РассчитатьЭСП,РассчитатьЧПС,ЗаполнитьГрафикиМСФО,ЗаполнитьФИМСФО"
				, Истина, Истина, Истина, Истина);
				//**Документы.ВводСведенийОФинансовыхИнструментах.ЗаполнитьСтроки(ЭтотОбъект.ФинансовыеИнструменты, Новый Структура("Объект", ЭтотОбъект), ПараметрыЗаполнения);
				
			КонецЕсли;		
			
		ИначеЕсли ДанныеЗаполнения.Свойство("АдресТаблицы") Тогда
			
			МСФОВызовСервераУХ.ЗаполнитьПоТаблицеЗагрузки(ЭтотОбъект, ДанныеЗаполнения);
		
		Иначе
			ИнициализироватьДокумент(ДанныеЗаполнения);
		КонецЕсли;	
		
	ИначеЕсли Метаданные().ВводитсяНаОсновании.Содержит(ДанныеЗаполнения.Метаданные()) Тогда		
		
		ЗаполнитьПоДокументамОснованиям(ДанныеЗаполнения);
		
	Иначе
		
		ИнициализироватьДокумент(ДанныеЗаполнения);
		
	КонецЕсли;
 		
КонецПроцедуры

Процедура ПриКопировании(ОбъектКопирования)
	
	ИнициализироватьДокумент(ОбъектКопирования);
	
КонецПроцедуры

Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
	
КонецПроцедуры

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	ПроведениеСерверУХ.ПередЗаписью(ЭтотОбъект, Отказ, РежимЗаписи, РежимПроведения);	
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	
	ПроведениеСерверУХ.ИнициализироватьДополнительныеСвойстваДляПроведения(Ссылка, ДополнительныеСвойства, РежимПроведения);
	Документы.ВводСведенийОФинансовыхИнструментах.ПодготовитьПараметрыПроведения(ДополнительныеСвойства, Отказ);
	
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	ПроведениеСерверУХ.ПодготовитьНаборыЗаписейКРегистрацииДвижений(ЭтотОбъект);	
	ПроведениеСерверУХ.ЗагрузитьТаблицыДвижений(ДополнительныеСвойства, Движения);
	ПроведениеСерверУХ.ОбработкаПроведения_ЗаписьИКонтроль(ЭтотОбъект, Отказ);	
		
КонецПроцедуры

Процедура ОбработкаУдаленияПроведения(Отказ)
	ПроведениеСерверУХ.ОбработкаУдаленияПроведения(ЭтотОбъект, Отказ);
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ИнициализироватьДокумент(ДанныеЗаполнения = Неопределено)
	МСФОУХ.ОбработкаЗаполнения(ЭтотОбъект, ДанныеЗаполнения);
КонецПроцедуры

Процедура ЗаполнитьПоДокументамОснованиям(ДокументОснование)
	МСФОВызовСервераУХ.ЗаполнитьДокументИзРежимаНСБУ(ЭтотОбъект, ДокументОснование);
КонецПроцедуры

Процедура ЗаполнитьДокумент()

	//если 
	//изменение графика
	//изменение доп расходов
	//
	// заполнить ФИ
	// заполнить допРасходы
	
КонецПроцедуры

#КонецОбласти  

#КонецЕсли
