
#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ОткрытьФормуДеление = Истина;
	ТекстПредупреждения = "";
	
	ОбработкаКомандыНаСервере(ПараметрКоманды, ОткрытьФормуДеление, ТекстПредупреждения);
	
	Если Не ПустаяСтрока(ТекстПредупреждения) Тогда
		ПоказатьПредупреждение(, ТекстПредупреждения);
		Возврат;
	КонецЕсли;
	
	Если ОткрытьФормуДеление Тогда
		
		ОткрытьФорму(
			"Документ.ЭтапПроизводства2_2.Форма.ДелениеДокумента",
			Новый Структура("Ссылка", ПараметрКоманды),
			ПараметрыВыполненияКоманды.Источник,
			ПараметрыВыполненияКоманды.Уникальность,
			ПараметрыВыполненияКоманды.Окно,
			ПараметрыВыполненияКоманды.НавигационнаяСсылка,
			,
			РежимОткрытияОкнаФормы.БлокироватьОкноВладельца);
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура ОбработкаКомандыНаСервере(Ссылка, ОткрытьФормуДеление, ТекстПредупреждения)
	
	Если Не Документы.ЭтапПроизводства2_2.МожноРазделитьДокумент(Ссылка, ТекстПредупреждения) Тогда
		Возврат;
	КонецЕсли;
	
	ТипПроизводственногоПроцесса = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(
		Ссылка,
		"ТипПроизводственногоПроцесса");
	
	Если ТипПроизводственногоПроцесса = Перечисления.ТипыПроизводственныхПроцессов.БезСпецификаций Тогда
		
		Документы.ЭтапПроизводства2_2.РазделитьДокумент(
			Ссылка, 0, Справочники.УпаковкиЕдиницыИзмерения.ПустаяСсылка(), Ложь);
		ОткрытьФормуДеление = Ложь;
		
	Иначе
		ОткрытьФормуДеление = Истина;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти
