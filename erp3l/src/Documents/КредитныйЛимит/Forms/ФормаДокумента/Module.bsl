
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ОрганизацииЛимита = Объект.Организации.Количество() > 1;

	ВидыФИ = Документы.КредитныйЛимит.ВидыФИ();
	
	Если Объект.Ссылка.Пустая() Тогда
		
		ВидыФИ.ЗаполнитьПометки(Истина);
		
	Иначе 
		
		Для каждого СтрокаВидФИ Из Объект.ВидыФинансовыхИнструментов Цикл		
			ВидыФИ.НайтиПоЗначению(СтрокаВидФИ.ВидФинансовогоИнструмента).Пометка = Истина;	
		КонецЦикла;
	
	КонецЕсли;
	
	УправлениеФормой(ЭтотОбъект);
	
КонецПроцедуры

&НаКлиенте
Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
	ЗаполнитьВидыФИ(ЭтотОбъект);
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовФормы

&НаКлиенте
Процедура ОрганизацииЛимитаПриИзменении(Элемент)
	 УправлениеФормой(ЭтотОбъект);
КонецПроцедуры

&НаКлиенте
Процедура ВидыФИПриИзменении(Элемент)	
	ЗаполнитьВидыФИ(ЭтотОбъект);	
КонецПроцедуры

#КонецОбласти

#Область ВспомогательныеПроцедурыФункции

&НаКлиентеНаСервереБезКонтекста
Процедура УправлениеФормой(Форма)

	Форма.Элементы.Организации.Видимость = (Форма.ОрганизацииЛимита > 0);

КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Процедура ЗаполнитьВидыФИ(Форма)
	
	Объект = Форма.Объект;
	
	Объект.ВидыФинансовыхИнструментов.Очистить();
	
	Для каждого ВидФИ Из Форма.ВидыФИ Цикл
		
		Если Не ВидФИ.Пометка Тогда
			Продолжить;
		КонецЕсли;
		
		Объект.ВидыФинансовыхИнструментов.Добавить().ВидФинансовогоИнструмента = ВидФИ.Значение;	
		
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти

