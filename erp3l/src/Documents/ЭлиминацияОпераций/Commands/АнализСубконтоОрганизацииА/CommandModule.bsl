
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	Документ = ПараметрКоманды;
	
	ПараметрыФормы = Новый Структура("Отбор,СформироватьПриОткрытии,КлючВарианта", 
										ПолучитьОтбор(Документ), 
										Истина,
										"АнализСубконто"
									);

	ОткрытьФорму("Отчет.ОСВМСФО.Форма", 
						ПараметрыФормы, 
						ПараметрыВыполненияКоманды.Источник, 
						ПараметрыВыполненияКоманды.Уникальность, 
						ПараметрыВыполненияКоманды.Окно, 
						ПараметрыВыполненияКоманды.НавигационнаяСсылка
				);
	
КонецПроцедуры

&НаСервере
Функция ПолучитьОтбор(Документ)

	ПериодОтчета = Новый СтандартныйПериод(Документ.ПериодОтчета.ДатаНачала, Документ.ПериодОтчета.ДатаОкончания);
	Контрагенты = ОрганизацииВызовСервераУХ.ПолучитьКонтрагентовПоОрганизации(Документ.ОрганизацияБ);
	
	Результат = Новый Структура;	
	Результат.Вставить("Организация", 	Документ.ОрганизацияА);
	Результат.Вставить("Сценарий", 		Документ.Сценарий);
	Результат.Вставить("Период", 		ПериодОтчета);
	//Результат.Вставить("НачалоПериода", ПериодОтчета.ДатаНачала);
	//Результат.Вставить("КонецПериода", 	ПериодОтчета.ДатаОкончания);
	//
	Если Контрагенты.Количество() Тогда
		Результат.Вставить("Субконто1", 	 Контрагенты[0]);
	КонецЕсли;
		
	Возврат Результат;

КонецФункции
