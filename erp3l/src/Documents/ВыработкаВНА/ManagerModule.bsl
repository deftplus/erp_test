#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

#Область ДляВызоваИзДругихПодсистем

// СтандартныеПодсистемы.УправлениеДоступом

// См. УправлениеДоступомПереопределяемый.ПриЗаполненииСписковСОграничениемДоступа.
Процедура ПриЗаполненииОграниченияДоступа(Ограничение) Экспорт

	Ограничение.Текст =
	"РазрешитьЧтениеИзменение
	|ГДЕ
	|	ЗначениеРазрешено(Организация)";

КонецПроцедуры

// Конец СтандартныеПодсистемы.УправлениеДоступом

#КонецОбласти

#КонецОбласти

////////////////////////////////////////////////////////////////////////////////
// ПОДГОТОВКА ПАРАМЕТРОВ ПРОВЕДЕНИЯ ДОКУМЕНТА
//

Функция ПодготовитьПараметрыПроведения(ДополнительныеСвойства, Отказ) Экспорт

	НомераТаблиц = Новый Структура;
	Запрос = Новый Запрос(ТекстЗапросаВНА(НомераТаблиц));
	Запрос.УстановитьПараметр("Ссылка", ДополнительныеСвойства.ДляПроведения.Ссылка);
	
	Возврат ПроведениеСерверУХ.ДополнитьТаблицамиИзПакетаЗапросов(
		ДополнительныеСвойства.ТаблицыДляДвижений, Запрос, НомераТаблиц);
	
КонецФункции

Функция ТекстЗапросаВНА(НомераТаблиц)

	НомераТаблиц.Вставить("ВыработкаВНА", НомераТаблиц.Количество());

	Возврат 
	"ВЫБРАТЬ
	|	Док.Ссылка КАК Регистратор,
	|	Док.Ссылка.Организация КАК Организация,
	|	Док.Ссылка.Сценарий КАК Сценарий,
	|	Док.Ссылка.Дата КАК Период,
	|	Док.ВНА КАК ВНА,
	|	ВидыУчета.Ссылка КАК ВидУчета,
	|	Док.ПараметрВыработки КАК ПараметрВыработки,
	|	ВЫБОР
	|		КОГДА ВидыУчета.Ссылка = ЗНАЧЕНИЕ(Перечисление.ВидыУчета.НСБУ)
	|			ТОГДА Док.КоличествоНСБУ
	|		ИНАЧЕ Док.КоличествоМСФО
	|	КОНЕЦ КАК Количество
	|ИЗ
	|	Документ.ВыработкаВНА.ВНА КАК Док
	|		ЛЕВОЕ СОЕДИНЕНИЕ Перечисление.ВидыУчета КАК ВидыУчета
	|		ПО (ИСТИНА)
	|ГДЕ
	|	Док.Ссылка = &Ссылка";

КонецФункции

//КоллекцияСтрок - ТабличнаяЧасть,ТаблицаЗначений,ДанныеФормыКоллекция, СтрокаТабличнойЧасти
//Источник - ДокументОбъект, ДанныеФормыСтруктура, УправляемаяФорма
//ПараметрыЗаполнения - Структура(ЗаполнитьРеквизиты = Ложь,  ЗаполнитьНСБУ = Ложь, ЗаполнитьМСФО = Ложь)
Процедура ЗаполнитьСтроки(КоллекцияСтрок, Источник, ПараметрыЗаполненияТЧ = Неопределено) Экспорт
 
КонецПроцедуры 

Процедура ЗаполнитьЗависимостиРеквизитовДокумента(ФормаДокумента) Экспорт 

	ФормаДокумента.ЗависимостиРеквизитов.Очистить();
	ЗависимостиРеквизитов = ФормаДокумента.ЗависимостиРеквизитов;
	
КонецПроцедуры

Функция ПолучитьИменаСубконто() Экспорт 

	Результат = Новый Структура;
	Возврат Результат;
	
КонецФункции

#КонецЕсли