
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	
	Если ДанныеЗаполнения = Неопределено Тогда
		
		ИнициализироватьДокумент(ДанныеЗаполнения);
			
	Иначе
		
		ТипДанныхЗаполнения = ТипЗнч(ДанныеЗаполнения);
		Если ТипДанныхЗаполнения = Тип("Структура") Тогда
			
			Если ДанныеЗаполнения.Свойство("ЗаполнитьДокумент") И ДанныеЗаполнения.ЗаполнитьДокумент = Истина Тогда
				Документы.ПереоценкаФинансовыхИнструментов.ЗаполнитьДокумент(ЭтотОбъект, Истина);
			ИначеЕсли ДанныеЗаполнения.Свойство("АдресТаблицы") Тогда			
				МСФОВызовСервераУХ.ЗаполнитьПоТаблицеЗагрузки(ЭтотОбъект, ДанныеЗаполнения);
			КонецЕсли;

		Иначе
		    		
		КонецЕсли;
		
	КонецЕсли;
		
КонецПроцедуры

Процедура ПриКопировании(ОбъектКопирования)
	
	ИнициализироватьДокумент(ОбъектКопирования);
	
КонецПроцедуры

Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
	
	НепроверяемыеРеквизиты = Новый Массив;
	                
	Если ВидОперации <> ПредопределенноеЗначение("Перечисление.ВидыОперацийПоФинансовымИнструментамМСФО.Признание") Тогда
		НепроверяемыеРеквизиты.Добавить("ФинансовыеИнструменты.ДатаПризнания");	
	КонецЕсли;
	
	Если ВидОперации <> ПредопределенноеЗначение("Перечисление.ВидыОперацийПоФинансовымИнструментамМСФО.Выбытие") Тогда
		НепроверяемыеРеквизиты.Добавить("ФинансовыеИнструменты.ДатаВыбытия");	
	КонецЕсли;
	
	ОбщегоНазначенияУХ.УдалитьНепроверяемыеРеквизитыИзМассива(ПроверяемыеРеквизиты, НепроверяемыеРеквизиты);
			
КонецПроцедуры

Процедура ПередЗаписью(Отказ, РежимЗаписи, РежимПроведения)
	ПроведениеСерверУХ.ПередЗаписью(ЭтотОбъект, Отказ, РежимЗаписи, РежимПроведения);
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	
	ПроведениеСерверУХ.ИнициализироватьДополнительныеСвойстваДляПроведения(Ссылка, ДополнительныеСвойства, РежимПроведения);
	Документы.ПереоценкаФинансовыхИнструментов.ПодготовитьПараметрыПроведения(ДополнительныеСвойства, Отказ);
		
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	ПроведениеСерверУХ.ПодготовитьНаборыЗаписейКРегистрацииДвижений(ЭтотОбъект);	
	Документы.ПереоценкаФинансовыхИнструментов.СформироватьДвижения(Движения, ДополнительныеСвойства, Отказ);
	ПроведениеСерверУХ.ОбработкаПроведения_ЗаписьИКонтроль(ЭтотОбъект, Отказ);
		
КонецПроцедуры

Процедура ОбработкаУдаленияПроведения(Отказ)
	ПроведениеСерверУХ.ОбработкаУдаленияПроведения(ЭтотОбъект, Отказ);
КонецПроцедуры

#КонецОбласти

Процедура ИнициализироватьДокумент(ДанныеЗаполнения = Неопределено)
	
	МСФОУХ.ОбработкаЗаполнения(ЭтотОбъект, ДанныеЗаполнения);
	
	Если Не ПериодОтчета.Пустая() Тогда
		Дата = КонецДня(ПериодОтчета.ДатаОкончания);
	КонецЕсли;
		
КонецПроцедуры

#КонецЕсли

