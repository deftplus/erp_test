
&НаКлиенте
Процедура ЗаписатьИЗакрыть(Команда)
	
	Форма=ПолучитьФорму(ФормаИмя,Новый Структура("Ключ",ТекСсылка )); 
	
	Попытка
	Форма.Объект.НСИ_ЭталонныйЭлемент= ЭтаФорма["НСИ_ЭталонныйЭлемент"];
	Форма.Объект.НСИ_ВИБ= ЭтаФорма["НСИ_ВИБ"];
	Форма.Объект.НСИ_НеАктивный= ЭтаФорма["НСИ_НеАктивный"];
	Форма.Объект.НСИ_ТребуетСинхронизации= ЭтаФорма["НСИ_ТребуетСинхронизации"];
	
	Форма.Модифицированность=Истина;
	Исключение
		ЗаписатьОбъектНаСервере()
		
	КонецПопытки;
	
	ЭтаФорма.Закрыть();
	
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ТекСсылка=Параметры.Ссылка;
	ФормаИмя=Параметры.ИмяФормы;
	
	МассивДобавляемых=Новый Массив;	
	//
	МассивДобавляемых.Добавить(Новый РеквизитФормы("НСИ_ЭталонныйЭлемент",
	Новый ОписаниеТипов(СтрЗаменить(Метаданные.НайтиПоТипу(ТипЗнч(ТекСсылка)).ПолноеИмя(),".","Ссылка.")),
	"",
	"ЭталонныйЭлемент",
	Ложь));
	
	МассивДобавляемых.Добавить(Новый РеквизитФормы("НСИ_ВИБ",
	Новый ОписаниеТипов("СправочникСсылка.ВнешниеИнформационныеБазы"),
	"",
	"Внешняя ИБ",
	Ложь));
	
	МассивДобавляемых.Добавить(Новый РеквизитФормы("НСИ_НеАктивный",
	Новый ОписаниеТипов("Булево"),
	"",
	"Не активный",
	Ложь));
	
	МассивДобавляемых.Добавить(Новый РеквизитФормы("НСИ_ТребуетСинхронизации",
	Новый ОписаниеТипов("Булево"),
	"",
	"Требует синхронизации",
	Ложь));
	
	МассивДобавляемых.Добавить(Новый РеквизитФормы("НСИ_Автор",
	Новый ОписаниеТипов("СправочникСсылка.Пользователи"),
	"",
	"Автор",
	Ложь));
	
	МассивДобавляемых.Добавить(Новый РеквизитФормы("НСИ_ДатаИзменения",
	Новый ОписаниеТипов("Дата"),
	"",
	"Дата изменения",
	Ложь));
	
	МассивДобавляемых.Добавить(Новый РеквизитФормы("НСИ_ПоследнийРедактировавший",
	Новый ОписаниеТипов("СправочникСсылка.Пользователи"),
	"",
	"Последний редактировавший",
	Ложь));
	
	ИзменитьРеквизиты(МассивДобавляемых);
	
	ЭтаФорма.Элементы.Добавить("НСИ_ЭталонныйЭлемент", Тип("ПолеФормы"), );	
	ЭтаФорма.Элементы["НСИ_ЭталонныйЭлемент"].ПутьКДанным="НСИ_ЭталонныйЭлемент";
	ЭтаФорма.Элементы["НСИ_ЭталонныйЭлемент"].Вид=ВидПоляФормы.ПолеВвода;
	ЭтаФорма.Элементы["НСИ_ЭталонныйЭлемент"].ДоступныеТипы=
	Новый ОписаниеТипов(СтрЗаменить(Метаданные.НайтиПоТипу(ТипЗнч(ТекСсылка)).ПолноеИмя(),".","Ссылка."));
	ЭтаФорма.Элементы["НСИ_ЭталонныйЭлемент"].КнопкаВыбора=Истина;
	ЭтаФорма.Элементы["НСИ_ЭталонныйЭлемент"].КнопкаОчистки=Истина;
	ЭтаФорма.Элементы["НСИ_ЭталонныйЭлемент"].КнопкаОткрытия=Истина;
	ЭтаФорма["НСИ_ЭталонныйЭлемент"]=ТекСсылка.НСИ_ЭталонныйЭлемент;
	 
	ЭтаФорма.Элементы.Добавить("НСИ_ВИБ", Тип("ПолеФормы"), );	
	ЭтаФорма.Элементы["НСИ_ВИБ"].ПутьКДанным="НСИ_ВИБ";
	ЭтаФорма.Элементы["НСИ_ВИБ"].Вид=ВидПоляФормы.ПолеВвода;
	ЭтаФорма.Элементы["НСИ_ВИБ"].ДоступныеТипы=
	Новый ОписаниеТипов("СправочникСсылка.ВнешниеИнформационныеБазы");
	ЭтаФорма.Элементы["НСИ_ВИБ"].КнопкаВыбора=Истина;
	ЭтаФорма.Элементы["НСИ_ВИБ"].КнопкаОчистки=Истина;
	ЭтаФорма.Элементы["НСИ_ВИБ"].КнопкаОткрытия=Истина;
	ЭтаФорма["НСИ_ВИБ"]=ТекСсылка.НСИ_ВИБ;
	ЭтаФорма.Элементы["НСИ_ВИБ"].ТолькоПросмотр=Истина;
 
	ЭтаФорма.Элементы.Добавить("НСИ_НеАктивный", Тип("ПолеФормы"), );	
	ЭтаФорма.Элементы["НСИ_НеАктивный"].ПутьКДанным="НСИ_НеАктивный";
	ЭтаФорма.Элементы["НСИ_НеАктивный"].Вид=ВидПоляФормы.ПолеФлажка;
	ЭтаФорма["НСИ_НеАктивный"]=ТекСсылка.НСИ_НеАктивный;
 
	ЭтаФорма.Элементы.Добавить("НСИ_ТребуетСинхронизации", Тип("ПолеФормы"), );	
	ЭтаФорма.Элементы["НСИ_ТребуетСинхронизации"].ПутьКДанным="НСИ_ТребуетСинхронизации";
	ЭтаФорма.Элементы["НСИ_ТребуетСинхронизации"].Вид=ВидПоляФормы.ПолеФлажка;
	ЭтаФорма["НСИ_ТребуетСинхронизации"]=ТекСсылка.НСИ_ТребуетСинхронизации;
	
	  
	ЭтаФорма.Элементы.Добавить("НСИ_Автор", Тип("ПолеФормы"), );	
	ЭтаФорма.Элементы["НСИ_Автор"].ПутьКДанным="НСИ_Автор";
	ЭтаФорма.Элементы["НСИ_Автор"].Вид=ВидПоляФормы.ПолеВвода;
	ЭтаФорма.Элементы["НСИ_Автор"].ДоступныеТипы=
	Новый ОписаниеТипов("СправочникСсылка.Пользователи");
	ЭтаФорма.Элементы["НСИ_Автор"].КнопкаВыбора=Ложь;
	ЭтаФорма.Элементы["НСИ_Автор"].КнопкаОчистки=Ложь;
	ЭтаФорма.Элементы["НСИ_Автор"].КнопкаОткрытия=Истина;
	ЭтаФорма["НСИ_Автор"]=ТекСсылка.НСИ_Автор;
	ЭтаФорма.Элементы["НСИ_Автор"].ТолькоПросмотр=Истина;	
	
	ЭтаФорма.Элементы.Добавить("НСИ_ПоследнийРедактировавший", Тип("ПолеФормы"), );	
	ЭтаФорма.Элементы["НСИ_ПоследнийРедактировавший"].ПутьКДанным="НСИ_ПоследнийРедактировавший";
	ЭтаФорма.Элементы["НСИ_ПоследнийРедактировавший"].Вид=ВидПоляФормы.ПолеВвода;
	ЭтаФорма.Элементы["НСИ_ПоследнийРедактировавший"].ДоступныеТипы=
	Новый ОписаниеТипов("СправочникСсылка.Пользователи");
	ЭтаФорма.Элементы["НСИ_ПоследнийРедактировавший"].КнопкаВыбора=Ложь;
	ЭтаФорма.Элементы["НСИ_ПоследнийРедактировавший"].КнопкаОчистки=Ложь;
	ЭтаФорма.Элементы["НСИ_ПоследнийРедактировавший"].КнопкаОткрытия=Истина;
	ЭтаФорма["НСИ_ПоследнийРедактировавший"]=ТекСсылка.НСИ_ПоследнийРедактировавший;
	ЭтаФорма.Элементы["НСИ_ПоследнийРедактировавший"].ТолькоПросмотр=Истина;

	
	
КонецПроцедуры


&НаСервере
Процедура ЗаписатьОбъектНаСервере()

	ТекОбъект=ТекСсылка.ПолучитьОбъект();
	ТекОбъект.НСИ_ЭталонныйЭлемент= ЭтаФорма["НСИ_ЭталонныйЭлемент"];
	ТекОбъект.НСИ_ВИБ= ЭтаФорма["НСИ_ВИБ"];
	ТекОбъект.НСИ_НеАктивный= ЭтаФорма["НСИ_НеАктивный"];
	ТекОбъект.НСИ_ТребуетСинхронизации= ЭтаФорма["НСИ_ТребуетСинхронизации"];	
	ТекОбъект.Записать();
	
КонецПроцедуры	