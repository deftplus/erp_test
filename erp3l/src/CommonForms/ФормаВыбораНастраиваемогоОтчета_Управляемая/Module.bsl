
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ТипОтбора = Тип("ЭлементОтбораКомпоновкиДанных");
	
	МассивРасшифровок = ТиповыеОтчетыУХ.ПолучитьМассивПолейРасшифровки(Параметры.Расшифровка, Параметры.АдресДанныхРасшифровки, , Истина);
	МассивДопОтборов  = Новый Массив;
	ПолеЗначение      = Новый ПолеКомпоновкиДанных("Значение");
	
	Для Каждого ЭлементРасшифровки Из МассивРасшифровок Цикл
		
		Если ТипЗнч(ЭлементРасшифровки) = ТипОтбора И СписокОтчетов.Отбор.ДоступныеПоляОтбора.Элементы.Найти(ЭлементРасшифровки.ЛевоеЗначение) <> Неопределено Тогда
			
			НовыйОтбор = СписокОтчетов.Отбор.Элементы.Добавить(ТипОтбора);
			ЗаполнитьЗначенияСвойств(НовыйОтбор, ЭлементРасшифровки);
			НовыйОтбор.Использование = Истина;
			
		ИначеЕсли ТипЗнч(ЭлементРасшифровки) <> ТипОтбора Тогда
			
			ПолеОтбора = СписокОтчетов.Отбор.ДоступныеПоляОтбора.Элементы.Найти(ЭлементРасшифровки.Поле);
			Если ПолеОтбора <> Неопределено И ПолеОтбора.Поле <> ПолеЗначение Тогда
				МассивДопОтборов.Добавить(Новый Структура("ЛевоеЗначение,ВидСравнения, ПравоеЗначение" 
														  , ПолеОтбора.Поле
														  , ?(ТипЗнч(ЭлементРасшифровки.Значение) = Тип("СписокЗначений"), ?(ЭлементРасшифровки.Иерархия, ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии, ВидСравненияКомпоновкиДанных.ВСписке), ?(ЭлементРасшифровки.Иерархия, ВидСравненияКомпоновкиДанных.ВИерархии, ВидСравненияКомпоновкиДанных.Равно))
														  , ЭлементРасшифровки.Значение));
			КонецЕсли;

		КонецЕсли;
		
	КонецЦикла;
	
	Для Каждого ЭлементРасшифровки Из МассивДопОтборов Цикл
		НовыйОтбор = СписокОтчетов.Отбор.Элементы.ДОбавить(ТипОтбора);
		ЗаполнитьЗначенияСвойств(НовыйОтбор, ЭлементРасшифровки);
		НовыйОтбор.Использование = Истина;
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура СписокОтчетовВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	ТекСтрока = Элементы.СписокОтчетов.ДанныеСтроки(ВыбраннаяСтрока).НастраиваемыйОтчет;
	Закрыть(ТекСтрока);
	
КонецПроцедуры
