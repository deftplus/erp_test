
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Параметры.Свойство("ИмяСправочника"   , ИмяСправочника);
	Параметры.Свойство("Владелец"         , Владелец);
	
	Для Каждого Элемент ИЗ Параметры.ТекСписокЗначений Цикл
		
		НовоеЗначение = ТаблицаЗначений.Добавить();
		НовоеЗначение.Значение = Элемент.Значение;
		
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура СписокЗначенийЗначениеНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	Если ЗначениеЗаполнено(Владелец) Тогда
		ОткрытьФорму(ИмяСправочника + ".ФормаВыбора"
					, Новый Структура("Отбор,ВыборГруппИЭлементов,РежимВыбора", Новый Структура("Владелец", Владелец),ИспользованиеГруппИЭлементов.ГруппыИЭлементы,Истина), Элемент);
	Иначе
		ОткрытьФорму(ИмяСправочника + ".ФормаВыбора"
					,Новый Структура("ВыборГруппИЭлементов,РежимВыбора", ИспользованиеГруппИЭлементов.ГруппыИЭлементы,Истина) , Элемент);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура Подбор(Команда)
	
	Если ЗначениеЗаполнено(Владелец) Тогда
		ОткрытьФорму(ИмяСправочника + ".ФормаВыбора"
					, Новый Структура("Отбор, ЗакрыватьПриВыборе,ВыборГруппИЭлементов,РежимВыбора", Новый Структура("Владелец", Владелец), Ложь,ИспользованиеГруппИЭлементов.ГруппыИЭлементы,Истина), ЭтаФорма);
	Иначе
		ОткрытьФорму(ИмяСправочника + ".ФормаВыбора"
					, Новый Структура("ЗакрыватьПриВыборе,ВыборГруппИЭлементов,РежимВыбора", Ложь,ИспользованиеГруппИЭлементов.ГруппыИЭлементы,Истина), ЭтаФорма);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
		
	Результат=Новый СписокЗначений;
	
	Для Каждого СтрЗначение ИЗ ТаблицаЗначений Цикл
		Результат.Добавить(СтрЗначение.Значение);
	КонецЦикла;
	
	ОповеститьОВыборе(Результат);
	
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаВыбора(ВыбранноеЗначение, ИсточникВыбора)
	
	Если ТаблицаЗначений.НайтиСтроки(Новый Структура("Значение", ВыбранноеЗначение)).Количество() = 0 Тогда
		
		ТаблицаЗначений.Добавить().Значение = ВыбранноеЗначение;
		
	КонецЕсли;
	
КонецПроцедуры
