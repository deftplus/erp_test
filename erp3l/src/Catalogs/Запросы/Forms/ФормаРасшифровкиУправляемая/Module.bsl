
&НаСервере

Процедура ОбновитьОтчет()
	
	Перем ДанныеРасшифровки;
	
	СКД = ИсточникДанных.СхемаКомпоновкиДанных.Получить();
	
	АдресСхемыКомпоновкиДанных = ПоместитьВоВременноеХранилище(СКД);
	НастройкиКомпоновщика = Новый НастройкиКомпоновкиДанных;
	КомпоновщикМакета     = Новый КомпоновщикМакетаКомпоновкиДанных;
	
	МакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СКД, НастройкиКомпоновщика, ДанныеРасшифровки, , Тип("ГенераторМакетаКомпоновкиДанных"));
	
	ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных);
	
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(Результат);
	ПроцессорВывода.НачатьВывод();

	Пока Истина Цикл
		ЭлементРезультатаКомпоновкиДанных = ПроцессорКомпоновкиДанных.Следующий();
		Если ЭлементРезультатаКомпоновкиДанных = Неопределено Тогда
			Прервать;
		КонецЕсли;
		ПроцессорВывода.ВывестиЭлемент(ЭлементРезультатаКомпоновкиДанных);
	КонецЦикла;

	ПроцессорВывода.ЗакончитьВывод();
	
	АдресДанныеРасшифровки = ПоместитьВоВременноеХранилище(ДанныеРасшифровки);
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Параметры.Свойство("АдресМассиваРасшифровок" , АдресМассиваРасшифровок);
	Параметры.Свойство("АдресСтруктурыПараметров", АдресСтруктурыПараметров);
	Параметры.Свойство("ИсточникДанных"          , ИсточникДанных);
	
	ОбновитьОтчет();
	
КонецПроцедуры

&НаКлиенте
Процедура РезультатОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)
	// Вставить содержимое обработчика.
КонецПроцедуры
