Функция Переместить(Ссылка, Смещение) Экспорт
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	КонтрольныеСоотношения.Код,
	|	КонтрольныеСоотношения.Владелец
	|ПОМЕСТИТЬ Т
	|ИЗ
	|	Справочник.КонтрольныеСоотношения КАК КонтрольныеСоотношения
	|ГДЕ
	|	КонтрольныеСоотношения.Ссылка = &Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МАКСИМУМ(КонтрольныеСоотношения.Код) КАК Код,
	|	КонтрольныеСоотношения.Владелец
	|ПОМЕСТИТЬ КодВладелец
	|ИЗ
	|	Т КАК Т
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КонтрольныеСоотношения КАК КонтрольныеСоотношения
	|		ПО Т.Владелец = КонтрольныеСоотношения.Владелец
	|			И Т.Код > КонтрольныеСоотношения.Код
	|
	|СГРУППИРОВАТЬ ПО
	|	КонтрольныеСоотношения.Владелец
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ ПЕРВЫЕ 1
	|	КонтрольныеСоотношения.Ссылка
	|ИЗ
	|	КодВладелец КАК КодВладелец
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КонтрольныеСоотношения КАК КонтрольныеСоотношения
	|		ПО КодВладелец.Код = КонтрольныеСоотношения.Код
	|			И КодВладелец.Владелец = КонтрольныеСоотношения.Владелец";
	
	Если Смещение > 0 Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, ">", "<");
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "МАКСИМУМ", "МИНИМУМ");
	КонецЕсли;
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("Ссылка", Ссылка);
	Запрос.Текст = ТекстЗапроса;
	
	НачатьТранзакцию();
	РезультатЗапроса = Запрос.Выполнить();
	
	Если НЕ РезультатЗапроса.Пустой() Тогда
		
		Объект1 = Ссылка.ПолучитьОбъект();
		Объект2 = РезультатЗапроса.Выгрузить()[0].Ссылка.ПолучитьОбъект();
		
		Код = Объект1.Код;
		
		Объект1.Код = Объект2.Код;
		Объект2.Код = Код;
		
		Объект1.ОбменДанными.Загрузка = Истина;
		Объект1.Записать();
		
		Объект2.Записать();
		
		Объект1.ОбменДанными.Загрузка = Ложь;
		Объект1.Записать();
		
	КонецЕсли;
	
	ЗафиксироватьТранзакцию();
	
	Возврат НЕ РезультатЗапроса.Пустой();
	
КонецФункции
