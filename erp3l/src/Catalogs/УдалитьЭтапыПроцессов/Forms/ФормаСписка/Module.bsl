
////////////////////////////////////////////////////////////////////////////////
// ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ.
//

Процедура УстановитьОтборПоВладельцу()
	
	ПолеВладелец = Новый ПолеКомпоновкиДанных("Владелец");
	
	ПолеОтбора   = Неопределено;
	Для Каждого Элемент Из Список.Отбор.Элементы Цикл
		Если Элемент.ЛевоеЗначение = ПолеВладелец Тогда
			ПолеОтбора = Элемент;
			Прервать;
		КонецЕсли;
	КонецЦикла;
	
	Если ПолеОтбора = Неопределено Тогда
		
		ПолеОтбора = Список.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
		ПолеОтбора.ЛевоеЗначение = ПолеВладелец;
		
	КонецЕсли;
	
	ПолеОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;
	ПолеОтбора.ПравоеЗначение = ШаблонПроцесса;
	ПолеОтбора.Использование  = Истина;
	
КонецПроцедуры

&НаСервереБезКонтекста
Функция РассчитатьДлительностьПроцесса(ШаблонПроцесса)
	
	Возврат 0;
	
КонецФункции

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ.
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Отбор.Свойство("Владелец") Тогда
		ШаблонПроцесса = Параметры.Отбор.Владелец;
	КонецЕсли;
	
	ДлительностьПроцесса = НСтр("ru = '<не рассчитана>'")
	
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ФОРМЫ.
//
&НаКлиенте
Процедура ШаблонПроцессаПриИзменении(Элемент)
	
	УстановитьОтборПоВладельцу();
	
КонецПроцедуры

&НаКлиенте
Процедура СхемаШаблонаПроцесса(Команда)
	
	ОткрытьФорму("Отчет.СетеваяДиаграммаШаблонаУниверсальногоПроцесса.ФормаОбъекта", Новый Структура("ШаблонПроцесса", ШаблонПроцесса));
	
КонецПроцедуры

&НаКлиенте
Процедура РассчитатьДлительность(Команда)
	
	Длительность = РассчитатьДлительностьПроцесса(ШаблонПроцесса);
	Если Длительность = Неопределено Тогда
		ДлительностьПроцесса = НСтр("ru = '<не рассчитана>'")
	Иначе
		ДлительностьПроцесса = "" + Длительность + НСтр("ru = ' дн.'");
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ДлительностьПроцессаНажатие(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	РассчитатьДлительность(Неопределено);
	
КонецПроцедуры
