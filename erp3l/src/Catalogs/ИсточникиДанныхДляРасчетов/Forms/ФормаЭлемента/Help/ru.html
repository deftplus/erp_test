<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta http-equiv="content-type" content="text/html;charset=utf-8"></meta><link rel="stylesheet" type="text/css" href="__STYLE__"></link></head><body>
<h2>Использование произвольных запросов при расчете значений показателей</h2>
<div><b><br></b></div>
<div>В настоящий момент доступны 2 режима расчета показателей с помощью произвольного запроса к ИБ: обычный, в цикле по периодам отчета или в контексте всего многопериодного экземпляра отчета. </div>
<div><br></div>
<div>Переключение между режимами осуществляется с помощью флага "<b>Использовать многопериодный контекст</b>":</div>
<div><b><br></b></div>
<div><b><img src="_files/001.png" border="1"></img></b></div>
<div><br></div>
<div>Режим доступен только при использовании расширенного алгоритма пересчета показателей.</div>
<div><br></div>
<div>При использовании многопериодного контекста запрос выполняется один раз в контексте всего экземпляра отчета. При этом в выходных полях запроса обязательно должно быть поле с типом "Дата", для определения подпериода, в который будет помещена данная строка результата запроса. Период определяется по вхождению даты в конкретный подпериод экземпляра отчета. </div>
<div><br></div>
<div><img src="_files/003.png" border="1"></img></div>
<div><br></div>
<div>Сопоставление выходных полей осуществляется на закладке "<b>Правила заполнения полей</b>". Выходное поле, отвечающее за период, обязательно должно быть сопоставлено с предопределенной аналитикой "<b>Период</b>".</div>
<div><br><img src="_files/004.png" border="1"></img></div>
<div><br></div>
<div>Значения отборов "<b>Дата начала периода отчета</b>", "<b>Дата конца периода отчета</b>" и др. в этом случае интерпретируются как дата начала и дата окончания <b>ВСЕГО</b> экземпляра отчета (а не каждого из входящих в экземпляр отчета подпериодов).</div>
<div><br></div>
<div><img src="_files/005.png" border="1"></img></div>
<div><br></div>
<div>Если многопериодный контекст <b>НЕ</b> используется, то запрос выполняется <b>в цикле</b> для каждого из подпериодов, входящих в экземпляр отчета.</div>
<div>Из-за низкой производительности данный режим рекомендуется использовать только в тех случаях, когда использование многопериодного контекста затруднительно или невозможно. Например, если требуется получать срез последних из регистра сведений для каждого подпериода, входящего в экземпляр отчета. </div>
<div><br></div>
<div><br></div>
<div><br></div></body></html>