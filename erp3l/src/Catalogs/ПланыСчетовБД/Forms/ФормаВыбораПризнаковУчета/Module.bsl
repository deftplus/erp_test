
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если не Параметры.Свойство("ПризнакиУчета") Тогда
		Отказ = Истина;
		Возврат;
	КонецЕсли;
	
	Параметры.ЗакрыватьПриВыборе = Истина;
	Параметры.ЗакрыватьПриЗакрытииВладельца = Истина;
	
	Если ЗначениеЗаполнено(Параметры.ПланСчетов) Тогда
		
		ПризнакиУчетаВладелецСтрока=?(Параметры.ДляСубконто,Параметры.ПланСчетов.ПризнакиУчетаСубконто,Параметры.ПланСчетов.ПризнакиУчета);
		ПризнакиУчетаВладелец=ОбщегоНазначенияУХ.РазложитьСтрокуВМассивПодстрок(ПризнакиУчетаВладелецСтрока, ";");
		
		Для Каждого ПризнакУчета Из ПризнакиУчетаВладелец Цикл
			
			ДобавитьПризнакУчета(ПризнакУчета);
			
		КонецЦикла;
		
	КонецЕсли;
		
	ПризнакиУчетаСтрока = Параметры.ПризнакиУчета;

	Если ПризнакиУчетаСтрока <> "" Тогда
		
		мПризнакиУчета=ОбщегоНазначенияУХ.РазложитьСтрокуВМассивПодстрок(ПризнакиУчетаСтрока, ";");
		Для каждого ПризнакУчета Из мПризнакиУчета Цикл
			ДобавитьПризнакУчета(ПризнакУчета);
		КонецЦикла;
		
	КонецЕсли;
 	
КонецПроцедуры

&НаСервере
Процедура ДобавитьПризнакУчета(ИмяПризнака)
	Перем ИмяПризнака_, флУстановлен;
	
	ИмяПризнака_ = СокрЛП(ИмяПризнака);
	флУстановлен = (СтрНайти(ПризнакиУчетаСтрока, ИмяПризнака_)>0);
	ПризнакУчета = ПризнакиУчета.НайтиПоЗначению(ИмяПризнака_);
	Если ПризнакУчета = Неопределено Тогда
		ПризнакУчета = ПризнакиУчета.Добавить(ИмяПризнака_);
	КонецЕсли;
	ПризнакУчета.Пометка = флУстановлен;
КонецПроцедуры

&НаКлиенте
Процедура ОтправитьЗначениеВладельцу(Команда)
	Перем СтрИтог;
	СтрИтог = "";
	Для каждого СтрПризнак Из ПризнакиУчета Цикл
		Если СтрПризнак.Пометка Тогда
			СтрИтог = СтрИтог + СтрПризнак.Значение + ";";
		КонецЕсли;
	КонецЦикла;
	Если СтрИтог <> "" Тогда
		СтрИтог = Лев(СтрИтог, СтрДлина(СтрИтог)-1);
	КонецЕсли;
	ОповеститьОВыборе(СтрИтог);
КонецПроцедуры
