
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	Если ПараметрыВыполненияКоманды.Источник.Модифицированность Тогда
		ПоказатьВопрос(Новый ОписаниеОповещения("ОбработкаКомандыЗавершение", ЭтотОбъект, Новый Структура("ПараметрКоманды, ПараметрыВыполненияКоманды", ПараметрКоманды, ПараметрыВыполненияКоманды)), НСтр("ru = 'Данные регламента изменены. Для продолжения необходимо записать регламент. Продолжить?'"), РежимДиалогаВопрос.ДаНет);
	Иначе
		ОбработкаКомандыФрагмент(ПараметрКоманды, ПараметрыВыполненияКоманды);
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаКомандыЗавершение(РезультатВопроса, ДополнительныеПараметры) Экспорт
	ПараметрКоманды = ДополнительныеПараметры.ПараметрКоманды;
	ПараметрыВыполненияКоманды = ДополнительныеПараметры.ПараметрыВыполненияКоманды;
	Если РезультатВопроса = КодВозвратаДиалога.Да Тогда
		Оповестить("ЗаписатьВФорме");
		ОбработкаКомандыФрагмент(ПараметрКоманды, ПараметрыВыполненияКоманды);
	Иначе
		ПерейтиПоНавигационнойСсылке(ПолучитьНавигационнуюСсылку(ПараметрыВыполненияКоманды.Источник));
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаКомандыФрагмент(Знач ПараметрКоманды, Знач ПараметрыВыполненияКоманды)
	ПараметрыФормы = Новый Структура;
	ПараметрыФормы.Вставить("ВерсияОрганизационнойСтруктуры", ПараметрКоманды);
	ПараметрыФормы.Вставить("ОбъектБД", ПолучитьДокументБдПоНаименованию("НастраиваемыйОтчет"));
	ИмяОбработки = "СводнаяТаблица";
	ОткрытьФорму("Обработка." + ИмяОбработки + ".Форма.ФормаУправленияМатрицейПолномочий", ПараметрыФормы, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно);
КонецПроцедуры

&НаСервере
Функция ПолучитьДокументБдПоНаименованию(НаименованиеВход)
	РезультатФункции = Справочники.ДокументыБД.НайтиПоНаименованию(НаименованиеВход);
	Возврат РезультатФункции;
КонецФункции
