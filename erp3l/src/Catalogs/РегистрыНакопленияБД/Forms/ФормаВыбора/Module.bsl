
&НаКлиенте
Процедура ЗагрузитьИЗВИБ(Команда)
	
	Если НЕ ЗначениеЗаполнено(ТипБД) Тогда
		
		ПоказатьПредупреждение(, Нстр("ru = 'Не указан тип внешней информационной базы.'"));
		Возврат;
		
	Иначе
		
		ЗаполнитьСписокРегистровНакопления(ТипБД);
		Элементы.Список.Обновить();
		
	КонецЕсли;
	
КонецПроцедуры

&НаСервереБезКонтекста
Процедура ЗаполнитьСписокРегистровНакопления(ТипБД)
		
	ОбщегоНазначенияУХ.ЗаполнитьСписокРегистровБД(ТипБД,,, Истина,,Истина);
	
КонецПроцедуры //

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Параметры.Отбор.Свойство("Владелец", ТипБД);
	
	Если ТипБД = Справочники.ТипыБазДанных.ТекущаяИБ Тогда		
		Элементы.ФормаЗагрузитьИЗВИБ.Заголовок = Нстр("ru = 'Обновить по данным текущей ИБ'");		
	Иначе		
		Элементы.ФормаЗагрузитьИЗВИБ.Заголовок = Нстр("ru = 'Обновить по данным внешней ИБ;'")		
	КонецЕсли;
		
КонецПроцедуры

