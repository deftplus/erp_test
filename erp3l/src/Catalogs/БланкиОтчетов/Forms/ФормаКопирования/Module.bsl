
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
		
    БланкИсточник = Параметры.ЗначениеКопирования;	
	Владелец = БланкИсточник.Владелец;
	ПериодичностьБюджетирования = БланкИсточник.Периодичность;
	ЕдиницаИзмеренияПоУмолчанию = БланкИсточник.ЕдиницаИзмеренияПоУмолчанию;
	ИерархияГруппировокСтрок = БланкИсточник.ИерархияГруппировокСтрок;
    ИерархияГруппировокКолонок = БланкИсточник.ИерархияГруппировокКолонок;
	
	
	
	СписокПараметровКопирования.Добавить("СтрокиБланка", Нстр("ru = 'Состав строк'"), Истина);
	СписокПараметровКопирования.Добавить("КолонкиБланка", Нстр("ru = 'Состав показателей'"), Истина);
	СписокПараметровКопирования.Добавить("СтруктураОсейБланка", Нстр("ru = 'Расположение осей бланка'"), Истина);
	СписокПараметровКопирования.Добавить("НастройкаШкалыПериодов", Нстр("ru = 'Настройка периодов'"), Истина);
	СписокПараметровКопирования.Добавить("НастройкиАналитик", Нстр("ru = 'Настройки аналитик'"), Истина);
	
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
	
	СтруктураПараметров = Новый Структура;
	ПараметрыЗаполнения = Новый Структура;
	ПараметрыЗаполнения.Вставить("Владелец",Владелец);
    ПараметрыЗаполнения.Вставить("РежимБланка",1);
	СтруктураПараметров.Вставить("ЗначенияЗаполнения", ПараметрыЗаполнения);
	Если Не ЗначениеЗаполнено(ИмяНовойФормы) Тогда
		ОбщегоНазначенияУх.СообщитьОбОшибке(НСтр("ru = 'Необходимо заполнить наименование новой формы!'"));
		Возврат;
	КонецЕсли;	

		
	ФормаСводнойТаблицы = ПолучитьФорму("Справочник.БланкиОтчетов.Форма.ФормаМакетаСводнаяТаблица",СтруктураПараметров,Владелец);
	
	ФормаСводнойТаблицы.Объект.Наименование = ИмяНовойФормы;
    ФормаСводнойТаблицы.Объект.РежимБланка = 1;
	ФормаСводнойТаблицы.Объект.Периодичность = ПериодичностьБюджетирования;
	ФормаСводнойТаблицы.Объект.ЕдиницаИзмеренияПоУмолчанию = ЕдиницаИзмеренияПоУмолчанию;
	ФормаСводнойТаблицы.Объект.ИерархияГруппировокСтрок = ИерархияГруппировокСтрок;
	ФормаСводнойТаблицы.Объект.ИерархияГруппировокКолонок = ИерархияГруппировокКолонок;
	ФормаСводнойТаблицы.Записать();
	СкопироватьНастройкиИсточника(БланкИсточник,ФормаСводнойТаблицы.Объект.Ссылка);
	ФормаСводнойТаблицы.ПрочитатьСтруктуруТаблицы();
	ФормаСводнойТаблицы.Открыть();

	Закрыть(СписокПараметровКопирования);
КонецПроцедуры


&НаСервере
Процедура СкопироватьНастройкиИсточника(БланкИсточник,Бланк)
	
	   СводнаяТаблицаУХ.СкопироватьНастройкиБланка(БланкИсточник,Бланк,СписокПараметровКопирования);
		
КонецПроцедуры

&НаСервере
Процедура ЗаполнитьСвойстваОбъекта(БланкИсточник,Бланк)
	
	   ЗаполнитьЗначенияСвойств(Бланк,БланкИсточник);
		
КонецПроцедуры
