
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Параметры.Свойство("ВидОтчета", ВидОтчета);
	НовыйОтбор = ГруппыРаскрытия.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
	НовыйОтбор.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных("Владелец");
	НовыйОтбор.ВидСравнения   = ВидСравненияКомпоновкиДанных.Равно;
	НовыйОтбор.ПравоеЗначение = ВидОтчета;
	НовыйОтбор.Использование  = Истина;
	
	ТекущаяАналитика = 1;
	
КонецПроцедуры

&НаСервере
Процедура УстановитьТекущийВыбранныйЭлемент()
	
	Для Инд = 1 По ПараметрыСеанса.ЧислоДопАналитик Цикл
		
		ЭтаФорма["Аналитика" + Инд + "_Выбрана"] = Инд = ТекущаяАналитика;
		
	КонецЦикла;
	
	ТекущиеДанные = Элементы.ГруппыРаскрытия.ТекущаяСтрока;
	Реквизиты.Очистить();
	Если ТекущиеДанные <> Неопределено Тогда
		ПолученныеРеквизиты = КэшируемыеПроцедурыУХ.ВернутьСписокРеквизитов(ТекущиеДанные["ВидАналитики" + ТекущаяАналитика]);
		
		Для Каждого Элемент Из ПолученныеРеквизиты Цикл
			
			Реквизиты.Добавить(Элемент.Значение, Элемент.Представление);
			
		КонецЦикла;
		
	КонецЕсли;
КонецПроцедуры


&НаКлиенте
Процедура Аналитика1_ВыбранаПриИзменении(Элемент)
	
	ТекущаяАналитика = 1;
	УстановитьТекущийВыбранныйЭлемент();
	
КонецПроцедуры


&НаКлиенте
Процедура Аналитика2_ВыбранаПриИзменении(Элемент)
	
	ТекущаяАналитика = 2;
	УстановитьТекущийВыбранныйЭлемент();
	
КонецПроцедуры


&НаКлиенте
Процедура Аналитика3_ВыбранаПриИзменении(Элемент)
	
	ТекущаяАналитика = 3;
	УстановитьТекущийВыбранныйЭлемент();
	
КонецПроцедуры


&НаКлиенте
Процедура Аналитика4_ВыбранаПриИзменении(Элемент)
	
	ТекущаяАналитика = 4;
	УстановитьТекущийВыбранныйЭлемент();
	
КонецПроцедуры


&НаКлиенте
Процедура Аналитика5_ВыбранаПриИзменении(Элемент)
	
	ТекущаяАналитика = 5;
	УстановитьТекущийВыбранныйЭлемент();
	
КонецПроцедуры


&НаКлиенте
Процедура ГруппыРаскрытияПриАктивизацииСтроки(Элемент)
	
	ТекущиеДанные = Элементы.ГруппыРаскрытия.ДанныеСтроки(Элементы.ГруппыРаскрытия.ТекущаяСтрока);
	Если ТекущиеДанные <> Неопределено Тогда
		
		Если ТекущиеДанные.ЧислоАналитик < ТекущаяАналитика Тогда
			ТекущаяАналитика = ТекущиеДанные.ЧислоАналитик;
		КонецЕсли;
		
	Иначе
		ТекущаяАналитика = 0;

	КонецЕсли;
	
	УстановитьТекущийВыбранныйЭлемент();

	
КонецПроцедуры


&НаКлиенте
Процедура ЗаписатьИЗакрыть(Команда)
	
	СтрокаГруппыРаскрытия = Элементы.ГруппыРаскрытия.ДанныеСтроки(Элементы.ГруппыРаскрытия.ТекущаяСтрока);
	
	Если СтрокаГруппыРаскрытия = Неопределено 
	 ИЛИ ТекущаяАналитика = 0 Тогда
		Закрыть();
	КонецЕсли;
	
	Реквизит = Элементы.Реквизиты.ДанныеСтроки(Элементы.Реквизиты.ТекущаяСтрока);
	Закрыть(СокрЛП(СтрокаГруппыРаскрытия.Код) + "_Аналитика" + ТекущаяАналитика + ?(Реквизит = Неопределено ИЛИ Реквизит.Значение = "", "", "_" + Реквизит.Значение));

	
КонецПроцедуры

&НаКлиенте
Процедура Аналитика6_ВыбранаПриИзменении(Элемент)
	
	ТекущаяАналитика = 6;
	УстановитьТекущийВыбранныйЭлемент();
	
КонецПроцедуры


