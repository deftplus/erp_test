#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
	
Функция ПолучитьСоздатьКлюч(Субконто1 = Неопределено, Субконто2 = Неопределено, Субконто3 = Неопределено, Отказ = Ложь) Экспорт

	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ЗначенияСубконтоСчета.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.ЗначенияСубконтоСчета КАК ЗначенияСубконтоСчета
	|ГДЕ
	|	ЗначенияСубконтоСчета.ЗначениеСубконто1Приемник = &ЗначениеСубконто1Приемник
	|	И ЗначенияСубконтоСчета.ЗначениеСубконто2Приемник = &ЗначениеСубконто2Приемник
	|	И ЗначенияСубконтоСчета.ЗначениеСубконто3Приемник = &ЗначениеСубконто3Приемник";
	
	Запрос.УстановитьПараметр("ЗначениеСубконто1Приемник", Субконто1);
	Запрос.УстановитьПараметр("ЗначениеСубконто2Приемник", Субконто2);
	Запрос.УстановитьПараметр("ЗначениеСубконто3Приемник", Субконто3);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если РезультатЗапроса.Пустой() Тогда
	
		ЗначенияСубконтоСчетаОбъект = Справочники.ЗначенияСубконтоСчета.СоздатьЭлемент();
		
		ЗначенияСубконтоСчетаОбъект.ЗначениеСубконто1Приемник = Субконто1;
		ЗначенияСубконтоСчетаОбъект.ЗначениеСубконто2Приемник = Субконто2;
		ЗначенияСубконтоСчетаОбъект.ЗначениеСубконто3Приемник = Субконто3;
		
		Попытка
			ЗначенияСубконтоСчетаОбъект.Записать();    	
		Исключение
			
			ШаблонОшибки = "Не удалось создать Элемент <Значение субконто счета> по аналитикам <%1>, <%2>, <%3>";
			ОбщегоНазначенияУХ.СообщитьОбОшибке(СтрШаблон(ШаблонОшибки, Субконто1, Субконто2, Субконто3), Отказ);
			
			Возврат Справочники.ЗначенияСубконтоСчета.ПустаяСсылка();
			
		КонецПопытки;
		
		Возврат ЗначенияСубконтоСчетаОбъект.Ссылка;
		
	Иначе		
		Возврат РезультатЗапроса.Выгрузить()[0].Ссылка;					
	КонецЕсли;

КонецФункции
	
#КонецЕсли	