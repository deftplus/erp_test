
#Область Запрос_ЗаполнениеДокументовВНА_ИзБП

Функция ТекстЗапроса_ЗаполненияИзРСБУ(НомераТаблиц = Неопределено) Экспорт

	Если НомераТаблиц = Неопределено Тогда
	    НомераТаблиц = новый Структура;
	КонецЕсли;
	
	ТекстЗапроса = Новый Массив;
	
	ТекстЗапроса.Добавить(ТекстЗапроса_втУчитываемыеВНА(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_ПараметрыУчетаГруппВНАПоУмолчанию(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втПриоритеты(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втПараметрыДляЗаполненияВНА(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втСубконто(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втСчетаВНА(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втОбороты(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втПринятиеИВводВПериоде(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втПараметрыВНА(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втПрофили(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втСчетаБД(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_втСуммыПереоценки(НомераТаблиц));
	ТекстЗапроса.Добавить(ТекстЗапроса_СобытияВНА(НомераТаблиц));
	
	Возврат СтрСоединить(ТекстЗапроса, ОбщегоНазначенияБПВызовСервера.ТекстРазделителяЗапросовПакета());

КонецФункции

Функция ТекстЗапроса_втУчитываемыеВНА(НомераТаблиц)
	
	НомераТаблиц.Вставить("втУчитываемыеВНА", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	т.ВНА КАК ВНА,
	|	т.ГруппаВНА КАК ГруппаВНА
	|ПОМЕСТИТЬ втУчитываемыеВНА
	|ИЗ
	|	РегистрСведений.ПараметрыУчетаВНАМСФО.СрезПоследних(
	|			&ДатаНачала,
	|			Организация = &Организация
	|				И Сценарий = &Сценарий
	|				И ВидУчета = ЗНАЧЕНИЕ(Перечисление.ВидыУчета.МСФО)
	|				И Активность) КАК т
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВНА";

КонецФункции

Функция ТекстЗапроса_ПараметрыУчетаГруппВНАПоУмолчанию(НомераТаблиц)
	
	НомераТаблиц.Вставить("ПараметрыУчетаГруппВНАПоУмолчанию", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	т.ВНА КАК ВНА,
	|	т.ПараметрыУчетаВНА КАК ПараметрыУчетаВНА
	|ПОМЕСТИТЬ ПараметрыУчетаГруппВНАПоУмолчанию
	|ИЗ
	|	РегистрСведений.ПараметрыУчетаВНАПоУмолчанию КАК т
	|ГДЕ
	|	НЕ т.ВНА В
	|				(ВЫБРАТЬ
	|					т.ВНА
	|				ИЗ
	|					втУчитываемыеВНА КАК т)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВНА
	|";

КонецФункции

Функция ТекстЗапроса_втПриоритеты(НомераТаблиц)
	
	НомераТаблиц.Вставить("втПриоритеты", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	ТаблицаВНА.ВНА КАК ВНА,
	|	ТаблицаВНА.ПараметрыУчетаВНА КАК ПараметрыУчетаВНА,
	|	ВЫБОР
	|		КОГДА ТаблицаВНА.ВНА = ТаблицаВНА.ГруппаВНА
	|			ТОГДА 0
	|		КОГДА ТаблицаВНА.ВНА.Родитель = ТаблицаВНА.ГруппаВНА
	|			ТОГДА 1
	|		КОГДА ТаблицаВНА.ВНА.Родитель.Родитель = ТаблицаВНА.ГруппаВНА
	|			ТОГДА 2
	|		КОГДА ТаблицаВНА.ВНА.Родитель.Родитель.Родитель = ТаблицаВНА.ГруппаВНА
	|			ТОГДА 3
	|		КОГДА ТаблицаВНА.ВНА.Родитель.Родитель.Родитель.Родитель.Родитель = ТаблицаВНА.ГруппаВНА
	|			ТОГДА 4
	|		КОГДА ТаблицаВНА.ВНА.Родитель.Родитель.Родитель.Родитель.Родитель.Родитель = ТаблицаВНА.ГруппаВНА
	|			ТОГДА 5
	|		ИНАЧЕ 6
	|	КОНЕЦ КАК Приоритет
	|ПОМЕСТИТЬ втПриоритеты
	|ИЗ
	|	(ВЫБРАТЬ
	|		ТаблицаВНА.Ссылка КАК ВНА,
	|		ПараметрыУчетаГруппВНАПоУмолчанию.ВНА КАК ГруппаВНА,
	|		ПараметрыУчетаГруппВНАПоУмолчанию.ПараметрыУчетаВНА КАК ПараметрыУчетаВНА
	|	ИЗ
	|		Справочник.ОбъектыЭксплуатации КАК ТаблицаВНА
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПараметрыУчетаГруппВНАПоУмолчанию КАК ПараметрыУчетаГруппВНАПоУмолчанию
	|			ПО (ТИПЗНАЧЕНИЯ(ПараметрыУчетаГруппВНАПоУмолчанию.ВНА) = ТИП(Справочник.ОбъектыЭксплуатации))
	|				И (ТаблицаВНА.Ссылка = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ТаблицаВНА.Ссылка,
	|		ПараметрыУчетаГруппВНАПоУмолчанию.ВНА,
	|		ПараметрыУчетаГруппВНАПоУмолчанию.ПараметрыУчетаВНА
	|	ИЗ
	|		Справочник.НематериальныеАктивы КАК ТаблицаВНА
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПараметрыУчетаГруппВНАПоУмолчанию КАК ПараметрыУчетаГруппВНАПоУмолчанию
	|			ПО (ТаблицаВНА.Ссылка = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ТаблицаВНА.Ссылка,
	|		ПараметрыУчетаГруппВНАПоУмолчанию.ВНА,
	|		ПараметрыУчетаГруппВНАПоУмолчанию.ПараметрыУчетаВНА
	|	ИЗ
	|		Справочник.ОбъектыСтроительства КАК ТаблицаВНА
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПараметрыУчетаГруппВНАПоУмолчанию КАК ПараметрыУчетаГруппВНАПоУмолчанию
	|			ПО (ТаблицаВНА.Ссылка = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ТаблицаВНА.Ссылка,
	|		ПараметрыУчетаГруппВНАПоУмолчанию.ВНА,
	|		ПараметрыУчетаГруппВНАПоУмолчанию.ПараметрыУчетаВНА
	|	ИЗ
	|		Справочник.Номенклатура КАК ТаблицаВНА
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПараметрыУчетаГруппВНАПоУмолчанию КАК ПараметрыУчетаГруппВНАПоУмолчанию
	|			ПО (ТаблицаВНА.Ссылка = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА
	|					ИЛИ ТаблицаВНА.Ссылка.Родитель.Родитель.Родитель.Родитель = ПараметрыУчетаГруппВНАПоУмолчанию.ВНА)) КАК ТаблицаВНА
	|ГДЕ
	|	НЕ ТаблицаВНА.ВНА В
	|				(ВЫБРАТЬ
	|					т.ВНА
	|				ИЗ
	|					втУчитываемыеВНА КАК т)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВНА,
	|	Приоритет
	|";

КонецФункции

Функция ТекстЗапроса_втПараметрыДляЗаполненияВНА(НомераТаблиц)
	
	НомераТаблиц.Вставить("втПараметрыДляЗаполненияВНА", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	втПриоритеты.ВНА КАК ВНА,
	|	МАКСИМУМ(втПриоритеты.ПараметрыУчетаВНА) КАК ПараметрыУчетаВНА,
	|	МАКСИМУМ(втПриоритеты.ПараметрыУчетаВНА.ПараметрыУчетаНЗС) КАК ПараметрыУчетаНЗС,
	|	ЛОЖЬ КАК ЕстьВУчете
	|ПОМЕСТИТЬ втПараметрыДляЗаполненияВНА
	|ИЗ
	|	(ВЫБРАТЬ
	|		втПриоритеты.ВНА КАК ВНА,
	|		МИНИМУМ(втПриоритеты.Приоритет) КАК Приоритет
	|	ИЗ
	|		втПриоритеты КАК втПриоритеты
	|	
	|	СГРУППИРОВАТЬ ПО
	|		втПриоритеты.ВНА) КАК МинПриоритет
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втПриоритеты КАК втПриоритеты
	|		ПО МинПриоритет.ВНА = втПриоритеты.ВНА
	|			И МинПриоритет.Приоритет = втПриоритеты.Приоритет
	|
	|СГРУППИРОВАТЬ ПО
	|	втПриоритеты.ВНА
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	втУчитываемыеВНА.ВНА,
	|	втУчитываемыеВНА.ГруппаВНА,
	|	втУчитываемыеВНА.ГруппаВНА.ПараметрыУчетаНЗС,
	|	ИСТИНА
	|ИЗ
	|	втУчитываемыеВНА КАК втУчитываемыеВНА
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВНА";

КонецФункции

Функция ТекстЗапроса_втСубконто(НомераТаблиц)
	
	НомераТаблиц.Вставить("втСубконто", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	ХозрасчетныйСубконто.Регистратор КАК Регистратор,
	|	ХозрасчетныйСубконто.НомерСтроки КАК НомерСтроки,
	|	ВЫБОР
	|		КОГДА КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ХозрасчетныйСубконто.Значение) > 1
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ХозрасчетныйСубконто.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияБухгалтерии.Дебет)
	|							ТОГДА ХозрасчетныйСубконто.Значение
	|						ИНАЧЕ NULL
	|					КОНЕЦ)
	|		ИНАЧЕ МАКСИМУМ(ХозрасчетныйСубконто.Значение)
	|	КОНЕЦ КАК ОсновнойВНА
	|ПОМЕСТИТЬ втСубконто
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Субконто КАК ХозрасчетныйСубконто
	|ГДЕ
	|	ХозрасчетныйСубконто.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
	|	И ТИПЗНАЧЕНИЯ(ХозрасчетныйСубконто.Регистратор) В (&ТипДокумента)
	|	И ХозрасчетныйСубконто.Значение В
	|			(ВЫБРАТЬ
	|				т.ВНА
	|			ИЗ
	|				втПараметрыДляЗаполненияВНА КАК т)
	|
	|СГРУППИРОВАТЬ ПО
	|	ХозрасчетныйСубконто.Регистратор,
	|	ХозрасчетныйСубконто.НомерСтроки
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	НомерСтроки
	|";

КонецФункции

Функция ТекстЗапроса_втСчетаВНА(НомераТаблиц)
	
	НомераТаблиц.Вставить("втСчетаВНА", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	СчетаВНА.Счет КАК Счет,
	|	СчетаВНА.НЗС КАК НЗС,
	|	СчетаВНА.ОС КАК ОС,
	|	СчетаВНА.НМА КАК НМА,
	|	СчетаВНА.Амортизация КАК Амортизация,
	|	СчетаВНА.РезервПереоценки КАК РезервПереоценки,
	|	ВидСубконто1.ТолькоОбороты КАК ТолькоОбороты1,
	|	ВидСубконто2.ТолькоОбороты КАК ТолькоОбороты2,
	|	ВидСубконто3.ТолькоОбороты КАК ТолькоОбороты3
	|ПОМЕСТИТЬ втСчетаВНА
	|ИЗ
	|	(ВЫБРАТЬ
	|		т.Ссылка КАК Счет,
	|		ИСТИНА КАК НЗС,
	|		ЛОЖЬ КАК ОС,
	|		ЛОЖЬ КАК НМА,
	|		ЛОЖЬ КАК Амортизация,
	|		ЛОЖЬ КАК РезервПереоценки
	|	ИЗ
	|		ПланСчетов.Хозрасчетный КАК т
	|	ГДЕ
	|		т.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОборудованиеКУстановке), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВложенияВоВнеоборотныеАктивы))
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		т.Ссылка,
	|		ЛОЖЬ,
	|		ИСТИНА,
	|		ЛОЖЬ,
	|		т.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств)),
	|		ЛОЖЬ
	|	ИЗ
	|		ПланСчетов.Хозрасчетный КАК т
	|	ГДЕ
	|		т.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновныеСредства), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияОсновныхСредств), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходныеВложенияВ_МЦ))
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		т.Ссылка,
	|		ЛОЖЬ,
	|		ЛОЖЬ,
	|		ИСТИНА,
	|		т.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов)),
	|		ЛОЖЬ
	|	ИЗ
	|		ПланСчетов.Хозрасчетный КАК т
	|	ГДЕ
	|		т.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НематериальныеАктивы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.АмортизацияНематериальныхАктивов))
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		т.Ссылка,
	|		ЛОЖЬ,
	|		ЛОЖЬ,
	|		ЛОЖЬ,
	|		ЛОЖЬ,
	|		ИСТИНА
	|	ИЗ
	|		ПланСчетов.Хозрасчетный КАК т
	|	ГДЕ
	|		т.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПриростСтоимостиПоПереоценке))) КАК СчетаВНА
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидСубконто1
	|		ПО СчетаВНА.Счет = ВидСубконто1.Ссылка
	|			И (ВидСубконто1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидСубконто2
	|		ПО СчетаВНА.Счет = ВидСубконто2.Ссылка
	|			И (ВидСубконто2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидСубконто3
	|		ПО СчетаВНА.Счет = ВидСубконто3.Ссылка
	|			И (ВидСубконто3.НомерСтроки = 3)
	|";

КонецФункции

Функция ТекстЗапроса_втОбороты(НомераТаблиц)
	
	НомераТаблиц.Вставить("втОбороты", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	Обороты.Регистратор КАК ДокументОснование,
	|	ВЫБОР
	|		КОГДА втСчетДт.Счет ЕСТЬ NULL
	|			ТОГДА Обороты.СубконтоКт1
	|		ИНАЧЕ Обороты.СубконтоДт1
	|	КОНЕЦ КАК ВНА,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(втСчетДт.ОС, ЛОЖЬ)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.КлассыВНА.ОсновноеСредство)
	|		КОГДА ЕСТЬNULL(втСчетДт.НМА, ЛОЖЬ)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.КлассыВНА.НематериальныйАктив)
	|		КОГДА ЕСТЬNULL(втСчетДт.НЗС, ЛОЖЬ)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.КлассыВНА.НезавершенноеСтроительство)
	|		КОГДА ЕСТЬNULL(втСчетКт.ОС, ЛОЖЬ)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.КлассыВНА.ОсновноеСредство)
	|		КОГДА ЕСТЬNULL(втСчетКт.НМА, ЛОЖЬ)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.КлассыВНА.НематериальныйАктив)
	|		КОГДА ЕСТЬNULL(втСчетКт.НЗС, ЛОЖЬ)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.КлассыВНА.НезавершенноеСтроительство)
	|		ИНАЧЕ NULL
	|	КОНЕЦ КАК КлассВНА,
	|	Обороты.Период КАК ДатаСобытияНСБУ,
	|	Обороты.Сумма КАК СуммаНСБУ,
	|	Обороты.СчетДт КАК СчетДт,
	|	Обороты.СубконтоДт1 КАК СубконтоДт1,
	|	Обороты.СубконтоДт2 КАК СубконтоДт2,
	|	Обороты.СубконтоДт3 КАК СубконтоДт3,
	|	Обороты.СчетКт КАК СчетКт,
	|	Обороты.СубконтоКт1 КАК СубконтоКт1,
	|	Обороты.СубконтоКт2 КАК СубконтоКт2,
	|	Обороты.СубконтоКт3 КАК СубконтоКт3,
	|	Обороты.ВалютаДт КАК ВалютаДт,
	|	Обороты.ВалютаКт КАК ВалютаКт,
	|	Обороты.КоличествоДт КАК КоличествоДт,
	|	Обороты.КоличествоКт КАК КоличествоКт,
	|	Обороты.ВалютнаяСуммаКт КАК ВалютнаяСуммаКт,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_ВводВЭксплуатациюВНАМСФО)
	|				И (ЕСТЬNULL(втСчетКт.ОС, ЛОЖЬ)
	|					ИЛИ ЕСТЬNULL(втСчетКт.НЗС, ЛОЖЬ)
	|					ИЛИ ЕСТЬNULL(втСчетКт.НМА, ЛОЖЬ)
	|					ИЛИ Обороты.Регистратор ССЫЛКА Документ.ПринятиеКУчетуОС)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВидыОпераций.ВводВЭксплуатацию)
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_ПоступлениеВНАМСФО)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВидыОпераций.ПринятиеКУчетуВНА)
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_МодернизацияВНАМСФО)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВидыОпераций.МодернизацияВНА)
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_ИзменениеПараметровВНАМСФО)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВидыОпераций.ИзменениеПараметровАмортизации)
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_НачислениеАмортизацииВНАМСФО)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВидыОпераций.СторноАмортизацииНСБУ)
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_ВыбытиеВНАМСФО)
	|			ТОГДА ВЫБОР
	|					КОГДА ЕСТЬNULL(втСчетКт.Амортизация, ЛОЖЬ)
	|						ТОГДА ЗНАЧЕНИЕ(Справочник.ВидыОпераций.СторноАмортизацииНСБУ)
	|					ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ВидыОпераций.ВыбытиеВНА)
	|				КОНЕЦ
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_ПереоценкаВНАМСФО)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВидыОпераций.ПереоценкаВНА)
	|		ИНАЧЕ ""Прочее""
	|	КОНЕЦ КАК СобытиеВНА,
	|	ВЫБОР
	|		КОГДА Обороты.Регистратор ССЫЛКА Документ.ПеремещениеОС
	|				И ЕСТЬNULL(втСчетКт.Амортизация, ЛОЖЬ)
	|				И втСчетДт.Счет ЕСТЬ NULL
	|			ТОГДА ""АмортизацияПриПеремещении""
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_ВыбытиеВНАМСФО)
	|				И ЕСТЬNULL(втСчетДт.Амортизация, ЛОЖЬ)
	|			ТОГДА ""АмортизацияПриВыбытии""
	|		КОГДА ТИПЗНАЧЕНИЯ(Обороты.Регистратор) В (&Документы_ПереоценкаВНАМСФО)
	|			ТОГДА ВЫБОР
	|					КОГДА ЕСТЬNULL(втСчетКт.РезервПереоценки
	|									И НЕ втСчетДт.Амортизация
	|									И втСчетДт.ОС
	|								ИЛИ втСчетДт.НМА, ЛОЖЬ)
	|						ТОГДА ""РезервПереоценки""
	|					КОГДА втСчетДт.ОС ЕСТЬ NULL
	|							И ЕСТЬNULL(НЕ втСчетКт.Амортизация
	|										И втСчетКт.ОС
	|									ИЛИ втСчетКт.НМА, ЛОЖЬ)
	|						ТОГДА ""РезервПереоценки""
	|					ИНАЧЕ ""РезервПереоценкиИсключение""
	|				КОНЕЦ
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК УточнениеСобытия,
	|	Обороты.ПодразделениеДт.Организация КАК ПодразделениеДт,
	|	Обороты.ПодразделениеКт.Организация КАК ПодразделениеКт,
	|	Обороты.НаправлениеДеятельностиДт КАК НаправлениеДеятельностиДт,
	|	Обороты.НаправлениеДеятельностиКт КАК НаправлениеДеятельностиКт
	|ПОМЕСТИТЬ втОбороты
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
	|			{(&ДатаНачала)},
	|			{(&ДатаОкончания)},
	|			Организация = &Организация
	|				И Активность
	|				И ВЫБОР
	|					КОГДА СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыбытиеОС)
	|						ТОГДА НЕ СчетКт В
	|									(ВЫБРАТЬ
	|										т.Счет
	|									ИЗ
	|										втСчетаВНА КАК т
	|									ГДЕ
	|										т.ОС)
	|					КОГДА СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыбытиеОС)
	|						ТОГДА НЕ СчетДт В
	|									(ВЫБРАТЬ
	|										т.Счет
	|									ИЗ
	|										втСчетаВНА КАК т
	|									ГДЕ
	|										т.ОС)
	|					ИНАЧЕ Счет В
	|							(ВЫБРАТЬ
	|								т.Счет
	|							ИЗ
	|								втСчетаВНА КАК т)
	|				КОНЕЦ
	|				И Сумма <> 0,
	|			,
	|			) КАК Обороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втСубконто КАК втСубконто
	|		ПО Обороты.Регистратор = втСубконто.Регистратор
	|			И Обороты.НомерСтроки = втСубконто.НомерСтроки
	|		ЛЕВОЕ СОЕДИНЕНИЕ втСчетаВНА КАК втСчетДт
	|		ПО Обороты.СчетДт = втСчетДт.Счет
	|		ЛЕВОЕ СОЕДИНЕНИЕ втСчетаВНА КАК втСчетКт
	|		ПО Обороты.СчетКт = втСчетКт.Счет
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	КлассВНА,
	|	ВНА,
	|	ДокументОснование";

КонецФункции

Функция ТекстЗапроса_втПринятиеИВводВПериоде(НомераТаблиц)
	
	НомераТаблиц.Вставить("втПринятиеИВводВПериоде", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	втОборотыНЗС.СчетКт КАК СчетКт,
	|	втОборотыОС.ВНА КАК ПриемникВНА,
	|	втОборотыНЗС.ВНА КАК ИсточникВНА,
	|	втОборотыОС.ДокументОснование КАК ПриемникДокументОснование,
	|	втОборотыНЗС.ДокументОснование КАК ИсточникДокументОснование,
	|	втОборотыНЗС.СубконтоКт1 КАК СубконтоКт1,
	|	втОборотыНЗС.СубконтоКт2 КАК СубконтоКт2,
	|	втОборотыНЗС.СубконтоКт3 КАК СубконтоКт3,
	|	втОборотыНЗС.ВалютаКт КАК ВалютаКт,
	|	втОборотыНЗС.КоличествоКт КАК КоличествоКт,
	|	втОборотыНЗС.ДатаСобытияНСБУ КАК ДатаСобытияНСБУ,
	|	втОборотыНЗС.ВалютнаяСуммаКт КАК ВалютнаяСуммаКт,
	|	втОборотыНЗС.СуммаНСБУ КАК СуммаНСБУ
	|ПОМЕСТИТЬ втПринятиеИВводВПериоде
	|ИЗ
	|	втОбороты КАК втОборотыОС
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втСчетаВНА КАК втСчет
	|		ПО втОборотыОС.СчетКт = втСчет.Счет
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втОбороты КАК втОборотыНЗС
	|		ПО втОборотыОС.СчетКт = втОборотыНЗС.СчетДт
	|			И (ВЫБОР
	|				КОГДА НЕ втСчет.ТолькоОбороты1
	|					ТОГДА ЕСТЬNULL(втОборотыОС.СубконтоКт1, НЕОПРЕДЕЛЕНО) = ЕСТЬNULL(втОборотыНЗС.СубконтоДт1, НЕОПРЕДЕЛЕНО)
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ)
	|			И (ВЫБОР
	|				КОГДА НЕ втСчет.ТолькоОбороты2
	|					ТОГДА ЕСТЬNULL(втОборотыОС.СубконтоКт2, НЕОПРЕДЕЛЕНО) = ЕСТЬNULL(втОборотыНЗС.СубконтоДт2, НЕОПРЕДЕЛЕНО)
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ)
	|			И (ВЫБОР
	|				КОГДА НЕ втСчет.ТолькоОбороты3
	|					ТОГДА ЕСТЬNULL(втОборотыОС.СубконтоКт3, НЕОПРЕДЕЛЕНО) = ЕСТЬNULL(втОборотыНЗС.СубконтоДт3, НЕОПРЕДЕЛЕНО)
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ)
	|			И втОборотыОС.СуммаНСБУ = втОборотыНЗС.СуммаНСБУ
	|			И (НЕ втОборотыНЗС.ВНА ССЫЛКА Справочник.ОбъектыСтроительства)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СчетКт,
	|	ИсточникВНА,
	|	ИсточникДокументОснование
	|";

КонецФункции

Функция ТекстЗапроса_втПараметрыВНА(НомераТаблиц)
	
	НомераТаблиц.Вставить("втПараметрыВНА", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	ПервоначальныеСведенияОС.ОсновноеСредство КАК ВНА,
	|	НачислениеАмортизацииОСБухгалтерскийУчет.НачислятьАмортизациюБУ КАК НачислятьАмортизациюНСБУ,
	|	ПараметрыАмортизацииОСБухгалтерскийУчет.СрокПолезногоИспользованияБУ КАК СрокПолезногоИспользованияНСБУ,
	|	ПервоначальныеСведенияОС.МетодНачисленияАмортизацииБУ КАК СпособНачисленияАмортизацииНСБУ,
	|	ВЫБОР
	|		КОГДА ПервоначальныеСведенияОС.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииОС.Линейный)
	|			ТОГДА ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииВНА.Линейный)
	|		КОГДА ПервоначальныеСведенияОС.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииОС.УменьшаемогоОстатка)
	|			ТОГДА ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииВНА.УменьшаемогоОстатка)
	|		КОГДА ПервоначальныеСведенияОС.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииОС.ПропорциональноОбъемуПродукции)
	|			ТОГДА ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииВНА.ПропорциональноОбъемуПродукции)
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииВНА.Линейный)
	|	КОНЕЦ КАК СпособНачисленияАмортизацииМСФО,
	|	ПорядокУчетаОСБУ.СтатьяРасходовБУ КАК СтатьяРасходов,
	|	ПорядокУчетаОСБУ.АналитикаРасходовБУ КАК АналитикаРасходов,
	|	СчетаБухгалтерскогоУчетаОС.СчетУчета КАК СчетУчетаНСБУ,
	|	СчетаБухгалтерскогоУчетаОС.СчетНачисленияАмортизации КАК СчетАмортизацииНСБУ,
	|	ПервоначальныеСведенияОС.СпособПоступления КАК СпособПоступления,
	|	ПараметрыАмортизацииОСБухгалтерскийУчет.КоэффициентУскорения КАК КоэффициентУскоренияНСБУ,
	|	ПорядокУчетаОС.ОбъемНаработки КАК ПредполагаемыйОбъемПродукцииНСБУ,
	|	ПорядокУчетаОС.ПоказательНаработки КАК ПараметрВыработкиНСБУ,
	|	МестонахождениеОС.Местонахождение КАК Подразделение,
	|	ПорядокУчетаОС.НаправлениеДеятельности КАК НаправлениеДеятельности
	|ПОМЕСТИТЬ втПараметрыВНА
	|ИЗ
	|	РегистрСведений.ПервоначальныеСведенияОС.СрезПоследних(
	|			{(&ДатаОкончания)},
	|			Организация = &Организация
	|				И ОсновноеСредство В
	|					(ВЫБРАТЬ
	|						т.ВНА
	|					ИЗ
	|						втОбороты КАК т)) КАК ПервоначальныеСведенияОС
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыАмортизацииОСБУ.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И ОсновноеСредство В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)) КАК ПараметрыАмортизацииОСБухгалтерскийУчет
	|		ПО ПервоначальныеСведенияОС.ОсновноеСредство = ПараметрыАмортизацииОСБухгалтерскийУчет.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСБУ.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И ОсновноеСредство В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)) КАК ПорядокУчетаОСБУ
	|		ПО ПервоначальныеСведенияОС.ОсновноеСредство = ПорядокУчетаОСБУ.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОС.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				ОсновноеСредство В
	|					(ВЫБРАТЬ
	|						т.ВНА
	|					ИЗ
	|						втОбороты КАК т)) КАК ПорядокУчетаОС
	|		ПО ПервоначальныеСведенияОС.ОсновноеСредство = ПорядокУчетаОС.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОС.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И ОсновноеСредство В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)) КАК СчетаБухгалтерскогоУчетаОС
	|		ПО ПервоначальныеСведенияОС.ОсновноеСредство = СчетаБухгалтерскогоУчетаОС.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСБУ.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И ОсновноеСредство В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)
	|					И НЕ(Регистратор ССЫЛКА Документ.СписаниеОС
	|							ИЛИ Регистратор ССЫЛКА Документ.СписаниеОС2_4)) КАК НачислениеАмортизацииОСБухгалтерскийУчет
	|		ПО ПервоначальныеСведенияОС.ОсновноеСредство = НачислениеАмортизацииОСБухгалтерскийУчет.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестонахождениеОС.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И ОсновноеСредство В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)) КАК МестонахождениеОС
	|		ПО ПервоначальныеСведенияОС.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство
	|ГДЕ
	|	&ПараметрыВНА
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПервоначальныеСведенияНМА.НематериальныйАктив,
	|	ИСТИНА,
	|	ПараметрыАмортизацииНМАБУ.СрокПолезногоИспользованияБУ,
	|	ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ,
	|	ВЫБОР
	|		КОГДА ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииНМА.Линейный)
	|			ТОГДА ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииВНА.Линейный)
	|		КОГДА ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииНМА.УменьшаемогоОстатка)
	|			ТОГДА ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииВНА.УменьшаемогоОстатка)
	|		КОГДА ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|			ТОГДА ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииВНА.ПропорциональноОбъемуПродукции)
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПЕРЕЧИСЛЕНИЕ.СпособыНачисленияАмортизацииВНА.Линейный)
	|	КОНЕЦ,
	|	ПорядокУчетаНМАБУ.СтатьяРасходовБУ,
	|	ПорядокУчетаНМАБУ.АналитикаРасходовБУ,
	|	ПорядокУчетаНМА.СчетУчета,
	|	ПорядокУчетаНМА.СчетНачисленияАмортизации,
	|	ПервоначальныеСведенияНМА.СпособПоступления,
	|	ПервоначальныеСведенияНМА.Коэффициент,
	|	ПорядокУчетаНМА.ОбъемНаработки,
	|	""ПорядокУчетаНМА.ПоказательНаработки"",
	|	МестоУчетаНМА.Подразделение,
	|	ПорядокУчетаНМА.НаправлениеДеятельности
	|ИЗ
	|	РегистрСведений.ПервоначальныеСведенияНМА.СрезПоследних(
	|			{(&ДатаОкончания)},
	|			Организация = &Организация
	|				И НематериальныйАктив В
	|					(ВЫБРАТЬ
	|						т.ВНА
	|					ИЗ
	|						втОбороты КАК т)) КАК ПервоначальныеСведенияНМА
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыАмортизацииНМАБУ.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И НематериальныйАктив В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)) КАК ПараметрыАмортизацииНМАБУ
	|		ПО ПервоначальныеСведенияНМА.НематериальныйАктив = ПараметрыАмортизацииНМАБУ.НематериальныйАктив
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаНМАБУ.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И НематериальныйАктив В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)) КАК ПорядокУчетаНМАБУ
	|		ПО ПервоначальныеСведенияНМА.НематериальныйАктив = ПорядокУчетаНМАБУ.НематериальныйАктив
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаНМА.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И НематериальныйАктив В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)) КАК ПорядокУчетаНМА
	|		ПО ПервоначальныеСведенияНМА.НематериальныйАктив = ПорядокУчетаНМА.НематериальныйАктив
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестоУчетаНМА.СрезПоследних(
	|				{(&ДатаОкончания)},
	|				Организация = &Организация
	|					И НематериальныйАктив В
	|						(ВЫБРАТЬ
	|							т.ВНА
	|						ИЗ
	|							втОбороты КАК т)) КАК МестоУчетаНМА
	|		ПО ПервоначальныеСведенияНМА.НематериальныйАктив = МестоУчетаНМА.НематериальныйАктив
	|ГДЕ
	|	&ПараметрыВНА
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВНА";

КонецФункции

Функция ТекстЗапроса_втПрофили(НомераТаблиц)

	НомераТаблиц.Вставить("втПрофили", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	МАКСИМУМ(СпособыОтраженияРасходовПоАмортизацииМСФО.Ссылка) КАК СпособОтраженияРасходовМСФО,
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.СтатьяРасходов КАК СтатьяРасходов,
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.АналитикаРасходов КАК АналитикаРасходов,
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.Подразделение КАК Подразделение,
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.НаправлениеДеятельности КАК НаправлениеДеятельности
	|ПОМЕСТИТЬ втПрофили
	|ИЗ
	|	Справочник.СпособыОтраженияРасходовПоАмортизацииМСФО КАК СпособыОтраженияРасходовПоАмортизацииМСФО
	|ГДЕ
	|	(СпособыОтраженияРасходовПоАмортизацииМСФО.СтатьяРасходов, СпособыОтраженияРасходовПоАмортизацииМСФО.АналитикаРасходов, СпособыОтраженияРасходовПоАмортизацииМСФО.Подразделение, СпособыОтраженияРасходовПоАмортизацииМСФО.НаправлениеДеятельности) В
	|			(ВЫБРАТЬ
	|				втПараметрыВНА.СтатьяРасходов,
	|				втПараметрыВНА.АналитикаРасходов,
	|				втПараметрыВНА.Подразделение,
	|				втПараметрыВНА.НаправлениеДеятельности
	|			ИЗ
	|				втПараметрыВНА КАК втПараметрыВНА)
	|
	|СГРУППИРОВАТЬ ПО
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.СтатьяРасходов,
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.АналитикаРасходов,
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.Подразделение,
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.НаправлениеДеятельности
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.СтатьяРасходов,
	|	СпособыОтраженияРасходовПоАмортизацииМСФО.АналитикаРасходов
	|";
	
КонецФункции

Функция ТекстЗапроса_втСчетаБД(НомераТаблиц)
	
	НомераТаблиц.Вставить("втСчетаБД", НомераТаблиц.Количество());
	
	Возврат
	"ВЫБРАТЬ
	|	МАКСИМУМ(СчетаБД.Ссылка) КАК СчетБД,
	|	СчетаБД.СчетСсылка КАК СчетИсточник,
	|	ЕСТЬNULL(МАКСИМУМ(СоответствияСчетовДляТрансляции.СчетПриемник), ЗНАЧЕНИЕ(Справочник.СчетаБД.ПустаяСсылка)) КАК СчетБДМСФО
	|ПОМЕСТИТЬ втСчетаБД
	|ИЗ
	|	Справочник.СчетаБД КАК СчетаБД
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СоответствияСчетовДляТрансляции КАК СоответствияСчетовДляТрансляции
	|		ПО (СоответствияСчетовДляТрансляции.СчетИсточник = СчетаБД.Ссылка)
	|			И (СоответствияСчетовДляТрансляции.Владелец = &ШаблонТрансляции)
	|ГДЕ
	|	(СчетаБД.СчетСсылка В
	|				(ВЫБРАТЬ
	|					т.СчетДт
	|				ИЗ
	|					втОбороты КАК т)
	|			ИЛИ СчетаБД.СчетСсылка В
	|				(ВЫБРАТЬ
	|					т.СчетКт
	|				ИЗ
	|					втОбороты КАК т)
	|			ИЛИ СчетаБД.СчетСсылка В
	|				(ВЫБРАТЬ
	|					втПараметрыВНА.СчетАмортизацииНСБУ
	|				ИЗ
	|					втПараметрыВНА КАК втПараметрыВНА))
	|
	|СГРУППИРОВАТЬ ПО
	|	СчетаБД.СчетСсылка
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СчетИсточник";

КонецФункции

Функция ТекстЗапроса_втСуммыПереоценки(НомераТаблиц)
	
	Возврат
	"ВЫБРАТЬ
	|	т.Ссылка КАК Регистратор,
	|	т.ОсновноеСредство КАК ВНА,
	|	т.СтоимостьБУ КАК СправедливаяСтоимость
	|ПОМЕСТИТЬ втСуммыПереоценки
	|ИЗ
	|	Документ.ПереоценкаОС2_4.ОС КАК т
	|ГДЕ
	|	(т.Ссылка, т.ОсновноеСредство) В
	|			(ВЫБРАТЬ
	|				т.ДокументОснование,
	|				т.ВНА
	|			ИЗ
	|				втОбороты КАК т)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	т.Ссылка,
	|	т.ОсновноеСредство,
	|	т.Стоимость
	|ИЗ
	|	Документ.ПереоценкаОС.ОС КАК т
	|ГДЕ
	|	(т.Ссылка, т.ОсновноеСредство) В
	|			(ВЫБРАТЬ
	|				т.ДокументОснование,
	|				т.ВНА
	|			ИЗ
	|				втОбороты КАК т)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	т.Ссылка,
	|	т.НематериальныйАктив,
	|	т.СтоимостьБУ
	|ИЗ
	|	Документ.ПереоценкаНМА2_4.НМА КАК т
	|ГДЕ
	|	(т.Ссылка, т.НематериальныйАктив) В
	|			(ВЫБРАТЬ
	|				т.ДокументОснование,
	|				т.ВНА
	|			ИЗ
	|				втОбороты КАК т)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	т.Ссылка,
	|	т.НематериальныйАктив,
	|	т.Стоимость
	|ИЗ
	|	Документ.ПереоценкаНМА КАК т
	|ГДЕ
	|	(т.Ссылка, т.НематериальныйАктив) В
	|			(ВЫБРАТЬ
	|				т.ДокументОснование,
	|				т.ВНА
	|			ИЗ
	|				втОбороты КАК т)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	ВНА
	|";

КонецФункции

Функция ТекстЗапроса_СобытияВНА(НомераТаблиц)

	НомераТаблиц.Вставить("СобытияВНА", НомераТаблиц.Количество());

	Возврат
	"ВЫБРАТЬ
	|	втОбороты.КлассВНА КАК КлассВНА,
	|	втОбороты.ДокументОснование КАК ДокументОснование,
	|	втОбороты.ВНА КАК ВНА,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(втПараметрыДляЗаполненияВНА.ПараметрыУчетаВНА, ЗНАЧЕНИЕ(Справочник.ГруппыВНАМСФО.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.ГруппыВНАМСФО.ПустаяСсылка)
	|			ТОГДА ""Трансляция""
	|		ИНАЧЕ ""Параллельный учет""
	|	КОНЕЦ КАК ВариантУчета,
	|	ЕСТЬNULL(втПринятиеИВводВПериоде.ДатаСобытияНСБУ, втОбороты.ДатаСобытияНСБУ) КАК ДатаСобытияНСБУ,
	|	ЕСТЬNULL(втСуммыПереоценки.СправедливаяСтоимость, втОбороты.СуммаНСБУ) КАК СуммаНСБУ,
	|	ЕСТЬNULL(втПараметрыВНА.НачислятьАмортизациюНСБУ, ЛОЖЬ) КАК НачислятьАмортизациюНСБУ,
	|	втПараметрыВНА.СрокПолезногоИспользованияНСБУ КАК СрокПолезногоИспользованияНСБУ,
	|	втПараметрыВНА.СпособНачисленияАмортизацииМСФО КАК СпособНачисленияАмортизацииНСБУ,
	|	втПараметрыВНА.СпособНачисленияАмортизацииМСФО КАК СпособНачисленияАмортизацииМСФО,
	|	втПараметрыВНА.СтатьяРасходов КАК СтатьяРасходов,
	|	втПараметрыВНА.АналитикаРасходов КАК АналитикаРасходов,
	|	втПрофили.СпособОтраженияРасходовМСФО КАК СпособОтраженияРасходовПоАмортизацииМСФО,
	|	ВЫБОР втПараметрыВНА.СпособПоступления
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияАктивов.ПриобретениеЗаПлату)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.Приобретено)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияАктивов.Строительство)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.СтроительствоСоздание)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияАктивов.ВкладВУставныйКапитал)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.ПолученоВКачествеВзносаВУК)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияАктивов.ВОбменНаДругоеИмущество)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.ПолученоПоДоговоруМены)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияАктивов.БезвозмездноеПоступление)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.БезвозмездноеПоступление)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияАктивов.ПоДоговоруАренды)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.ПоДоговоруАренды)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияАктивов.ПоступлениеВДоверительноеУправление)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.ПоступлениеВДоверительноеУправление)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияАктивов.ВкладВСовместнуюДеятельность)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.ВкладВСовместнуюДеятельность)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СпособыПоступленияОбъектовВНА.Иное)
	|	КОНЕЦ КАК СпособПоступления,
	|	втПараметрыВНА.КоэффициентУскоренияНСБУ КАК КоэффициентУскоренияНСБУ,
	|	втПараметрыВНА.ПредполагаемыйОбъемПродукцииНСБУ КАК ПредполагаемыйОбъемПродукцииНСБУ,
	|	втПараметрыВНА.ПараметрВыработкиНСБУ КАК ПараметрВыработкиНСБУ,
	|	втСчетДт.СчетБД КАК СчетДт,
	|	втОбороты.СубконтоДт1 КАК ОбъектВНАДт,
	|	ЕСТЬNULL(втПринятиеИВводВПериоде.СубконтоКт1, втОбороты.СубконтоКт1) КАК ОбъектВНАКт,
	|	втОбороты.КоличествоДт КАК КоличествоДт,
	|	ЕСТЬNULL(втПринятиеИВводВПериоде.КоличествоКт, втОбороты.КоличествоКт) КАК КоличествоКт,
	|	ЕСТЬNULL(втПринятиеИВводВПериоде.ВалютнаяСуммаКт, втОбороты.ВалютнаяСуммаКт) КАК ВалютнаяСуммаКт,
	|	втОбороты.ВалютаДт КАК ВалютаДт,
	|	ЕСТЬNULL(втПринятиеИВводВПериоде.ВалютаКт, втОбороты.ВалютаКт) КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(втПараметрыДляЗаполненияВНА.ЕстьВУчете, ЛОЖЬ)
	|				И втОбороты.СобытиеВНА В (ЗНАЧЕНИЕ(Справочник.ВидыОпераций.ВводВЭксплуатацию), ЗНАЧЕНИЕ(Справочник.ВидыОпераций.ПринятиеКУчетуВНА))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ВидыОпераций.МодернизацияВНА)
	|		ИНАЧЕ втОбороты.СобытиеВНА
	|	КОНЕЦ КАК ВидОперации,
	|	ЕСТЬNULL(втПараметрыДляЗаполненияВНА.ЕстьВУчете, ЛОЖЬ) КАК ПринятРанееКУчетуМСФО,
	|	втСчетДт.СчетБДМСФО КАК СчетДтМСФО,
	|	ЕСТЬNULL(втСчетКтПринятие.СчетБДМСФО, втСчетКт.СчетБДМСФО) КАК СчетКтМСФО,
	|	ЕСТЬNULL(втСчетУчетаНСБУ.СчетБД, втСчетДт.СчетБД) КАК СчетУчетаВНАНСБУ,
	|	ЕСТЬNULL(втСчетУчетаНСБУ.СчетБДМСФО, втСчетДт.СчетБДМСФО) КАК СчетУчетаВНАМСФО,
	|	ЕСТЬNULL(втСчетАмортизацииНСБУ.СчетБД, ЗНАЧЕНИЕ(Справочник.СчетаБД.ПустаяСсылка)) КАК СчетАмортизацииНСБУ,
	|	ЕСТЬNULL(втСчетАмортизацииНСБУ.СчетБДМСФО, ЗНАЧЕНИЕ(Справочник.СчетаБД.ПустаяСсылка)) КАК СчетАмортизацииМСФО,
	|	-втОборотыАмортизацияПриВыбытии.СуммаНСБУ КАК АмортизацияНСБУ,
	|	ВЫБОР
	|		КОГДА втОбороты.КлассВНА = ЗНАЧЕНИЕ(Перечисление.КлассыВНА.НезавершенноеСтроительство)
	|				И втПараметрыДляЗаполненияВНА.ПараметрыУчетаНЗС <> ЗНАЧЕНИЕ(Справочник.ГруппыВНАМСФО.ПустаяСсылка)
	|			ТОГДА втПараметрыДляЗаполненияВНА.ПараметрыУчетаНЗС
	|		ИНАЧЕ втПараметрыДляЗаполненияВНА.ПараметрыУчетаВНА
	|	КОНЕЦ КАК ПараметрыУчетаВНА,
	|	втОбороты.СубконтоДт1 КАК СубконтоДт1,
	|	втОбороты.СубконтоДт2 КАК СубконтоДт2,
	|	втОбороты.СубконтоДт3 КАК СубконтоДт3,
	|	ЕСТЬNULL(втСчетКтПринятие.СчетБД, втСчетКт.СчетБД) КАК СчетКт,
	|	ЕСТЬNULL(втПринятиеИВводВПериоде.СубконтоКт1, втОбороты.СубконтоКт1) КАК СубконтоКт1,
	|	ЕСТЬNULL(втПринятиеИВводВПериоде.СубконтоКт2, втОбороты.СубконтоКт2) КАК СубконтоКт2,
	|	ЕСТЬNULL(втПринятиеИВводВПериоде.СубконтоКт3, втОбороты.СубконтоКт3) КАК СубконтоКт3,
	|	втПараметрыВНА.СтатьяРасходов КАК СтатьяРасходов1,
	|	втПараметрыВНА.АналитикаРасходов КАК АналитикаРасходов1,
	|	втОбороты.ПодразделениеДт КАК ПодразделениеДт,
	|	втОбороты.ПодразделениеКт КАК ПодразделениеКт,
	|	втОбороты.НаправлениеДеятельностиДт КАК НаправлениеДеятельностиДт,
	|	втОбороты.НаправлениеДеятельностиКт КАК НаправлениеДеятельностиКт,
	|	ОбъектыАрендыПоУмолчаниюМСФО.ФИ КАК ФИ,
	|	НЕ ОбъектыАрендыПоУмолчаниюМСФО.ФИ ЕСТЬ NULL
	|		И НЕ ЕСТЬNULL(втПараметрыДляЗаполненияВНА.ЕстьВУчете, ЛОЖЬ)
	|		И втОбороты.СобытиеВНА В (ЗНАЧЕНИЕ(Справочник.ВидыОпераций.ВводВЭксплуатацию)) КАК ПризнаетсяКакЛизинг
	|ИЗ
	|	втОбороты КАК втОбороты
	|		ЛЕВОЕ СОЕДИНЕНИЕ втПараметрыДляЗаполненияВНА КАК втПараметрыДляЗаполненияВНА
	|		ПО втОбороты.ВНА = втПараметрыДляЗаполненияВНА.ВНА
	|		ЛЕВОЕ СОЕДИНЕНИЕ втПараметрыВНА КАК втПараметрыВНА
	|			ЛЕВОЕ СОЕДИНЕНИЕ втСчетаБД КАК втСчетУчетаНСБУ
	|			ПО втПараметрыВНА.СчетУчетаНСБУ = втСчетУчетаНСБУ.СчетИсточник
	|			ЛЕВОЕ СОЕДИНЕНИЕ втСчетаБД КАК втСчетАмортизацииНСБУ
	|			ПО втПараметрыВНА.СчетАмортизацииНСБУ = втСчетАмортизацииНСБУ.СчетИсточник
	|			ЛЕВОЕ СОЕДИНЕНИЕ втПрофили КАК втПрофили
	|			ПО втПараметрыВНА.СтатьяРасходов = втПрофили.СтатьяРасходов
	|				И втПараметрыВНА.АналитикаРасходов = втПрофили.АналитикаРасходов
	|				И втПараметрыВНА.Подразделение = втПрофили.Подразделение
	|				И втПараметрыВНА.НаправлениеДеятельности = втПрофили.НаправлениеДеятельности
	|		ПО втОбороты.ВНА = втПараметрыВНА.ВНА
	|			И (втОбороты.КлассВНА <> ЗНАЧЕНИЕ(Перечисление.КлассыВНА.НезавершенноеСтроительство))
	|		ЛЕВОЕ СОЕДИНЕНИЕ втСчетаБД КАК втСчетДт
	|		ПО втОбороты.СчетДт = втСчетДт.СчетИсточник
	|		ЛЕВОЕ СОЕДИНЕНИЕ втСчетаБД КАК втСчетКт
	|		ПО втОбороты.СчетКт = втСчетКт.СчетИсточник
	|		ЛЕВОЕ СОЕДИНЕНИЕ втОбороты КАК втОборотыАмортизацияПриВыбытии
	|		ПО втОбороты.ВНА = втОборотыАмортизацияПриВыбытии.ВНА
	|			И втОбороты.ДокументОснование = втОборотыАмортизацияПриВыбытии.ДокументОснование
	|			И (втОборотыАмортизацияПриВыбытии.УточнениеСобытия = ""АмортизацияПриВыбытии"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ втПринятиеИВводВПериоде КАК втПринятиеИВводВПериоде
	|			ЛЕВОЕ СОЕДИНЕНИЕ втСчетаБД КАК втСчетКтПринятие
	|			ПО втПринятиеИВводВПериоде.СчетКт = втСчетКтПринятие.СчетИсточник
	|		ПО втОбороты.ВНА = втПринятиеИВводВПериоде.ПриемникВНА
	|			И втОбороты.ДокументОснование = втПринятиеИВводВПериоде.ПриемникДокументОснование
	|			И (НЕ втОбороты.УточнениеСобытия = ""АмортизацияПриПеремещении"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ втСуммыПереоценки КАК втСуммыПереоценки
	|		ПО втОбороты.ДокументОснование = втСуммыПереоценки.Регистратор
	|			И втОбороты.ВНА = втСуммыПереоценки.ВНА
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ОбъектыАрендыПоУмолчаниюМСФО КАК ОбъектыАрендыПоУмолчаниюМСФО
	|		ПО втОбороты.ВНА = ОбъектыАрендыПоУмолчаниюМСФО.ВНА
	|ГДЕ
	|	НЕ втОбороты.УточнениеСобытия В (""АмортизацияПриВыбытии"", ""РезервПереоценкиИсключение"")
	|	И ВЫБОР
	|			КОГДА втОбороты.УточнениеСобытия = ""АмортизацияПриПеремещении""
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ НЕ (втОбороты.ВНА, втОбороты.ДокументОснование, втОбороты.СчетКт) В
	|						(ВЫБРАТЬ
	|							т.ИсточникВНА,
	|							т.ИсточникДокументОснование,
	|							т.СчетКт
	|						ИЗ
	|							втПринятиеИВводВПериоде КАК т)
	|		КОНЕЦ
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДатаСобытияНСБУ,
	|	ВНА";

КонецФункции

#КонецОбласти
                