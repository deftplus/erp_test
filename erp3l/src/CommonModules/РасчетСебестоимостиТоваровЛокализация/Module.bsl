#Область ПрограммныйИнтерфейс

#Область Проведение

// Описывает учетные механизмы используемые в документе для регистрации в механизме проведения.
//
// Параметры:
//  МеханизмыДокумента - Массив - список имен учетных механизмов, для которых будет выполнена
//              регистрация в механизме проведения.
//
Процедура ЗарегистрироватьУчетныеМеханизмы(МеханизмыДокумента) Экспорт
	
	//++ Локализация
	
	//-- Локализация
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытий

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый документ.
//  Отказ - Булево - Признак проведения документа.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то проведение документа выполнено не будет.
//  РежимПроведения - РежимПроведенияДокумента - В данный параметр передается текущий режим проведения.
//
Процедура ОбработкаПроведения(Объект, Отказ, РежимПроведения) Экспорт
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  Отказ - Булево - Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то будет выполнен отказ от продолжения работы после выполнения проверки заполнения.
//  ПроверяемыеРеквизиты - Массив - Массив путей к реквизитам, для которых будет выполнена проверка заполнения.
//
Процедура ОбработкаПроверкиЗаполнения(Объект, Отказ, ПроверяемыеРеквизиты) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект.
//  ДанныеЗаполнения - Произвольный - Значение, которое используется как основание для заполнения.
//  СтандартнаяОбработка - Булево - В данный параметр передается признак выполнения стандартной (системной) обработки события.
//
Процедура ОбработкаЗаполнения(Объект, ДанныеЗаполнения, СтандартнаяОбработка) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то запись выполнена не будет и будет вызвано исключение.
//
Процедура ОбработкаУдаленияПроведения(Объект, Отказ) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то запись выполнена не будет и будет вызвано исключение.
//  РежимЗаписи - РежимЗаписиДокумента - В параметр передается текущий режим записи документа. Позволяет определить в теле процедуры режим записи.
//  РежимПроведения - РежимПроведенияДокумента - В данный параметр передается текущий режим проведения.
//
Процедура ПередЗаписью(Объект, Отказ, РежимЗаписи, РежимПроведения) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина, то запись выполнена не будет и будет вызвано исключение.
//
Процедура ПриЗаписи(Объект, Отказ) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  ОбъектКопирования - ДокументОбъект - Исходный документ, который является источником копирования.
//
Процедура ПриКопировании(Объект, ОбъектКопирования) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

#Область ПодключаемыеКоманды

// Определяет список команд создания на основании.
//
// Параметры:
//  КомандыСозданияНаОсновании - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.КомандыСозданияНаОсновании
//  Параметры - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.Параметры
//
Процедура ДобавитьКомандыСозданияНаОсновании(КомандыСозданияНаОсновании, Параметры) Экспорт
	
	
КонецПроцедуры

// Добавляет команду создания документа "Авансовый отчет".
//
// Параметры:
//  КомандыСозданияНаОсновании - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.КомандыСозданияНаОсновании
//
Процедура ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании) Экспорт


КонецПроцедуры

// Определяет список команд отчетов.
//
// Параметры:
//   КомандыОтчетов - См. ВариантыОтчетовПереопределяемый.ПередДобавлениемКомандОтчетов.КомандыОтчетов
//   Параметры - См. ВариантыОтчетовПереопределяемый.ПередДобавлениемКомандОтчетов.Параметры
//
Процедура ДобавитьКомандыОтчетов(КомандыОтчетов, Параметры) Экспорт
	
	
КонецПроцедуры

// Заполняет список команд печати.
//
// Параметры:
//   КомандыПечати - см. УправлениеПечатью.СоздатьКоллекциюКомандПечати
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

#Область Печать

// Формирует печатные формы.
//
// Параметры:
//  МассивОбъектов  - Массив    - ссылки на объекты, которые нужно распечатать;
//  ПараметрыПечати - Структура - дополнительные настройки печати;
//  КоллекцияПечатныхФорм - ТаблицаЗначений - сформированные табличные документы (выходной параметр)
//  ОбъектыПечати         - СписокЗначений  - значение - ссылка на объект;
//                                            представление - имя области в которой был выведен объект (выходной параметр);
//  ПараметрыВывода       - Структура       - дополнительные параметры сформированных табличных документов (выходной параметр).
//
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

//++ НЕ УТ
#Область ПроводкиРегУчета

// Функция возвращает текст запроса для отражения документа в регламентированном учете.
//
// Возвращаемое значение:
//	Строка - Текст запроса
//
Функция ТекстОтраженияВРеглУчете() Экспорт
	
	//++ Локализация
	
	ТекстыОтражения = Новый Массив;
	
#Область ТекстПогрешностьРасчетаСебестоимости
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Погрешность расчета себестоимости (Дт 91.02 :: Кт 41,10.07,20)
	|
	|	Строки.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	(Строки.Сумма) КАК Сумма,
	|	(Строки.СуммаУпр) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.СтатьяРасходов, Строки.СтатьяРасходов) КАК АналитикаУчетаДт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.Подразделение, Строки.Подразделение) КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.Подразделение, Строки.Подразделение) КАК ПодразделениеДт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.НаправлениеДеятельности, Строки.НаправлениеДеятельности) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.СтатьяРасходов, Строки.СтатьяРасходов) КАК СубконтоДт1,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КАК СубконтоДт2,
	|	ЕСТЬNULL(ВТПрочиеРасходы.АналитикаРасходов, Строки.Субконто1) КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(Строки.СуммаНУ) КАК СуммаНУДт,
	|	(Строки.СуммаПР) КАК СуммаПРДт,
	|	(Строки.СуммаВР) КАК СуммаВРДт,
	|
	|	Строки.ВидСчета КАК ВидСчетаКт,
	|	Строки.АналитикаУчета КАК АналитикаУчетаКт,
	|	Строки.МестоУчета КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|
	|	Строки.Субконто1 КАК СубконтоКт1,
	|	Строки.Субконто2 КАК СубконтоКт2,
	|	Строки.Субконто3 КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(Строки.СуммаНУ) КАК СуммаНУКт,
	|	(Строки.СуммаПР) КАК СуммаПРКт,
	|	(Строки.СуммаВР) КАК СуммаВРКт,
	|	Строки.Содержание КАК Содержание
	|ИЗ
	|	ВтПогрешностьТовары КАК Строки
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТПрочиеРасходы КАК ВТПрочиеРасходы
	|	ПО
	|		ВТПрочиеРасходы.Ссылка = Строки.Ссылка
	|		И ВТПрочиеРасходы.Организация = Строки.Организация
	|		И ВТПрочиеРасходы.СтатьяРасходов = Строки.СтатьяРасходов
	|		И ВТПрочиеРасходы.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти

#Область ТекстПогрешностьРасчетаПрочихРасходов
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Погрешность расчета прочих расходов (Дт 91.02 :: Кт 26)
	|
	|	Строки.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	(Строки.Сумма) КАК Сумма,
	|	(Строки.СуммаУпр) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	ВТПрочиеРасходы.СтатьяРасходов КАК АналитикаУчетаДт,
	|	ВТПрочиеРасходы.Подразделение КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ВТПрочиеРасходы.Подразделение КАК ПодразделениеДт,
	|	ВТПрочиеРасходы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	ВТПрочиеРасходы.СтатьяРасходов КАК СубконтоДт1,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КАК СубконтоДт2,
	|	ВТПрочиеРасходы.АналитикаРасходов КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(Строки.СуммаНУ) КАК СуммаНУДт,
	|	(Строки.СуммаПР) КАК СуммаПРДт,
	|	(Строки.СуммаВР) КАК СуммаВРДт,
	|
	|	Строки.ВидСчета КАК ВидСчетаКт,
	|	Строки.АналитикаУчета КАК АналитикаУчетаКт,
	|	Строки.МестоУчета КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|
	|	Строки.Субконто1 КАК СубконтоКт1,
	|	Строки.Субконто2 КАК СубконтоКт2,
	|	Строки.Субконто3 КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(Строки.СуммаНУ) КАК СуммаНУКт,
	|	(Строки.СуммаПР) КАК СуммаПРКт,
	|	(Строки.СуммаВР) КАК СуммаВРКт,
	|	Строки.Содержание КАК Содержание
	|ИЗ
	|	ВтПогрешностьПрочиеРасходы КАК Строки
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТПрочиеРасходы КАК ВТПрочиеРасходы
	|	ПО
	|		ВТПрочиеРасходы.Ссылка = Строки.Ссылка
	|		И ВТПрочиеРасходы.Организация = Строки.Организация
	|		И ВТПрочиеРасходы.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти

#Область ТекстПогрешностьРасчетаРезервов
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Погрешность расчета себестоимости (Дт 96 :: Кт 91.02)
	|
	|	РезервыПредстоящихРасходов.Регистратор КАК Ссылка,
	|	РезервыПредстоящихРасходов.Период КАК Период,
	|	РезервыПредстоящихРасходов.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	СУММА(РезервыПредстоящихРасходов.СуммаРегл) КАК Сумма,
	|	СУММА(РезервыПредстоящихРасходов.СуммаУпр) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Резервы) КАК ВидСчетаДт,
	|	РезервыПредстоящихРасходов.ВидРезервов КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	РезервыПредстоящихРасходов.ОбъектУчетаРезервов.ПодразделениеНачисления КАК ПодразделениеДт,
	|	РезервыПредстоящихРасходов.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	РезервыПредстоящихРасходов.ВидРезервов КАК СубконтоДт1,
	|	РезервыПредстоящихРасходов.ОбъектУчетаРезервов КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаКт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.СтатьяРасходов, СтатьиРасходов.Ссылка) КАК АналитикаУчетаКт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.Подразделение, РезервыПредстоящихРасходов.ОбъектУчетаРезервов.ПодразделениеСписания) КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.Подразделение, РезервыПредстоящихРасходов.ОбъектУчетаРезервов.ПодразделениеСписания) КАК ПодразделениеКт,
	|	ЕСТЬNULL(ВТПрочиеРасходы.НаправлениеДеятельности, РезервыПредстоящихРасходов.ОбъектУчетаРезервов.НаправлениеДеятельностиСписания) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|
	|	ЕСТЬNULL(ВТПрочиеРасходы.СтатьяРасходов, СтатьиРасходов.Ссылка) КАК СубконтоКт1,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КАК СубконтоКт2,
	|	ЕСТЬNULL(ВТПрочиеРасходы.АналитикаРасходов, НЕОПРЕДЕЛЕНО) КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	СУММА(РезервыПредстоящихРасходов.СуммаРегл) КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Погрешность расчета себестоимости (резервы)"" КАК Содержание
	|ИЗ
	|	РегистрНакопления.РезервыПредстоящихРасходов КАК РезервыПредстоящихРасходов
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТПрочиеРасходы КАК ВТПрочиеРасходы
	|	ПО
	|		ВТПрочиеРасходы.Ссылка = РезервыПредстоящихРасходов.Регистратор
	|		И ВТПрочиеРасходы.Организация = РезервыПредстоящихРасходов.Организация
	|		И ВТПрочиеРасходы.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|		И ВТПрочиеРасходы.ИдентификаторФинЗаписи = РезервыПредстоящихРасходов.ИдентификаторФинЗаписи
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		СтатьиРасходов.Ссылка = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|ГДЕ
	|	РезервыПредстоящихРасходов.Регистратор = &Ссылка
	|	И РезервыПредстоящихРасходов.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	РезервыПредстоящихРасходов.Регистратор,
	|	РезервыПредстоящихРасходов.Период,
	|	РезервыПредстоящихРасходов.Организация,
	|	РезервыПредстоящихРасходов.ВидРезервов,
	|	РезервыПредстоящихРасходов.НаправлениеДеятельности,
	|	РезервыПредстоящихРасходов.ОбъектУчетаРезервов,
	|	ЕСТЬNULL(ВТПрочиеРасходы.СтатьяРасходов, СтатьиРасходов.Ссылка),
	|	ЕСТЬNULL(ВТПрочиеРасходы.АналитикаРасходов, НЕОПРЕДЕЛЕНО),
	|	ЕСТЬNULL(ВТПрочиеРасходы.Подразделение, РезервыПредстоящихРасходов.ОбъектУчетаРезервов.ПодразделениеСписания),
	|	ЕСТЬNULL(ВТПрочиеРасходы.НаправлениеДеятельности, РезервыПредстоящихРасходов.ОбъектУчетаРезервов.НаправлениеДеятельностиСписания)
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти

#Область ТекстПогрешностьРасчетаСебестоимостиЗабалансом

	ТекстЗапроса = "
	|ВЫБРАТЬ
	|	Движения.Ссылка КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|	СУММА(Движения.СуммаЗабалансом) КАК Сумма,
	|	0 КАК СуммаУУ,
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеДт,
	|	НЕОПРЕДЕЛЕНО КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	ВЫБОР
	|		КОГДА НЕ (ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Движения.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА (ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Движения.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА НЕ (ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА (ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Движения.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Движения.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Движения.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Движения.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.СкладскаяТерритория.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Движения.ПодразделениеАналитикиУчетаНоменклатуры
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ КАК ПодразделениеКт,
	|	Движения.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|	Движения.Номенклатура КАК СубконтоКт1,
	|	Движения.Контрагент КАК СубконтоКт2,
	|	ЕСТЬNULL(Движения.МестоХранения, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)) КАК СубконтоКт3,
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Погрешность расчета себестоимости (забаланс)"" КАК Содержание
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Движения
	|ГДЕ
	|	Движения.СуммаЗабалансом <> 0
	|	И Движения.ДокументДвижения В (НЕОПРЕДЕЛЕНО, &Ссылка)
	|	И Движения.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Движения.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|	И Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию))
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.Ссылка,
	|	Движения.Период,
	|	Движения.Организация,
	|	Движения.Номенклатура,
	|	Движения.ТипМестаХранения,
	|	Движения.СкладскаяТерритория.Подразделение,
	|	Движения.ПодразделениеАналитикиУчетаНоменклатуры,
	|	Движения.РазделУчета,
	|	Движения.Договор.Подразделение,
	|	Движения.МестоХранения,
	|	ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение),
	|	Движения.ГруппаФинансовогоУчета,
	|	Движения.НаправлениеДеятельности,
	|	Движения.Контрагент,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Движения.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.СкладскаяТерритория.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Движения.ПодразделениеАналитикиУчетаНоменклатуры
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ (ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Движения.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА (ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Движения.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА НЕ (ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА (ЕСТЬNULL(Движения.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Движения.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Движения.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти

#Область ТекстПересортицаПартийРасходы
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отнесение отклонений от пересортицы партий на расходы (Дт 91.02 :: Кт 41,10.07,20)
	|
	|	Строки.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	(Строки.Сумма) КАК Сумма,
	|	(Строки.СуммаУпр) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	ВТПрочиеРасходы.СтатьяРасходов КАК АналитикаУчетаДт,
	|	ВТПрочиеРасходы.Подразделение КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ВТПрочиеРасходы.Подразделение КАК ПодразделениеДт,
	|	ВТПрочиеРасходы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	ВТПрочиеРасходы.СтатьяРасходов КАК СубконтоДт1,
	|	ВТПрочиеРасходы.АналитикаРасходов КАК СубконтоДт2,
	|	ВТПрочиеРасходы.ТипЗатрат КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(Строки.СуммаНУ) КАК СуммаНУДт,
	|	(Строки.СуммаПР) КАК СуммаПРДт,
	|	(Строки.СуммаВР) КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаКт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА Строки.ГруппаФинансовогоУчета
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|		ТОГДА Строки.ГруппаПродукции
	|		КОГДА Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			И Строки.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Строки.Организация = Строки.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(Строки.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|		ТОГДА ЕСТЬNULL(Строки.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		ИНАЧЕ Строки.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|			И Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|			ТОГДА Строки.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ Строки.МестоХранения
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам)
	|			ТОГДА ЕСТЬNULL(Строки.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|			ТОГДА Строки.МестоХранения.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|				И Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ТОГДА Строки.МестоХранения
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ТОГДА Строки.ПодразделениеАналитикиУчетаНоменклатуры
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|			ТОГДА Строки.СтатьяРасходов
	|		ИНАЧЕ Строки.Номенклатура
	|	КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|			ТОГДА Строки.МестоХранения
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА Строки.МестоХранения.Контрагент
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА Строки.Контрагент
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|			ТОГДА Строки.ГруппаПродукции
	|		КОГДА Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА Строки.КонтрагентВидаЗапасов
	|		ИНАЧЕ Строки.МестоХранения
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА Строки.МестоХранения
	|		ИНАЧЕ Строки.Контрагент
	|	КОНЕЦ КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(Строки.СуммаНУ) КАК СуммаНУКт,
	|	(Строки.СуммаПР) КАК СуммаПРКт,
	|	(Строки.СуммаВР) КАК СуммаВРКт,
	|	""Отнесение отклонений от пересортицы партий на расходы"" КАК Содержание
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Строки
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТПрочиеРасходы КАК ВТПрочиеРасходы
	|	ПО
	|		ВТПрочиеРасходы.Ссылка = Строки.Ссылка
	|		И ВТПрочиеРасходы.Организация = Строки.Организация
	|		И ВТПрочиеРасходы.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|ГДЕ
	|	Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Строки.Сумма > 0
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти

#Область ТекстПересортицаПартийДоходы
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отнесение отклонений от пересортицы партий на доходы (Дт 41,10.07,20 :: Кт 91.01)
	|
	|	Строки.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	-(Строки.Сумма) КАК Сумма,
	|	-(Строки.СуммаУпр) КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА Строки.ГруппаФинансовогоУчета
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|		ТОГДА Строки.ГруппаПродукции
	|		КОГДА Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			И Строки.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Строки.Организация = Строки.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(Строки.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|		ТОГДА ЕСТЬNULL(Строки.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		ИНАЧЕ Строки.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|			И Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|			ТОГДА Строки.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ Строки.МестоХранения
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам)
	|			ТОГДА ЕСТЬNULL(Строки.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|			ТОГДА Строки.МестоХранения.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|				И Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ТОГДА Строки.МестоХранения
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ТОГДА Строки.ПодразделениеАналитикиУчетаНоменклатуры
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|			ТОГДА Строки.СтатьяРасходов
	|		ИНАЧЕ Строки.Номенклатура
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|			ТОГДА Строки.МестоХранения
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА Строки.МестоХранения.Контрагент
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА Строки.Контрагент
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение))
	|			ТОГДА Строки.ГруппаПродукции
	|		КОГДА Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА Строки.КонтрагентВидаЗапасов
	|		ИНАЧЕ Строки.МестоХранения
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА Строки.МестоХранения
	|		ИНАЧЕ Строки.Контрагент
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	-(Строки.СуммаНУ) КАК СуммаНУДт,
	|	-(Строки.СуммаПР) КАК СуммаПРДт,
	|	-(Строки.СуммаВР) КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	ВТПрочиеДоходы.СтатьяДоходов КАК АналитикаУчетаКт,
	|	ВТПрочиеДоходы.Подразделение КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ВТПрочиеДоходы.Подразделение КАК ПодразделениеКт,
	|	ВТПрочиеДоходы.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|
	|	ВТПрочиеДоходы.СтатьяДоходов КАК СубконтоКт1,
	|	ВТПрочиеДоходы.АналитикаДоходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	-(Строки.СуммаНУ) КАК СуммаНУКт,
	|	-(Строки.СуммаПР) КАК СуммаПРКт,
	|	-(Строки.СуммаВР) КАК СуммаВРКт,
	|	""Отнесение отклонений от пересортицы партий на доходы"" КАК Содержание
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Строки
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТПрочиеДоходы КАК ВТПрочиеДоходы
	|	ПО
	|		ВТПрочиеДоходы.Ссылка = Строки.Ссылка
	|		И ВТПрочиеДоходы.Организация = Строки.Организация
	|		И ВТПрочиеДоходы.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|ГДЕ
	|	Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Строки.Сумма < 0
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти

#Область ТекстПересортицаПартийРасходыЗабалансом
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отнесение забалансовых отклонений от пересортицы партий на расходы
	|
	|	Строки.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	СУММА(Строки.СуммаЗабалансом) КАК Сумма,
	|	0 КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеДт,
	|	НЕОПРЕДЕЛЕНО КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА НЕ (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА НЕ (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Строки.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Строки.ПодразделениеАналитикиУчетаНоменклатуры
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Строки.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|
	|	Строки.Номенклатура КАК СубконтоКт1,
	|	Строки.Контрагент КАК СубконтоКт2,
	|	ЕСТЬNULL(Строки.МестоХранения, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)) КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Отнесение отклонений от пересортицы партий на расходы (забаланс)"" КАК Содержание
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Строки
	|ГДЕ
	|	Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Строки.СуммаЗабалансом > 0
	|	И Строки.ИдентификаторФинЗаписи <> """"
	|	И Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию))
	|
	|СГРУППИРОВАТЬ ПО
	|	Строки.Ссылка,
	|	Строки.Период,
	|	Строки.Организация,
	|	Строки.Номенклатура,
	|	Строки.ТипМестаХранения,
	|	Строки.СкладскаяТерритория.Подразделение,
	|	Строки.ПодразделениеАналитикиУчетаНоменклатуры,
	|	Строки.РазделУчета,
	|	Строки.Договор.Подразделение,
	|	Строки.МестоХранения,
	|	ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение),
	|	Строки.ГруппаФинансовогоУчета,
	|	Строки.НаправлениеДеятельности,
	|	Строки.Контрагент,
	|	ВЫБОР
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Строки.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Строки.ПодразделениеАналитикиУчетаНоменклатуры
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Строки.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА НЕ (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти

#Область ТекстПересортицаПартийДоходыЗабалансом
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отнесение забалансовых отклонений от пересортицы партий на доходы
	|
	|	Строки.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	-СУММА(Строки.СуммаЗабалансом) КАК Сумма,
	|	0 КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА НЕ (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА НЕ (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Строки.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Строки.ПодразделениеАналитикиУчетаНоменклатуры
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Строки.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.Номенклатура КАК СубконтоДт1,
	|	Строки.Контрагент КАК СубконтоДт2,
	|	ЕСТЬNULL(Строки.МестоХранения, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)) КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеКт,
	|	НЕОПРЕДЕЛЕНО КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Отнесение отклонений от пересортицы партий на доходы (забаланс)"" КАК Содержание
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Строки
	|ГДЕ
	|	Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Строки.СуммаЗабалансом < 0
	|	И Строки.ИдентификаторФинЗаписи <> """"
	|	И Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию))
	|
	|СГРУППИРОВАТЬ ПО
	|	Строки.Ссылка,
	|	Строки.Период,
	|	Строки.Организация,
	|	Строки.Номенклатура,
	|	Строки.ТипМестаХранения,
	|	Строки.СкладскаяТерритория.Подразделение,
	|	Строки.ПодразделениеАналитикиУчетаНоменклатуры,
	|	Строки.РазделУчета,
	|	Строки.Договор.Подразделение,
	|	Строки.МестоХранения,
	|	ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение),
	|	Строки.ГруппаФинансовогоУчета,
	|	Строки.НаправлениеДеятельности,
	|	Строки.Контрагент,
	|	ВЫБОР
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Строки.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Строки.ПодразделениеАналитикиУчетаНоменклатуры
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Строки.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА НЕ (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА (ЕСТЬNULL(Строки.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Строки.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)) И Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Строки.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти
	
#Область ТекстСписаниеМалоценныхТМЦНаРасходы
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание на расходы стоимости малоценных ТМЦ в месяце приобретения 
	|	Строки.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|	
	|	Строки.Сумма КАК Сумма,
	|	Строки.СуммаУпр КАК СуммаУУ,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КАК СубконтоДт1,
	|	Строки.СтатьяРасходов КАК СубконтоДт2,
	|	Строки.Номенклатура КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	Строки.СуммаПР КАК СуммаПРДт,
	|	Строки.СуммаВР КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе) КАК ВидСчетаКт,
	|	
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	Строки.МестоХранения КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ВЫРАЗИТЬ(Строки.МестоХранения КАК Справочник.Склады).Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|	
	|	Строки.Номенклатура КАК СубконтоКт1,
	|	Строки.МестоХранения КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	Строки.СуммаПР КАК СуммаПРКт,
	|	Строки.СуммаВР КАК СуммаВРКт,
	|	""Списание на расходы стоимости малоценных ТМЦ в месяце приобретения"" КАК Содержание
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Строки
	|ГДЕ
	|	Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеНаРасходыМалоценныхТМЦВМесяцеПриобретения)
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
	
#КонецОбласти

	ТекстЗапроса = СтрСоединить(ТекстыОтражения, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
	Возврат ТекстЗапроса;
	
	//-- Локализация
	Возврат "";
	
КонецФункции

// Функция возвращает текст запроса дополнительных временных таблиц,
// необходимых для отражения в регламентированном учете
//
// Возвращаемое значение:
//   Строка - сформированный текст запроса.
//
Функция ТекстЗапросаВТОтраженияВРеглУчете() Экспорт
	
	ТекстЗапроса = "";
	
	//++ Локализация
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область ДвиженияДокументаВРегистреСебестоимости
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СебестоимостьТоваров.Организация,
	|	СебестоимостьТоваров.Период,
	|	СебестоимостьТоваров.Регистратор КАК Ссылка,
	|	СебестоимостьТоваров.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	СебестоимостьТоваров.АналитикаУчетаНоменклатуры,
	|	СебестоимостьТоваров.РазделУчета,
	|	СебестоимостьТоваров.Партия,
	|	СебестоимостьТоваров.ВидЗапасов,
	|	СебестоимостьТоваров.АналитикаФинансовогоУчета,
	|	СебестоимостьТоваров.Подразделение,
	|	СебестоимостьТоваров.КорНаправлениеДеятельности,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|			ИЛИ СебестоимостьТоваров.РасчетСебестоимости
	|		ТОГДА СебестоимостьТоваров.ИдентификаторФинЗаписи
	|		ИНАЧЕ """"
	|	КОНЕЦ КАК ИдентификаторФинЗаписи,
	|	АналитикаНоменклатуры.МестоХранения КАК МестоХранения,
	|	АналитикаНоменклатуры.Номенклатура КАК Номенклатура,
	|	АналитикаНоменклатуры.СкладскаяТерритория КАК СкладскаяТерритория,
	|	АналитикаНоменклатуры.ТипМестаХранения КАК ТипМестаХранения,
	|	АналитикаНоменклатуры.Подразделение КАК ПодразделениеАналитикиУчетаНоменклатуры,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|			И АналитикаНоменклатуры.Номенклатура.ТипНоменклатуры <> ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|		ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.КорВидЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА СебестоимостьТоваров.КорВидЗапасов.Договор
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ВидыЗапасов.Договор
	|		КОГДА СебестоимостьТоваров.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА АналитикаНоменклатуры.Договор
	|		КОГДА СебестоимостьТоваров.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА СебестоимостьТоваров.АналитикаУчетаПоПартнерам.Договор
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
	|	КОНЕЦ КАК Договор,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(СебестоимостьТоваров.Партия) = ТИП(Справочник.ПартииПроизводства)
	|		ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваров.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		ИНАЧЕ ЕСТЬNULL(АналитикаНоменклатуры.Назначение.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))
	|	КОНЕЦ КАК НаправлениеДеятельности,
	|	СебестоимостьТоваров.СтатьяРасходовСписания КАК СтатьяРасходов,
	|	ЕСТЬNULL(ВидыЗапасов.Контрагент, АналитикаНоменклатуры.МестоХранения) КАК КонтрагентВидаЗапасов,
	|	ВЫБОР
	|		КОГДА &ПартионныйУчетВерсии22 И СебестоимостьТоваров.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(СебестоимостьТоваров.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА СебестоимостьТоваров.АналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ СебестоимостьТоваров.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваров.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|		ТОГДА СебестоимостьТоваров.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ КАК ГруппаПродукции,
	|	СебестоимостьТоваров.ДокументДвижения КАК ДокументДвижения,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.КорВидЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА СебестоимостьТоваров.КорВидЗапасов.Контрагент
	|		КОГДА СебестоимостьТоваров.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА СебестоимостьТоваров.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		КОГДА АналитикаНоменклатуры.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|														ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА АналитикаНоменклатуры.Контрагент
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ КАК Контрагент,
	|	СУММА(СебестоимостьТоваров.СтоимостьРегл
	|		+ СебестоимостьТоваров.ДопРасходыРегл
	|		+ СебестоимостьТоваров.ТрудозатратыРегл
	|		+ СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл) КАК Сумма,
	|	СУММА(СебестоимостьТоваров.СтоимостьУпр
	|		+ СебестоимостьТоваров.ДопРасходыУпр
	|		+ СебестоимостьТоваров.ТрудозатратыУпр
	|		+ СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|		+ СебестоимостьТоваров.ПостатейныеПостоянныеУпр) КАК СуммаУпр,
	|	СУММА(СебестоимостьТоваров.СтоимостьРегл
	|		+ СебестоимостьТоваров.ДопРасходыРегл
	|		+ СебестоимостьТоваров.ТрудозатратыРегл
	|		+ СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|		- СебестоимостьТоваров.ПостояннаяРазница
	|		- СебестоимостьТоваров.ВременнаяРазница) КАК СуммаНУ,
	|	СУММА(СебестоимостьТоваров.ПостояннаяРазница) КАК СуммаПР,
	|	СУММА(СебестоимостьТоваров.ВременнаяРазница) КАК СуммаВР,
	|	СУММА(СебестоимостьТоваров.РезервПодОбесценениеРегл) КАК РезервПодОбесценениеРегл,
	|	СУММА(СебестоимостьТоваров.РезервПодОбесценениеУпр) КАК РезервПодОбесценениеУпр,
	|	СУММА(СебестоимостьТоваров.СтоимостьЗабалансоваяРегл) КАК СуммаЗабалансом
	|ПОМЕСТИТЬ
	|	ВТДвиженияСебестоимостиДокумента
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК АналитикаНоменклатуры
	|	ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.Ссылка
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ВидыЗапасов КАК ВидыЗапасов
	|	ПО СебестоимостьТоваров.ВидЗапасов = ВидыЗапасов.Ссылка
	|ГДЕ
	|	СебестоимостьТоваров.Регистратор = &Ссылка
	|	И СебестоимостьТоваров.Активность
	|	И НЕ СебестоимостьТоваров.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПустаяСсылка)
	|СГРУППИРОВАТЬ ПО
	|	СебестоимостьТоваров.Организация,
	|	СебестоимостьТоваров.Период,
	|	СебестоимостьТоваров.Регистратор,
	|	СебестоимостьТоваров.ХозяйственнаяОперация,
	|	СебестоимостьТоваров.АналитикаУчетаНоменклатуры,
	|	СебестоимостьТоваров.РазделУчета,
	|	СебестоимостьТоваров.Партия,
	|	СебестоимостьТоваров.ВидЗапасов,
	|	СебестоимостьТоваров.АналитикаФинансовогоУчета,
	|	СебестоимостьТоваров.Подразделение,
	|	СебестоимостьТоваров.КорНаправлениеДеятельности,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|			ИЛИ СебестоимостьТоваров.РасчетСебестоимости
	|		ТОГДА СебестоимостьТоваров.ИдентификаторФинЗаписи
	|		ИНАЧЕ """"
	|	КОНЕЦ,
	|	АналитикаНоменклатуры.МестоХранения,
	|	АналитикаНоменклатуры.Номенклатура,
	|	АналитикаНоменклатуры.СкладскаяТерритория,
	|	АналитикаНоменклатуры.ТипМестаХранения,
	|	АналитикаНоменклатуры.Подразделение,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|			И АналитикаНоменклатуры.Номенклатура.ТипНоменклатуры <> ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|		ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.КорВидЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА СебестоимостьТоваров.КорВидЗапасов.Договор
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ВидыЗапасов.Договор
	|		КОГДА СебестоимостьТоваров.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА АналитикаНоменклатуры.Договор
	|		КОГДА СебестоимостьТоваров.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА СебестоимостьТоваров.АналитикаУчетаПоПартнерам.Договор
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(СебестоимостьТоваров.Партия) = ТИП(Справочник.ПартииПроизводства)
	|		ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваров.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		ИНАЧЕ ЕСТЬNULL(АналитикаНоменклатуры.Назначение.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))
	|	КОНЕЦ,
	|	СебестоимостьТоваров.СтатьяРасходовСписания,
	|	ЕСТЬNULL(ВидыЗапасов.Контрагент, АналитикаНоменклатуры.МестоХранения),
	|	ВЫБОР
	|		КОГДА &ПартионныйУчетВерсии22 И СебестоимостьТоваров.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(СебестоимостьТоваров.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА СебестоимостьТоваров.АналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ СебестоимостьТоваров.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваров.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|		ТОГДА СебестоимостьТоваров.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|	СебестоимостьТоваров.ДокументДвижения,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.КорВидЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА СебестоимостьТоваров.КорВидЗапасов.Контрагент
	|		КОГДА СебестоимостьТоваров.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА СебестоимостьТоваров.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		КОГДА АналитикаНоменклатуры.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|														ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА АналитикаНоменклатуры.Контрагент
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ";
	
	ТипыДокументовПроизводства22 = Новый Массив;
	ТипыДокументовПроизводства22.Добавить("ТИП(Документ.ДвижениеПродукцииИМатериалов)");
	ТипыДокументовПроизводства22.Добавить("ТИП(Документ.ПроизводствоБезЗаказа)");
	//++ НЕ УТКА
	ТипыДокументовПроизводства22.Добавить("ТИП(Документ.ЭтапПроизводства2_2)");
	//-- НЕ УТКА
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ТипыДокументовПроизводства22", СтрСоединить(ТипыДокументовПроизводства22, ","));
	
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВременнаяТаблицаПереработки
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Погрешность.Организация КАК Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов КАК ВидЗапасов,
	|	МАКСИМУМ(ВЫБОР
	|				КОГДА Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|					ИЛИ Движения.Регистратор ССЫЛКА Документ.ПоступлениеОтПереработчика
	|				ТОГДА ЕСТЬNULL(Погрешность.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|				ИНАЧЕ Движения.Подразделение
	|			КОНЕЦ) КАК Подразделение,
	|	Погрешность.МестоХранения КАК МестоУчета
	|ПОМЕСТИТЬ
	|	Переработка
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Погрешность
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СебестоимостьТоваров КАК Движения
	|		ПО Движения.Организация = Погрешность.Организация
	|			И Движения.АналитикаУчетаНоменклатуры = Погрешность.АналитикаУчетаНоменклатуры
	|			И Движения.РазделУчета = Погрешность.РазделУчета
	|			И Движения.ВидЗапасов = Погрешность.ВидЗапасов
	|ГДЕ
	|	Погрешность.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|	И Погрешность.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|	И Движения.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Дата, МЕСЯЦ)
	|	И Движения.Подразделение <> ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|	И Погрешность.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Погрешность.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|СГРУППИРОВАТЬ ПО
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов,
	|	Погрешность.МестоХранения
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов,
	|	Погрешность.МестоХранения КАК Подразделение,
	|	МАКСИМУМ(ОтчетПереработчика.Партнер) КАК МестоУчета
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Погрешность
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ПартииПроизводства КАК ПартииПроизводства
	|		ПО ПартииПроизводства.Ссылка = Погрешность.Партия
	|		
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтчетПереработчика КАК ОтчетПереработчика
	|		ПО ОтчетПереработчика.Ссылка = ПартииПроизводства.Документ
	|ГДЕ
	|	Погрешность.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|	И Погрешность.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Погрешность.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|СГРУППИРОВАТЬ ПО
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов,
	|	Погрешность.МестоХранения
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов,
	|	Погрешность.СкладскаяТерритория.Подразделение,
	|	Погрешность.СкладскаяТерритория.Подразделение
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Погрешность
	|ГДЕ
	|	Погрешность.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|	И ЕСТЬNULL(Погрешность.СкладскаяТерритория.ЦеховаяКладовая, ЛОЖЬ)
	|	И Погрешность.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Погрешность.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	АналитикаУчетаНоменклатуры,
	|	ВидЗапасов";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВременнаяТаблицаКомиссии
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов,
	|	Погрешность.РазделУчета,
	|	МАКСИМУМ(АналитикаКомиссионера.Контрагент) КАК Контрагент,
	|	МАКСИМУМ(ВЫБОР
	|		КОГДА КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА КорАналитика.МестоХранения
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ) КАК Склад
	|ПОМЕСТИТЬ Комиссия
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Погрешность
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СебестоимостьТоваров КАК Движения
	|		ПО Движения.Организация = Погрешность.Организация
	|		И Движения.АналитикаУчетаНоменклатуры = Погрешность.АналитикаУчетаНоменклатуры
	|		И Движения.РазделУчета = Погрешность.РазделУчета
	|		И Движения.ВидЗапасов = Погрешность.ВидЗапасов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК АналитикаКомиссионера
	|		ПО АналитикаКомиссионера.КлючАналитики = Движения.АналитикаУчетаПоПартнерам
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|		ПО КорАналитика.Ссылка = Движения.КорАналитикаУчетаНоменклатуры
	|ГДЕ
	|	Погрешность.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|	И Погрешность.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер),
	|										ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|	И Движения.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Дата, МЕСЯЦ)
	|	И Движения.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|	И Погрешность.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Погрешность.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|СГРУППИРОВАТЬ ПО
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов,
	|	Погрешность.РазделУчета
	|ИНДЕКСИРОВАТЬ ПО
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов,
	|	Погрешность.РазделУчета";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВременнаяТаблицаПередачиПереработчику
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов,
	|	МАКСИМУМ(ЕСТЬNULL(Передача.Контрагент, ЕСТЬNULL(Возврат.Контрагент, ЕСТЬNULL(ОтчетПереработчика.Контрагент, НЕОПРЕДЕЛЕНО)))) КАК Контрагент
	|ПОМЕСТИТЬ
	|	ПередачиПереработчику
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Погрешность
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СебестоимостьТоваров КАК Движения
	|		ПО Движения.Организация = Погрешность.Организация
	|			И Движения.АналитикаУчетаНоменклатуры = Погрешность.АналитикаУчетаНоменклатуры
	|			И Движения.РазделУчета = Погрешность.РазделУчета
	|			И Движения.ВидЗапасов = Погрешность.ВидЗапасов
	|		
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПередачаСырьяПереработчику КАК Передача
	|		ПО Передача.Ссылка = Движения.Регистратор
	|		
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратСырьяОтПереработчика КАК Возврат
	|		ПО Возврат.Ссылка = Движения.Регистратор
	|		
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетПереработчика КАК ОтчетПереработчика
	|		ПО ОтчетПереработчика.Ссылка = Движения.Регистратор
	|ГДЕ
	|	Погрешность.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|	И Погрешность.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Погрешность.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|	И Движения.Период МЕЖДУ НАЧАЛОПЕРИОДА(&Дата, МЕСЯЦ) И КОНЕЦПЕРИОДА(&Дата, МЕСЯЦ)
	|	И ЕСТЬNULL(Передача.Контрагент, ЕСТЬNULL(Возврат.Контрагент, ЕСТЬNULL(ОтчетПереработчика.Контрагент, НЕОПРЕДЕЛЕНО))) <> НЕОПРЕДЕЛЕНО
	|СГРУППИРОВАТЬ ПО
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов
	|ИНДЕКСИРОВАТЬ ПО
	|	Погрешность.Организация,
	|	Погрешность.АналитикаУчетаНоменклатуры,
	|	Погрешность.ВидЗапасов";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	ТекстыЗапросовТаблицыСебестоимости = Новый Массив;
	
	#Область ВременнаяТаблицаВтПогрешностьТовары
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Движения.Ссылка КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.Организация КАК Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчета,
	|	ВЫБОР
	|		КОГДА НЕ Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|			И Движения.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = Движения.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(Движения.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА НЕ Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|		ТОГДА ЕСТЬNULL(Движения.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		ИНАЧЕ Движения.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчета,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|			ТОГДА ЕСТЬNULL(Комиссия.Склад, Движения.МестоХранения)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути))
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ КАК МестоУчета,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(Движения.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.МестоХранения.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Движения.ПодразделениеАналитикиУчетаНоменклатуры
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ КАК Подразделение,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Движения.НаправлениеДеятельности
	|	КОНЕЦ КАК НаправлениеДеятельности,
	|	Движения.Номенклатура КАК Субконто1,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЕСТЬNULL(Приобретение.Контрагент, Движения.КонтрагентВидаЗапасов)
	|		КОГДА Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|		ТОГДА ЕСТЬNULL(Комиссия.Контрагент, Движения.КонтрагентВидаЗапасов)
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ КАК Субконто2,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЕСТЬNULL(Приобретение.Договор, Движения.Договор)
	|		ИНАЧЕ Движения.Контрагент
	|	КОНЕЦ КАК Субконто3,
	|	Движения.СтатьяРасходов КАК СтатьяРасходов,
	|	""Погрешность расчета себестоимости (товары)"" КАК Содержание,
	|	СУММА(Движения.Сумма) КАК Сумма,
	|	СУММА(Движения.СуммаУпр) КАК СуммаУпр,
	|	СУММА(Движения.СуммаНУ) КАК СуммаНУ,
	|	СУММА(Движения.СуммаПР) КАК СуммаПР,
	|	СУММА(Движения.СуммаВР) КАК СуммаВР
	|ПОМЕСТИТЬ ВтПогрешностьТовары
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Движения
	|		ЛЕВОЕ СОЕДИНЕНИЕ Комиссия КАК Комиссия
	|		ПО (Комиссия.Организация = Движения.Организация)
	|			И (Комиссия.АналитикаУчетаНоменклатуры = Движения.АналитикаУчетаНоменклатуры)
	|			И (Комиссия.ВидЗапасов = Движения.ВидЗапасов)
	|			И (Комиссия.РазделУчета = Движения.РазделУчета)
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПриобретениеТоваровУслуг КАК Приобретение
	|		ПО Приобретение.Ссылка = Движения.Партия
	|ГДЕ
	|	Движения.РазделУчета В (
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки))
	|	И Движения.ДокументДвижения В (НЕОПРЕДЕЛЕНО, &Ссылка)
	|	И Движения.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Движения.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.Ссылка,
	|	Движения.Период,
	|	Движения.Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|			И Движения.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = Движения.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(Движения.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА НЕ Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|		ТОГДА ЕСТЬNULL(Движения.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		ИНАЧЕ Движения.ГруппаФинансовогоУчета
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|			ТОГДА ЕСТЬNULL(Комиссия.Склад, Движения.МестоХранения)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути))
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(Движения.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.МестоХранения.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Движения.ПодразделениеАналитикиУчетаНоменклатуры
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Движения.НаправлениеДеятельности
	|	КОНЕЦ,
	|	Движения.Номенклатура,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА ЕСТЬNULL(Приобретение.Контрагент, Движения.КонтрагентВидаЗапасов)
	|		КОГДА Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|			ТОГДА ЕСТЬNULL(Комиссия.Контрагент, Движения.КонтрагентВидаЗапасов)
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА ЕСТЬNULL(Приобретение.Договор, Движения.Договор)
	|		ИНАЧЕ Движения.Контрагент
	|	КОНЕЦ,
	|	Движения.СтатьяРасходов";
	ТекстыЗапросовТаблицыСебестоимости.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВременнаяТаблицаВтПогрешностьПереработка
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Движения.Ссылка КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.Организация КАК Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку) КАК ВидСчета,
	|	Движения.ГруппаФинансовогоУчета КАК АналитикаУчета,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчета,
	|	НЕОПРЕДЕЛЕНО КАК Подразделение,
	|	Движения.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ЕСТЬNULL(ПередачиПереработчику.Контрагент, НЕОПРЕДЕЛЕНО) КАК Субконто1,
	|	Движения.Номенклатура КАК Субконто2,
	|	НЕОПРЕДЕЛЕНО КАК Субконто3,
	|	Движения.СтатьяРасходов КАК СтатьяРасходов,
	|	""Погрешность расчета себестоимости (переработка)"" КАК Содержание,
	|	СУММА(Движения.Сумма) КАК Сумма,
	|	СУММА(Движения.СуммаУпр) КАК СуммаУпр,
	|	СУММА(Движения.СуммаНУ) КАК СуммаНУ,
	|	СУММА(Движения.СуммаПР) КАК СуммаПР,
	|	СУММА(Движения.СуммаВР) КАК СуммаВР
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Движения
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПередачиПереработчику КАК ПередачиПереработчику
	|		ПО ПередачиПереработчику.Организация = Движения.Организация
	|			И ПередачиПереработчику.АналитикаУчетаНоменклатуры = Движения.АналитикаУчетаНоменклатуры
	|			И ПередачиПереработчику.ВидЗапасов = Движения.ВидЗапасов
	|ГДЕ
	|	Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|	И Движения.ДокументДвижения В (НЕОПРЕДЕЛЕНО, &Ссылка)
	|	И Движения.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Движения.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.Ссылка,
	|	Движения.Период,
	|	Движения.Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	Движения.Номенклатура,
	|	Движения.СтатьяРасходов,
	|	Движения.ГруппаФинансовогоУчета,
	|	Движения.НаправлениеДеятельности,
	|	ЕСТЬNULL(ПередачиПереработчику.Контрагент, НЕОПРЕДЕЛЕНО)";
	ТекстыЗапросовТаблицыСебестоимости.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВременнаяТаблицаВтПогрешностьНЗП
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Движения.Ссылка КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.Организация КАК Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		ИНАЧЕ
	|			Движения.ГруппаПродукции
	|	КОНЕЦ КАК АналитикаУчета,
	|	ВЫБОР
	|		КОГДА Переработка.МестоУчета ССЫЛКА Справочник.СтруктураПредприятия И (Движения.Партия.Документ ССЫЛКА Документ.ОтчетПереработчика
	|			ИЛИ Движения.Партия ССЫЛКА Документ.ОтчетПереработчика)
	|		ТОГДА Значение(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		КОГДА НЕ Переработка.МестоУчета ЕСТЬ NULL
	|		ТОГДА Переработка.МестоУчета
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|		ТОГДА Движения.ВидЗапасов.Договор.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ КАК МестоУчета,
	|	ВЫБОР
	|		КОГДА Движения.Партия.Документ ССЫЛКА Документ.ОтчетПереработчика
	|			ИЛИ Движения.Партия ССЫЛКА Документ.ОтчетПереработчика
	|		ТОГДА Значение(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		КОГДА НЕ Переработка.Подразделение ЕСТЬ NULL
	|		ТОГДА Переработка.Подразделение
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|		ТОГДА Движения.ВидЗапасов.Договор.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ КАК Подразделение,
	|	Движения.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Движения.СтатьяРасходов КАК Субконто1,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		ИНАЧЕ
	|			Движения.ГруппаПродукции
	|	КОНЕЦ КАК Субконто2,
	|	НЕОПРЕДЕЛЕНО КАК Субконто3,
	|	Движения.СтатьяРасходов КАК СтатьяРасходов,
	|	""Погрешность расчета себестоимости (НЗП)"" КАК Содержание,
	|	СУММА(Движения.Сумма + ВЫБОР КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|															ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|									ТОГДА Движения.СуммаЗабалансом
	|									ИНАЧЕ 0
	|							КОНЕЦ) КАК Сумма,
	|	СУММА(Движения.СуммаУпр) КАК СуммаУпр,
	|	СУММА(Движения.СуммаНУ) КАК СуммаНУ,
	|	СУММА(Движения.СуммаПР) КАК СуммаПР,
	|	СУММА(Движения.СуммаВР) КАК СуммаВР
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Движения
	|		ЛЕВОЕ СОЕДИНЕНИЕ Переработка КАК Переработка
	|		ПО Переработка.Организация = Движения.Организация
	|			И Переработка.АналитикаУчетаНоменклатуры = Движения.АналитикаУчетаНоменклатуры
	|			И Переработка.ВидЗапасов = Движения.ВидЗапасов
	|ГДЕ
	|	Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|							ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|							ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|							ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|	И Движения.ДокументДвижения В (НЕОПРЕДЕЛЕНО, &Ссылка)
	|	И Движения.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Движения.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.Ссылка,
	|	Движения.Период,
	|	Движения.Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА Переработка.МестоУчета ССЫЛКА Справочник.СтруктураПредприятия И (Движения.Партия.Документ ССЫЛКА Документ.ОтчетПереработчика
	|			ИЛИ Движения.Партия ССЫЛКА Документ.ОтчетПереработчика)
	|		ТОГДА Значение(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		КОГДА НЕ Переработка.МестоУчета ЕСТЬ NULL
	|		ТОГДА Переработка.МестоУчета
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|		ТОГДА Движения.ВидЗапасов.Договор.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ,
	|	Движения.НаправлениеДеятельности,
	|	Движения.СтатьяРасходов,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		ИНАЧЕ
	|			Движения.ГруппаПродукции
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.Партия.Документ ССЫЛКА Документ.ОтчетПереработчика
	|			ИЛИ Движения.Партия ССЫЛКА Документ.ОтчетПереработчика
	|		ТОГДА Значение(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		КОГДА НЕ Переработка.Подразделение ЕСТЬ NULL
	|		ТОГДА Переработка.Подразделение
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|		ТОГДА Движения.ВидЗапасов.Договор.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Движения.Регистратор КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.Организация КАК Организация,
	|	"""",
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчета,
	|	Движения.СтатьяРасходов КАК АналитикаУчета,
	|	Движения.Подразделение КАК МестоУчета,
	|	Движения.Подразделение КАК Подразделение,
	|	Движения.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Движения.СтатьяРасходов КАК Субконто1,
	|	Движения.АналитикаРасходов КАК Субконто2,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КАК Субконто3,
	|	Движения.СтатьяРасходов КАК СтатьяРасходов,
	|	""Погрешность расчета себестоимости (НЗП)"" КАК Содержание,
	|	СУММА(Движения.СуммаРегл) КАК Сумма,
	|	СУММА(Движения.СуммаУпр) КАК СуммаУпр,
	|	СУММА(Движения.СуммаРегл - Движения.ПостояннаяРазница - Движения.ВременнаяРазница) КАК СуммаНУ,
	|	СУММА(Движения.ПостояннаяРазница) КАК СуммаПР,
	|	СУММА(Движения.ВременнаяРазница) КАК СуммаВР
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходы КАК Движения
	|ГДЕ
	|	Движения.Регистратор = &Ссылка
	|	И Движения.Активность
	|	И (Движения.СтатьяРасходов.ВариантРаспределенияРасходовУпр В (ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПроизводственныеЗатраты),
	|		ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПроизводственныеЗатраты)))
	|	И Движения.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПустаяСсылка)
	|	И Движения.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.Регистратор,
	|	Движения.Период,
	|	Движения.Организация,
	|	Движения.Подразделение,
	|	Движения.СтатьяРасходов,
	|	Движения.АналитикаРасходов,
	|	Движения.НаправлениеДеятельности
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Движения.Регистратор КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.Организация КАК Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	Движения.ГруппаПродукции КАК АналитикаУчета,
	|	ВЫБОР
	|		КОГДА Движения.ПартияПроизводства.Документ ССЫЛКА Документ.ОтчетПереработчика
	|		ТОГДА Значение(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|		ТОГДА Движения.ВидЗапасов.Договор.Подразделение
	|		ИНАЧЕ Движения.Подразделение
	|	КОНЕЦ КАК МестоУчета,
	|	ВЫБОР
	|		КОГДА Движения.ПартияПроизводства.Документ ССЫЛКА Документ.ОтчетПереработчика
	|		ТОГДА Значение(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|		ТОГДА Движения.ВидЗапасов.Договор.Подразделение
	|		ИНАЧЕ Движения.Подразделение
	|	КОНЕЦ КАК Подразделение,
	|	Движения.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Движения.СтатьяРасходов КАК Субконто1,
	|	Движения.ГруппаПродукции КАК Субконто2,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КАК Субконто3,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости) КАК СтатьяРасходов,
	|	""Погрешность расчета себестоимости (НЗП)"" КАК Содержание,
	|	СУММА(Движения.СтоимостьРегл) КАК Сумма,
	|	СУММА(Движения.СтоимостьУпр) КАК СуммаУпр,
	|	СУММА(Движения.СтоимостьРегл - Движения.ПостояннаяРазница - Движения.ВременнаяРазница) КАК СуммаНУ,
	|	СУММА(Движения.ПостояннаяРазница) КАК СуммаПР,
	|	СУММА(Движения.ВременнаяРазница) КАК СуммаВР
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходыНезавершенногоПроизводства КАК Движения
	|ГДЕ
	|	Движения.Регистратор = &Ссылка
	|	И Движения.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.Регистратор,
	|	Движения.Период,
	|	Движения.Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА Движения.ПартияПроизводства.Документ ССЫЛКА Документ.ОтчетПереработчика
	|		ТОГДА Значение(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|		ТОГДА Движения.ВидЗапасов.Договор.Подразделение
	|		ИНАЧЕ Движения.Подразделение
	|	КОНЕЦ,
	|	Движения.ГруппаПродукции,
	|	Движения.НаправлениеДеятельности,
	|	Движения.СтатьяРасходов";
	ТекстыЗапросовТаблицыСебестоимости.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВременнаяТаблицаВтПогрешностьРезервыПодОбесценивание
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Движения.Ссылка КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.Организация КАК Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПереданные)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|	КОНЕЦ КАК ВидСчета,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ Движения.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчета,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ КАК МестоУчета,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(Движения.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.МестоХранения.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Движения.ПодразделениеАналитикиУчетаНоменклатуры
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК Подразделение,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Движения.НаправлениеДеятельности
	|	КОНЕЦ КАК НаправлениеДеятельности,
	|	Движения.Номенклатура КАК Субконто1,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|			ИЛИ Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|			ТОГДА Движения.КонтрагентВидаЗапасов
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ КАК Субконто2,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА Движения.Договор
	|		ИНАЧЕ Движения.Контрагент
	|	КОНЕЦ КАК Субконто3,
	|	Движения.СтатьяРасходов КАК СтатьяРасходов,
	|	""Погрешность расчета себестоимости (резервы под обесценение)"" КАК Содержание,
	|	СУММА(Движения.РезервПодОбесценениеРегл) КАК Сумма,
	|	СУММА(Движения.РезервПодОбесценениеУпр) КАК СуммаУпр,
	|	СУММА(0) КАК СуммаНУ,
	|	СУММА(0) КАК СуммаПР,
	|	СУММА(Движения.РезервПодОбесценениеРегл) КАК СуммаВР
	|ИЗ
	|	ВТДвиженияСебестоимостиДокумента КАК Движения
	|ГДЕ
	|	Движения.РазделУчета В (
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|	И Движения.ДокументДвижения В (НЕОПРЕДЕЛЕНО, &Ссылка)
	|	И Движения.ХозяйственнаяОперация <> ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
	|	И Движения.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|	И Движения.РезервПодОбесценениеРегл + Движения.РезервПодОбесценениеУпр <> 0
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.Ссылка,
	|	Движения.Период,
	|	Движения.Организация,
	|	Движения.ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПереданные)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ Движения.ГруппаФинансовогоУчета
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(Движения.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Движения.МестоХранения.Подразделение
	|		КОГДА Движения.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Движения.ПодразделениеАналитикиУчетаНоменклатуры
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Движения.НаправлениеДеятельности
	|	КОНЕЦ,
	|	Движения.Номенклатура,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|			ИЛИ Движения.МестоХранения ССЫЛКА Справочник.Партнеры
	|			ТОГДА Движения.КонтрагентВидаЗапасов
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ Движения.МестоХранения
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|			ТОГДА Движения.Договор
	|		ИНАЧЕ Движения.Контрагент
	|	КОНЕЦ,
	|	Движения.СтатьяРасходов";
	ТекстыЗапросовТаблицыСебестоимости.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	МассивТекстовЗапроса.Добавить(СтрСоединить(ТекстыЗапросовТаблицыСебестоимости, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении()));

	#Область ВременнаяТаблицаВтПогрешностьПрочиеРасходы
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДанныеРегистра.Регистратор КАК Ссылка,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.ИдентификаторФинЗаписи,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчета,
	|	ДанныеРегистра.СтатьяРасходов КАК АналитикаУчета,
	|	ДанныеРегистра.Подразделение КАК МестоУчета,
	|	ДанныеРегистра.Подразделение КАК Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ДанныеРегистра.СтатьяРасходов КАК Субконто1,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КАК Субконто2,
	|	ДанныеРегистра.АналитикаРасходов КАК Субконто3,
	|	ДанныеРегистра.СтатьяРасходов КАК СтатьяРасходов,
	|	""Погрешность расчета себестоимости (прочие расходы)"" КАК Содержание,
	|	ДанныеРегистра.СуммаРегл КАК Сумма,
	|	ДанныеРегистра.СуммаУпр КАК СуммаУпр,
	|	ДанныеРегистра.СуммаРегл - ДанныеРегистра.ПостояннаяРазница - ДанныеРегистра.ВременнаяРазница КАК СуммаНУ,
	|	ДанныеРегистра.ПостояннаяРазница КАК СуммаПР,
	|	ДанныеРегистра.ВременнаяРазница КАК СуммаВР
	|ПОМЕСТИТЬ
	|	ВТПогрешностьПрочиеРасходы
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходы КАК ДанныеРегистра
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК Статья
	|	ПО Статья.Ссылка = ДанныеРегистра.СтатьяРасходов
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = ДанныеРегистра.АналитикаРасходов
	|ГДЕ
	|	ДанныеРегистра.Регистратор = &Ссылка
	|	И ДанныеРегистра.Активность
	|	И ДанныеРегистра.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|	И ДанныеРегистра.ИдентификаторФинЗаписи <> """"
	|	И (ДанныеРегистра.СуммаРегл <> 0
	|		ИЛИ ДанныеРегистра.СуммаУпр <> 0
	|		ИЛИ ДанныеРегистра.ПостояннаяРазница <> 0
	|		ИЛИ ДанныеРегистра.ВременнаяРазница <> 0)
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Организация,
	|	СтатьяРасходов,
	|	ИдентификаторФинЗаписи";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВременнаяТаблицаПрочихРасходов
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.Регистратор КАК Ссылка,
	|	ДанныеРегистра.СтатьяРасходов КАК СтатьяРасходов,
	|	ДанныеРегистра.Подразделение КАК Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ДанныеРегистра.АналитикаРасходов КАК АналитикаРасходов,
	|	ДанныеРегистра.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	(ВЫБОР
	|		КОГДА Статья.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|			И ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|		ТОГДА ОбъектыСтроительства.СпособСтроительства
	|		КОГДА Статья.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|			И ОбъектыСтроительства.СпособСтроительства = ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КОНЕЦ) КАК ТипЗатрат
	|ПОМЕСТИТЬ
	|	ВТПрочиеРасходы
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходы КАК ДанныеРегистра
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК Статья
	|	ПО Статья.Ссылка = ДанныеРегистра.СтатьяРасходов
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = ДанныеРегистра.АналитикаРасходов
	|ГДЕ
	|	ДанныеРегистра.Регистратор = &Ссылка
	|	И ДанныеРегистра.Активность
	|	И ДанныеРегистра.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|	И ДанныеРегистра.ИдентификаторФинЗаписи <> """"
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Организация,
	|	СтатьяРасходов,
	|	ИдентификаторФинЗаписи";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВременнаяТаблицаПрочихДоходов
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.Регистратор КАК Ссылка,
	|	ДанныеРегистра.СтатьяДоходов КАК СтатьяДоходов,
	|	ДанныеРегистра.Подразделение КАК Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ДанныеРегистра.АналитикаДоходов КАК АналитикаДоходов,
	|	ДанныеРегистра.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи
	|ПОМЕСТИТЬ
	|	ВТПрочиеДоходы
	|ИЗ
	|	РегистрНакопления.ПрочиеДоходы КАК ДанныеРегистра
	|ГДЕ
	|	ДанныеРегистра.Регистратор = &Ссылка
	|	И ДанныеРегистра.Активность
	|	И ДанныеРегистра.ИдентификаторФинЗаписи <> """"
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Организация,
	|	СтатьяДоходов,
	|	ИдентификаторФинЗаписи";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	ТекстЗапроса = ТекстЗапроса + ОбщегоНазначения.РазделительПакетаЗапросов();
	
	//-- Локализация
	Возврат ТекстЗапроса;
	
КонецФункции

#КонецОбласти
//-- НЕ УТ

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#Область Проведение

// Процедура дополняет тексты запросов проведения документа.
//
// Параметры:
//  Запрос - Запрос - Общий запрос проведения документа.
//  ТекстыЗапроса - СписокЗначений - Список текстов запроса проведения.
//  Регистры - Строка, Структура - Список регистров проведения документа через запятую или в ключах структуры.
//
Процедура ДополнитьТекстыЗапросовПроведения(Запрос, ТекстыЗапроса, Регистры) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти
