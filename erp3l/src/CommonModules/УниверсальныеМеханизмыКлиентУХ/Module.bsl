/////////////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ДЛЯ ПОИСКА СТРОКИ В ДЕРЕВЕ ФОРМЫ

Функция НайтиЭлементКоллекции(КоллекцияЭлементов,ИмяКолонки,ИскомоеЗначение)
	
	Для Каждого ТекЭлемент ИЗ КоллекцияЭлементов.ПолучитьЭлементы() Цикл
		
		Если ТекЭлемент[ИмяКолонки]=ИскомоеЗначение Тогда
			
			Возврат ТекЭлемент;
			Прервать;
			
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат Неопределено;	
	
КонецФункции // НайтиЭлементСправочника()

Функция ДеревоФормыНайти(КоллекцияЭлементов,ИмяКолонки,ИскомоеЗначение) Экспорт
	
	НайденныйЭлемент=НайтиЭлементКоллекции(КоллекцияЭлементов, ИмяКолонки, ИскомоеЗначение);
	
	Если НайденныйЭлемент=Неопределено Тогда
		
		Для Каждого ТекЭлемент ИЗ КоллекцияЭлементов.ПолучитьЭлементы() Цикл
			
			ПоискПоСубСтрокам = ДеревоФормыНайти(ТекЭлемент, ИмяКолонки, ИскомоеЗначение);
			
			Если ПоискПоСубСтрокам <> Неопределено Тогда
				
				Возврат ПоискПоСубСтрокам;
				
			КонецЕсли;
			
		КонецЦикла;
		
		Возврат Неопределено;
		
	Иначе
		
		Возврат НайденныйЭлемент;
		
	КонецЕсли;
	
	Возврат Неопределено;
	
КонецФункции // ДеревоФормыНайти()

/////////////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ДЛЯ ПОИСКА МАССИВА СТРОК В ДЕРЕВЕ ФОРМЫ

Процедура НайтиСтрокиКоллекции(КоллекцияЭлементов,СтруктураПоиска,МассивНайденных)
	
	Для Каждого ТекЭлемент ИЗ КоллекцияЭлементов.ПолучитьЭлементы() Цикл
		
		ЕстьСовпадение=Истина;
		
		Для Каждого КлючИЗначение ИЗ СтруктураПоиска Цикл
			
			Если НЕ ТекЭлемент[КлючИЗначение.Ключ]=КлючИЗначение.Значение Тогда
				
				ЕстьСовпадение=Ложь;
				Прервать;
				
			КонецЕсли;
			
		КонецЦикла;
		
		Если ЕстьСовпадение Тогда
			
			МассивНайденных.Добавить(ТекЭлемент);
			
		КонецЕсли;
		
		НайтиСтрокиКоллекции(ТекЭлемент,СтруктураПоиска,МассивНайденных)
		
	КонецЦикла;
			
КонецПроцедуры // НайтиСтрокиКоллекции() 

Функция ДеревоФормыНайтиСтроки(КоллекцияЭлементов,СтруктураПоиска) Экспорт
	
	МассивНайденных=Новый Массив;
	
	НайтиСтрокиКоллекции(КоллекцияЭлементов,СтруктураПоиска,МассивНайденных);
	
	Возврат МассивНайденных;
	
КонецФункции


