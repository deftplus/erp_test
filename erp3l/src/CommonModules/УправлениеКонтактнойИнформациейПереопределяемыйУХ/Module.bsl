
////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРА ПОЛУЧЕНИЯ ТАБЛИЦЫ ЭЛЕКТРОННЫХ АДРЕСОВ ПО ОБЪЕКТАМ.
//
&НаСервере
Функция ПолучитьТаблицуЭлектронныхАдресов(Знач Объекты) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ПользователиКонтактнаяИнформация.АдресЭП КАК Адрес,
	|	ПользователиКонтактнаяИнформация.Ссылка КАК Объект
	|ИЗ
	|	Справочник.Пользователи.КонтактнаяИнформация КАК ПользователиКонтактнаяИнформация
	|ГДЕ
	|	ПользователиКонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.АдресЭлектроннойПочты)
	|	И ПользователиКонтактнаяИнформация.Ссылка В(&СписокОбъектов)";
	
	Если ТипЗнч(Объекты) = Тип("СписокЗначений") Тогда
		СписокЗначений = Объекты;
	Иначе
		СписокЗначений = Новый СписокЗначений;
		СписокЗначений.Добавить(Объекты);
	КонецЕсли;
	
	Запрос.УстановитьПараметр("СписокОбъектов", СписокЗначений);
	Возврат Запрос.Выполнить().Выгрузить();
	
КонецФункции
