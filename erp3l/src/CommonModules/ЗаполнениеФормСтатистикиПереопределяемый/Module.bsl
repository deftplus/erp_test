
#Область СлужебныйПрограммныйИнтерфейс

// Получает набор внешних данных по имени объекта.
// Параметры:
//	ИмяОбъекта - Строка - Идентификатор данных которые требуется получить.
// Возвращаемое значение
//	ТаблицаЗначений, Неопределено - Набор данных в виде таблицы, если для запрашиваемого объекта нет данных возвращает неопределено.
//
Функция ВнешниеДанные(ИмяОбъекта) Экспорт
	
	Если ИмяОбъекта = "БуквенныеКодыРазделовОКВЭД2" Тогда
		// В схеме компоновки данных Перечисления.ИсточникиДанныхСтатистическихПоказателей.Макеты.ОсновнойВидДеятельности.
		Возврат ОрганизацииЛокализация.БуквенныеКодыРазделовОКВЭД2();
	Иначе
		Возврат Неопределено;
	КонецЕсли;
	
КонецФункции

// Возвращает список форм статистики для которых может быть выполнена настройка заполнения
// и которые встречаются в настройках списка налогов и отчетов переданной организации.
// Параметры:
//	Организация - СправочникСсылка.Организации - Организация для которой нужно найти формы.
// Возвращаемое значение:
// ТаблицаЗначений:
//	* Форма- СправочникСсылка.ФормыСтатистики - Форма статистики.
//	* Организация - СправочникСсылка.Организации - Организация.
//
Функция НастраиваемыеФормыСтатистикиПредоставляемыеОрганизацией(Организация) Экспорт

	Результат = Новый ТаблицаЗначений; // Ссылки на формы.
	Результат.Колонки.Добавить("Форма", 		Новый ОписаниеТипов("СправочникСсылка.ФормыСтатистики"));
	Результат.Колонки.Добавить("Организация", 	Новый ОписаниеТипов("СправочникСсылка.Организации"));
	
	Возврат Результат;
	
КонецФункции

// Заполняет показатели выручки предпринимателя.
// Параметры:
//	Показатели - ТаблицаЗначений - Коллекция показателей формы статистики с необходимыми настройками, подробнее см. НовыйОписаниеПоказателей().
//	Формулы - ТаблицаЗначений - Коллекция показателей формы статистики для которых указан дополнительный алгоритм, подробнее см. НовыйОписаниеПоказателей().
//
Процедура ВыручкаПредпринимателя(Показатели, Формулы) Экспорт

КонецПроцедуры

// Заполняет показатели численности персонала.
// Параметры:
//	Показатели - ТаблицаЗначений - Коллекция показателей формы статистики с необходимыми настройками, подробнее см. НовыйОписаниеПоказателей().
//	Формулы - ТаблицаЗначений - Коллекция показателей формы статистики для которых указан дополнительный алгоритм, подробнее см. НовыйОписаниеПоказателей().
//
Процедура ЧисленностьПерсонала(Показатели, Формула) Экспорт

	Если Формула.ДополнительныйАлгоритм 
		<> Перечисления.ДополнительныеАлгоритмыЗаполненияФормСтатистики.ЧисленностьПерсонала Тогда
		Возврат;
	КонецЕсли;
	
	СведенияОЧисленности = КадровыйУчет.СреднесписочнаяЧисленностьРаботающих(
		Формула.Организация, Формула.НачалоПериода, Формула.КонецПериода);
	
	Отбор = Новый Структура();
	Отбор.Вставить("ДополнительныйАлгоритм", 
		Перечисления.ДополнительныеАлгоритмыЗаполненияФормСтатистики.ЧисленностьПерсонала);
	Отбор.Вставить("ИмяПоля", Формула.ИмяПоля);
	Отбор.Вставить("Характеристика", "СреднесписочнаяЧисленность");
		
	ПоказателиЧисленности = Показатели.НайтиСтроки(Отбор);
	
	Для Каждого Показатель Из ПоказателиЧисленности Цикл
		
		Показатель.Значение = СведенияОЧисленности.СреднесписочнаяЧисленностьРаботников;
		
	КонецЦикла;

КонецПроцедуры

// Выполняет поиск единицы измерения в классификаторе единиц измерения.
//
// Параметры:
//	КодПоОКЕИ - Строка - код единицы измерения по ОКЕИ.
//	Наименование - Строка - Наименование единицы измерения.
//
// Возвращаемое значение:
// СправочникСсылка.КлассификаторЕдиницИзмерения, Неопределено - если поиск и попытка добавления элемента не дали результатов то неопределено.
//
Функция ЕдиницаИзмеренияПоКоду(КодЕдиницыИзмерения, НаименованиеЕдиницыИзмерения) Экспорт

	Результат = Справочники.УпаковкиЕдиницыИзмерения.НайтиПоКоду(КодЕдиницыИзмерения);

	Если НЕ ЗначениеЗаполнено(Результат) Тогда
		// Еще нет такой единицы измерения, создадим.
		СозданныеЕдиницыИзмерения = Справочники.УпаковкиЕдиницыИзмерения.ЗаполнитьЕдиницыИзмеренияИзКлассификатора(КодЕдиницыИзмерения, Истина);
		Результат = СозданныеЕдиницыИзмерения[КодЕдиницыИзмерения];
	КонецЕсли;

	Возврат Результат;

КонецФункции

#КонецОбласти