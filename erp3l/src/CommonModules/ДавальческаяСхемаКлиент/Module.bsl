//////////////////////////////////////////////////////////////////////
// Модуль "ДавальческаяСхемаКлиент" содержит процедуры и функции для 
// работы с механизмом производством из давальческого сырья.
//
//////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

#Область Заполнение

// Заполняет служебный реквизит "ДоступноОформлениеОтчетаДавальцу" в строке по данным указанного назначение
//
// Параметры:
//  ТекущаяСтрока		 - Структура - данные обрабатываемой строки.
//  СтруктураДействий	 - Структура - описывает действия, где Ключ - наименование действия,
//  														   Значение - Структура - параметры действия.
//  КэшированныеЗначения - Структура - сохраненные значения параметров, используемых при обработке.
//
Процедура ЗаполнитьПризнакДоступноОформлениеОтчетаДавальцу(ТекущаяСтрока, СтруктураДействий, КэшированныеЗначения) Экспорт
	
	Если ЗначениеЗаполнено(ТекущаяСтрока.Назначение) Тогда
		
		СвойстваНазначение = КэшированныеЗначения.СвойстваНазначений.Получить(ТекущаяСтрока.Назначение);
		
		Если СвойстваНазначение = Неопределено Тогда 
		
			ТекстИсключения = 
				НСтр("ru = 'Попытка заполнение служебного реквизита по данным указанного назначение на клиенте.';
					|en = 'Try to fill in service attribute according to data of specified assignment on the client.'");
					
			ВызватьИсключение ТекстИсключения;
				
		Иначе
			ДоступноОформлениеОтчетаДавальцу = СвойстваНазначение.ЭтоНазначениеДавальца
											   И (ЗначениеЗаполнено(СвойстваНазначение.Договор) Или СвойстваНазначение.ЭтоДавальческаяПродукция);
		КонецЕсли;
		
	Иначе
		ДоступноОформлениеОтчетаДавальцу = Ложь;
	КонецЕсли;
	
	ТекущаяСтрока.ДоступноОформлениеОтчетаДавальцу = ДоступноОформлениеОтчетаДавальцу;
	
	Если Не ТекущаяСтрока.ДоступноОформлениеОтчетаДавальцу И ТекущаяСтрока.ОформитьОтчетДавальцу Тогда
		ТекущаяСтрока.ОформитьОтчетДавальцу = Ложь;
	Иначе
		ТекущаяСтрока.ОформитьОтчетДавальцу = ЗначениеЗаполнено(ТекущаяСтрока.Назначение)
											  И СвойстваНазначение.ЭтоДавальческаяПродукция;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти