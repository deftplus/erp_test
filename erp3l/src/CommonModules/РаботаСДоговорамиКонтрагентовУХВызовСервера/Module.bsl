#Область ПрограммныйИнтерфейс

Функция ДействующийГрафик(Договор, Дата = Неопределено, Организация = Неопределено) Экспорт
	
	Возврат РаботаСДоговорамиКонтрагентовУХ.ДействующийГрафик(Договор, Дата, Организация);
	
КонецФункции

Процедура ЗаписатьВстречныеДоговоры(ПервыйДоговор, ВторойДоговор, Отказ = Ложь) Экспорт
	
	ВидСвязи = Справочники.ВидыСвязейОбъектов.ВнутригрупповойДоговор;
	
	РаботаСДоговорамиКонтрагентовУХ.ЗаписатьСвязанныеДоговоры(ПервыйДоговор, ВторойДоговор, ВидСвязи, Отказ);
	РаботаСДоговорамиКонтрагентовУХ.ЗаписатьСвязанныеДоговоры(ВторойДоговор, ПервыйДоговор, ВидСвязи, Отказ);

КонецПроцедуры

Процедура ОчиститьСвязиВнутригрупповогоДоговора(Договор) Экспорт
	
	НачатьТранзакцию();
	Попытка
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	СвязанныеДоговоры.БазовыйДоговор КАК БазовыйДоговор,
		|	СвязанныеДоговоры.СвязанныйДоговор КАК СвязанныйДоговор,
		|	СвязанныеДоговоры.ВидСвязи КАК ВидСвязи
		|ИЗ
		|	РегистрСведений.СвязанныеДоговоры КАК СвязанныеДоговоры
		|ГДЕ
		|	СвязанныеДоговоры.БазовыйДоговор = &Договор
		|	И СвязанныеДоговоры.ВидСвязи = ЗНАЧЕНИЕ(Справочник.ВидыСвязейОбъектов.ВнутригрупповойДоговор)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	СвязанныеДоговоры.БазовыйДоговор,
		|	СвязанныеДоговоры.СвязанныйДоговор,
		|	СвязанныеДоговоры.ВидСвязи
		|ИЗ
		|	РегистрСведений.СвязанныеДоговоры КАК СвязанныеДоговоры
		|ГДЕ
		|	СвязанныеДоговоры.СвязанныйДоговор = &Договор
		|	И СвязанныеДоговоры.ВидСвязи = ЗНАЧЕНИЕ(Справочник.ВидыСвязейОбъектов.ВнутригрупповойДоговор)";
		
		Запрос.УстановитьПараметр("Договор", Договор);
		Выборка = Запрос.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			
			МЗ = РегистрыСведений.СвязанныеДоговоры.СоздатьМенеджерЗаписи();
			ЗаполнитьЗначенияСвойств(МЗ, Выборка);
			МЗ.Удалить();
		КонецЦикла;

	Исключение
		ОтменитьТранзакцию();
		ВызватьИсключение;
	КонецПопытки;
	ЗафиксироватьТранзакцию();
КонецПроцедуры

#КонецОбласти