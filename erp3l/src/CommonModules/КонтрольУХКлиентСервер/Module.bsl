
#Область СлужебныйПрограммныйИнтерфейс

// Имя реквизита формы, в котором хранятся результаты интерактивного контроля
//Функция ИмяРеквизитаТаблицаКонтроляДокумента() Экспорт
Функция ИменаРеквизитовЭлементовКонтроля() Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("ИмяРеквизита", "КонтрольДокумента");
	Результат.Вставить("ИмяСтраницы", "СтраницаКонтроляДокумента");
	Результат.Вставить("ЕстьНарушения", "ЕстьПревышениеЛимитов");
	Результат.Вставить("ИмяКоманды", "ВыполнитьКонтрольДокумента");
	
	Возврат Результат;
КонецФункции

Функция КартинкаСтраницыКонтроль(ЕстьПревышениеЛимитов, ЕстьПредупреждения = Ложь, ЕстьИнформация = Ложь) Экспорт
	
	Если ЕстьПревышениеЛимитов Тогда
		Возврат БиблиотекаКартинок.СообщениеОПроблемах;
	ИначеЕсли ЕстьПредупреждения Тогда
		Возврат БиблиотекаКартинок.Предупреждение;
	ИначеЕсли ЕстьИнформация Тогда
		Возврат БиблиотекаКартинок.Информация;
	Иначе
		Возврат Новый Картинка;
	КонецЕсли;
	
КонецФункции

Процедура ОтразитьРезультатыКонтроляНаФорме(Форма, РеквизитыЭлементы, ПараметрыКонтроля) Экспорт
	
	Объект = Форма.Объект;
	Элементы = Форма.Элементы;

	РезультатКонтроляВОбъекте = ПараметрыКонтроля.РеквизитыКонтроляВДокументе.Найти(ТипЗнч(Объект.Ссылка)) <> неопределено;
	Если РезультатКонтроляВОбъекте Тогда
		// Обновляем реквизиты документа
		Если ПараметрыКонтроля.Свойство("РеквизитыДокумента") Тогда
			ЗаполнитьЗначенияСвойств(Объект, ПараметрыКонтроля.РеквизитыДокумента);
		КонецЕсли;
		ЕстьНарушения = Объект[РеквизитыЭлементы.ЕстьНарушения];
	Иначе
		// Обновляем реквизиты формы
		Форма.ЕстьНарушения = ПараметрыКонтроля.РеквизитыДокумента.ЕстьПревышениеЛимитов;
		ЕстьНарушения = Форма.ЕстьНарушения;
	КонецЕсли;
	
	// Оформление страницы контроля
	Элементы[РеквизитыЭлементы.ИмяСтраницы].Картинка = КартинкаСтраницыКонтроль(
		ЕстьНарушения, Форма.ЕстьПредупреждения,	Форма.ЕстьИнформация);
	
КонецПроцедуры

#КонецОбласти

 