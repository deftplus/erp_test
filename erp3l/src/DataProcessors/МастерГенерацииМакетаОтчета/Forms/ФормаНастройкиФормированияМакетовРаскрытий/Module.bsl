&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Параметры.Свойство("РаскрытиеСтрок", РаскрытиеСтрок);
	ТаблицаГруппРаскрытия = ПолучитьИзВременногоХранилища(Параметры.АдресГруппыРаскрытия);
	
	Если НЕ РаскрытиеСтрок Тогда
		Элементы.ГруппыРаскрытияСтрокаОтчета.Видимость = Ложь;
		ТаблицаГруппРаскрытия.Колонки.Добавить("СтрокаОтчета", Новый ОписаниеТипов("СправочникСсылка.СтрокиОтчетов"));
	КонецЕсли;
	
	ЗначениеВРеквизитФормы(ТаблицаГруппРаскрытия, "ГруппыРаскрытия");
	
КонецПроцедуры

&НаКлиенте
Процедура ЗаписатьИЗакрыть(Команда)
	
	Закрыть(ПодготовитьТаблицуКПередаче());
	
КонецПроцедуры

&НаСервере
Функция ПодготовитьТаблицуКПередаче()
	
	ТаблицаГруппРаскрытия = РеквизитФормыВЗначение("ГруппыРаскрытия");
	
	Если НЕ РаскрытиеСтрок Тогда
		ТаблицаГруппРаскрытия.Колонки.Удалить("СтрокаОтчета");
	КонецЕсли;
	
	Возврат ПоместитьВоВременноеХранилище(ТаблицаГруппРаскрытия);
	
КонецФункции

&НаКлиенте
Процедура УстановитьФлажки(Команда)
	
	Если Элементы.ГруппыРаскрытия.ТекущийЭлемент.Вид = ВидПоляФормы.ПолеФлажка Тогда
		
		ИмяКолонки = СтрЗаменить(Элементы.ГруппыРаскрытия.ТекущийЭлемент.Имя, "ГруппыРаскрытия", "");
		Для Каждого Элемент Из ГруппыРаскрытия Цикл
			
			Элемент[ИмяКолонки] = Истина;
			
		КонецЦикла;
		
	КонецЕсли;

КонецПроцедуры

&НаКлиенте
Процедура СнятьФлажки(Команда)
	
	Если Элементы.ГруппыРаскрытия.ТекущийЭлемент.Вид = ВидПоляФормы.ПолеФлажка Тогда
		
		ИмяКолонки = СтрЗаменить(Элементы.ГруппыРаскрытия.ТекущийЭлемент.Имя, "ГруппыРаскрытия", "");
		Для Каждого Элемент Из ГруппыРаскрытия Цикл
			
			Элемент[ИмяКолонки] = Ложь;
			
		КонецЦикла;
		
	КонецЕсли;

КонецПроцедуры
