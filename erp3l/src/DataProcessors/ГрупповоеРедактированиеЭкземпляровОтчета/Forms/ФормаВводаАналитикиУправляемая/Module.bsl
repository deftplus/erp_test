

&НаКлиенте
Процедура КомандаОК(Команда)
	
	СтруктураАналитика=Новый Структура;
	
	Для Инд=1 По ЧислоДопАналитик Цикл
		
		Если ЗначениеЗаполнено(ЭтаФорма["Аналитика" + Инд]) Тогда
			
			СтруктураАналитика.Вставить("Аналитика"+Инд,ЭтаФорма["Аналитика" + Инд]);
		КонецЕсли;
		
	КонецЦикла;

	Если СтруктураАналитика.Количество()>0 Тогда
		
		СтруктураАналитика.Вставить("Значение",Значение);
		Закрыть(СтруктураАналитика);
		
	Иначе
		
		Закрыть(Неопределено);
		
	КонецЕсли;   
	 
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаЗакрыть(Команда)
	
	Закрыть(Неопределено);
	
КонецПроцедуры
 
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Параметры.Свойство("СтрАналитики",СтрАналитики);
	Параметры.Свойство("СтруктураАналитикаТек",СтруктураАналитикаТек);
	
	ЧислоДопАналитик=ПараметрыСеанса.ЧислоДопАналитик;
		
	Для Инд=1 ПО ЧислоДопАналитик Цикл
				
		ТекВидАналитики=СтрАналитики["ВидАналитики"+Инд];
				
		Если НЕ ЗначениеЗаполнено(ТекВидАналитики.ВидАналитики) Тогда
			Элементы["ГруппаАналитика" + Инд].Видимость = Ложь;
		Иначе
			Элементы["НадписьАналитика" + Инд].Заголовок = ТекВидАналитики.Наименование;
			Элементы["ГруппаАналитика" + Инд].Видимость=Истина;
			Элементы["Аналитика" + Инд].ОграничениеТипа = ТекВидАналитики.ТипЗначения;
			
			ЭтаФорма["Аналитика" + Инд] = ТекВидАналитики.ТипЗначения.ПривестиЗначение(Неопределено);
			
		КонецЕсли;
		
		Если ТекВидАналитики.Свойство("Владелец") Тогда
			
			МассивОтбора=Новый Массив;
			
			СвязьВладелец = Новый СвязьПараметраВыбора("Отбор.Владелец", ТекВидАналитики.Владелец);
			МассивОтбора.Добавить(СвязьВладелец);
			
			НовыеСвязи = Новый ФиксированныйМассив(МассивОтбора);
			
			Элементы["Аналитика" + Инд].СвязиПараметровВыбора=НовыеСвязи;
			
		КонецЕсли;
				
	КонецЦикла;
	
	Если ТипЗнч(СтруктураАналитикаТек)=Тип("Структура") Тогда
		
		Для Каждого Аналитика ИЗ СтруктураАналитикаТек Цикл
			
			Если ЗначениеЗаполнено(Аналитика.Значение) Тогда
				
				ЭтаФорма[Аналитика.Ключ]=Аналитика.Значение;
				
			КонецЕсли;
			
		КонецЦикла;
		
		Элементы.Значение.Видимость=Ложь;
		
	Иначе
		
		Элементы.Значение.Видимость=Истина;
		
	КонецЕсли;
	
	Элементы.Значение.ОграничениеТипа=Параметры.ТипЗначения;
	
КонецПроцедуры

&НаКлиенте
Процедура Аналитика1НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Если Не ЗначениеЗаполнено(СтрАналитики.ВидАналитики1.ВидАналитики) Тогда
		СтандартнаяОбработка=Ложь;
		Возврат;
	ИначеЕсли СтрАналитики.ВидАналитики1.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ПроизвольныйКлассификаторУХ")) Тогда
		СтандартнаяОбработка = Ложь;
    	Владелец = СтрАналитики.ВидАналитики1.ВидАналитики;
    	СтруктураПараметров = Новый Структура;
    	СтруктураПараметров.Вставить("Отбор", Новый Структура("Владелец", Владелец));
    	    	
    	Если ЗначениеЗаполнено(ЭтаФорма.Аналитика1) Тогда
    		СтруктураПараметров.Вставить("НачальноеЗначениеВыбора", ЭтаФорма.Аналитика1);
    	КонецЕсли;
    	
    	ОткрытьФорму("Справочник.ПроизвольныйКлассификаторУХ.Форма.ФормаВыбораУправляемая", СтруктураПараметров, Элемент);
		
	КонецЕсли;	
	
КонецПроцедуры

&НаКлиенте
Процедура Аналитика2НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Если Не ЗначениеЗаполнено(СтрАналитики.ВидАналитики2.ВидАналитики) Тогда
		СтандартнаяОбработка=Ложь;
		Возврат;
	ИначеЕсли СтрАналитики.ВидАналитики2.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ПроизвольныйКлассификаторУХ")) Тогда
		СтандартнаяОбработка = Ложь;
    	Владелец = СтрАналитики.ВидАналитики2.ВидАналитики;
    	СтруктураПараметров = Новый Структура;
    	СтруктураПараметров.Вставить("Отбор", Новый Структура("Владелец", Владелец));
    	    	
    	Если ЗначениеЗаполнено(ЭтаФорма.Аналитика2) Тогда
    		СтруктураПараметров.Вставить("НачальноеЗначениеВыбора", ЭтаФорма.Аналитика2);
    	КонецЕсли;
    	
    	ОткрытьФорму("Справочник.ПроизвольныйКлассификаторУХ.Форма.ФормаВыбораУправляемая", СтруктураПараметров, Элемент);
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура Аналитика3НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Если Не ЗначениеЗаполнено(СтрАналитики.ВидАналитики3.ВидАналитики) Тогда
		СтандартнаяОбработка=Ложь;
		Возврат;
	ИначеЕсли СтрАналитики.ВидАналитики3.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ПроизвольныйКлассификаторУХ")) Тогда
		СтандартнаяОбработка = Ложь;
    	Владелец = СтрАналитики.ВидАналитики3.ВидАналитики;
    	СтруктураПараметров = Новый Структура;
    	СтруктураПараметров.Вставить("Отбор", Новый Структура("Владелец", Владелец));
    	    	
    	Если ЗначениеЗаполнено(ЭтаФорма.Аналитика3) Тогда
    		СтруктураПараметров.Вставить("НачальноеЗначениеВыбора", ЭтаФорма.Аналитика3);
    	КонецЕсли;
    	
    	ОткрытьФорму("Справочник.ПроизвольныйКлассификаторУХ.Форма.ФормаВыбораУправляемая", СтруктураПараметров, Элемент);
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура Аналитика4НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Если Не ЗначениеЗаполнено(СтрАналитики.ВидАналитики4.ВидАналитики) Тогда
		СтандартнаяОбработка=Ложь;
		Возврат;
	ИначеЕсли СтрАналитики.ВидАналитики4.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ПроизвольныйКлассификаторУХ")) Тогда
		СтандартнаяОбработка = Ложь;
    	Владелец = СтрАналитики.ВидАналитики4.ВидАналитики;
    	СтруктураПараметров = Новый Структура;
    	СтруктураПараметров.Вставить("Отбор", Новый Структура("Владелец", Владелец));
    	    	
    	Если ЗначениеЗаполнено(ЭтаФорма.Аналитика4) Тогда
    		СтруктураПараметров.Вставить("НачальноеЗначениеВыбора", ЭтаФорма.Аналитика4);
    	КонецЕсли;
    	
    	ОткрытьФорму("Справочник.ПроизвольныйКлассификаторУХ.Форма.ФормаВыбораУправляемая", СтруктураПараметров, Элемент);
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура Аналитика5НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Если Не ЗначениеЗаполнено(СтрАналитики.ВидАналитики5.ВидАналитики) Тогда
		СтандартнаяОбработка=Ложь;
		Возврат;
	ИначеЕсли СтрАналитики.ВидАналитики5.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ПроизвольныйКлассификаторУХ")) Тогда
		СтандартнаяОбработка = Ложь;
    	Владелец = СтрАналитики.ВидАналитики5.ВидАналитики;
    	СтруктураПараметров = Новый Структура;
    	СтруктураПараметров.Вставить("Отбор", Новый Структура("Владелец", Владелец));
    	    	
    	Если ЗначениеЗаполнено(ЭтаФорма.Аналитика5) Тогда
    		СтруктураПараметров.Вставить("НачальноеЗначениеВыбора", ЭтаФорма.Аналитика5);
    	КонецЕсли;
    	
    	ОткрытьФорму("Справочник.ПроизвольныйКлассификаторУХ.Форма.ФормаВыбораУправляемая", СтруктураПараметров, Элемент);
		
	КонецЕсли;

	
	
	
КонецПроцедуры

&НаКлиенте
Процедура Аналитика6НачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Если Не ЗначениеЗаполнено(СтрАналитики.ВидАналитики6.ВидАналитики) Тогда
		СтандартнаяОбработка=Ложь;
		Возврат;
	ИначеЕсли СтрАналитики.ВидАналитики6.ТипЗначения.СодержитТип(Тип("СправочникСсылка.ПроизвольныйКлассификаторУХ")) Тогда
		СтандартнаяОбработка = Ложь;
    	Владелец = СтрАналитики.ВидАналитики6.ВидАналитики;
    	СтруктураПараметров = Новый Структура;
    	СтруктураПараметров.Вставить("Отбор", Новый Структура("Владелец", Владелец));
    	    	
    	Если ЗначениеЗаполнено(ЭтаФорма.Аналитика6) Тогда
    		СтруктураПараметров.Вставить("НачальноеЗначениеВыбора", ЭтаФорма.Аналитика6);
    	КонецЕсли;
    	
    	ОткрытьФорму("Справочник.ПроизвольныйКлассификаторУХ.Форма.ФормаВыбораУправляемая", СтруктураПараметров, Элемент);
		
	КонецЕсли;
	
КонецПроцедуры
