
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	СоздаватьПоказатели = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
	
	ПараметрыЗакрытия = Новый Структура;
	ПараметрыЗакрытия.Вставить("НовыеСтроки",НовыеСтроки);
	ПараметрыЗакрытия.Вставить("СоздаватьПоказатели",СоздаватьПоказатели);
	
	Закрыть(ПараметрыЗакрытия);
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	
КонецПроцедуры

&НаКлиенте
Процедура ВставитьИзБуфера(Команда)
	
	ОбъектКопирования = Новый COMОбъект("htmlfile");
	ДанныеБуфера =ОбъектКопирования.ParentWindow.ClipboardData.GETdata("Text");
	МассивСтрок = Новый Массив;
    МассивЗначений = Новый Массив;		
	Если КодСимвола(Прав(ДанныеБуфера,1)) = 10 И КодСимвола(Прав(ДанныеБуфера,2)) = 13 Тогда	
		 ДанныеБуфера = Лев(ДанныеБуфера,СтрДлина(ДанныеБуфера)-2);	
	КонецЕсли;	
	
	РазобратьДанныеБУфера(ДанныеБуфера,МассивСтрок,МассивЗначений);
	
	Для Каждого Стр Из МассивЗначений Цикл	
		Если ТипЗнч(Стр) = Тип("Массив") Тогда
			Для Каждого Кол Из Стр Цикл			
				Нстр = НовыеСтроки.Добавить();
				Нстр.Наименование = Кол;	
			КонецЦикла;	
		КонецЕсли;
	КонецЦикла;	
	
КонецПроцедуры

&НаСервере
Процедура РазобратьДанныеБуфера(ДанныеБуфера,МассивСтрок,МассивЗначений)
		     	
	МассивСтрок = СтроковыеФункцииКлиентСерверУХ.РазложитьСтрокуВМассивПодстрок(ДанныеБуфера,Символ(13));	
	Для Каждого Стр Из МассивСтрок Цикл
		Если Лев(Стр,1) = Символ(10) Тогда
			МассивЗначенийСтроки =  СтроковыеФункцииКлиентСерверУХ.РазложитьСтрокуВМассивПодстрок(Прав(Стр,СтрДлина(Стр)-1),"	");
		Иначе
			МассивЗначенийСтроки =  СтроковыеФункцииКлиентСерверУХ.РазложитьСтрокуВМассивПодстрок(Стр,"	");
		КонецЕсли;
		МассивЗначений.Добавить(МассивЗначенийСтроки);
	КонецЦикла;
		 		
КонецПроцедуры	
