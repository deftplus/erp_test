
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	// 
	ОбщегоНазначенияКлиентСервер.УстановитьПараметрДинамическогоСписка(СписокПотребности, "ПустойУИД",					Параметры.Отбор.ПустойУИД);
	ОбщегоНазначенияКлиентСервер.УстановитьПараметрДинамическогоСписка(СписокПотребности, "Автор",						Параметры.Отбор.ТекущийПользователь);
	ОбщегоНазначенияКлиентСервер.УстановитьПараметрДинамическогоСписка(СписокПотребности, "Субъекты223ФЗ",				Параметры.Объект.Субъекты223ФЗ);
	ОбщегоНазначенияКлиентСервер.УстановитьПараметрДинамическогоСписка(СписокПотребности, "ПериодЗакупки",				Параметры.Объект.ПериодЗакупки);
	ОбщегоНазначенияКлиентСервер.УстановитьПараметрДинамическогоСписка(СписокПотребности, "СписокПериодовПотребности",	
		Параметры.Объект.ПериодыПотребности.Выгрузить().ВыгрузитьКолонку("Период"));
		
	//
	Номенклатура = Параметры.Отбор.Номенклатура;
	Если Параметры.Отбор.Свойство("Характеристика") Тогда
		Характеристика = Параметры.Отбор.Характеристика;
	Иначе
		Характеристика = Справочники.ХарактеристикиНоменклатуры.ПустаяСсылка();
	КонецЕсли;
	
	Организация = Параметры.Отбор.Организация;
	МестоПоставки = Параметры.Отбор.МестоПоставки;
	Проект = Параметры.Отбор.Проект;
	Менеджер = Параметры.Отбор.Менеджер;
	Приоритет = Параметры.Отбор.Приоритет;
	Назначение = Параметры.Отбор.Назначение;

	//
	ОтборСпискаПотребностей = СписокПотребности.КомпоновщикНастроек.ФиксированныеНастройки.Отбор;
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ОтборСпискаПотребностей, "Номенклатура", Номенклатура, ВидСравненияКомпоновкиДанных.Равно, , Истина);
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ОтборСпискаПотребностей, "Характеристика", Характеристика, ВидСравненияКомпоновкиДанных.Равно, , Истина);
	
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ОтборСпискаПотребностей, "МестоПоставки", МестоПоставки, ВидСравненияКомпоновкиДанных.Равно, , Истина);
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ОтборСпискаПотребностей, "Организация", Организация, ВидСравненияКомпоновкиДанных.Равно, , Истина);
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ОтборСпискаПотребностей, "Назначение", Назначение, ВидСравненияКомпоновкиДанных.Равно, , Истина);
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ОтборСпискаПотребностей, "Менеджер", Менеджер, ВидСравненияКомпоновкиДанных.Равно, , Истина);
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ОтборСпискаПотребностей, "Приоритет", Приоритет, ВидСравненияКомпоновкиДанных.Равно, , Истина);
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ОтборСпискаПотребностей, "Проект", Проект, ВидСравненияКомпоновкиДанных.Равно, , Истина);
	
	СписокПотребности.КомпоновщикНастроек.Настройки.ДополнительныеСвойства.Вставить("Итоги", Итоги);
	
КонецПроцедуры


&НаСервереБезКонтекста
Процедура СписокПотребностиПриПолученииДанныхНаСервере(ИмяЭлемента, Настройки, Строки)
	Итоги = Новый Структура("КоличествоКОбработке, СуммаКОбработке, КоличествоОбрабатывается, СуммаОбрабатывается", 0,0,0,0);
	Поля = Итоги;
	Для Каждого Строка Из Строки Цикл
		Для Каждого КлючЗначение Из Поля Цикл
			Итоги[КлючЗначение.Ключ] = Итоги[КлючЗначение.Ключ] + Строка.Значение.Данные[КлючЗначение.Ключ];
		КонецЦикла;
	КонецЦикла;
	
	Если Настройки.ДополнительныеСвойства.Итоги.Количество() = 0 Тогда
		Настройки.ДополнительныеСвойства.Итоги.Добавить();
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(Настройки.ДополнительныеСвойства.Итоги[0], Итоги);
	
КонецПроцедуры

