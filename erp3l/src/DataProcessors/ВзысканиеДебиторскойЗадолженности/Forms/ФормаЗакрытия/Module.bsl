
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Претензия = Параметры.Претензия;
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ЗакрытьПретензию(Команда)
	Результат = ЗакрытьПретензиюНаСервере(Претензия, Причина);
	ОповеститьОЗаписиНового(Результат);
	Закрыть();
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервереБезКонтекста
Функция ЗакрытьПретензиюНаСервере(Претензия, Причина)
	ДокументЗакрытия = Документы.ИзменениеПретензии.СоздатьДокумент();
	ДокументЗакрытия.Заполнить(Претензия);
	ДокументЗакрытия.Дата = ТекущаяДатаСеанса();
	ДокументЗакрытия.ПричинаЗакрытия = Причина;
	ДокументЗакрытия.ЭтапПретензии = Справочники.ЭтапыПретензионноИсковойРаботы.Закрыта;
	ДокументЗакрытия.Записать();
	Возврат ДокументЗакрытия.Ссылка;
КонецФункции

#КонецОбласти