
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
		
	Параметры_ = ПолучитьИзВременногоХранилища(Параметры.АдресПараметров);
	АдресТекущихПараметров = Параметры.АдресПараметров;
	Если  Параметры_.Свойство("Исполняющий") Тогда
		Исполнитель = Параметры_.Исполняющий;
		Элементы.Согласование.Видимость = Ложь;
	ИначеЕсли Параметры_.Свойство("Согласование") Тогда	
		Согласование = Параметры_.Согласование;
		Элементы.Исполнитель.Видимость = Ложь;
	КонецЕсли;
	
	ТипОбъектаСогласования = Параметры.ТипОбъектаСогласования;
	
	
КонецПроцедуры


&НаКлиенте
Процедура Применить(Команда)
	
	ЗаписатьТекущиеДанные();	
	Закрыть();
		
КонецПроцедуры


Функция ЗаписатьТекущиеДанные()
	
	ТекущиеПарамтеры = ПолучитьИзВременногоХранилища(АдресТекущихПараметров);
		
	НаборПолномочия = РегистрыСведений.РегистрМатрицыПолномочий.СоздатьНаборЗаписей();
	НаборПолномочия.Отбор.ДокументБД.Установить(ТекущиеПарамтеры.ДокументБД);
	НаборПолномочия.Отбор.ШаблонДокументаБД.Установить(ТекущиеПарамтеры.ШаблонДокументаБД); 
	НаборПолномочия.Отбор.ВерсияРегламентаПодготовкиОтчетности.Установить(ТекущиеПарамтеры.ВерсияРегламентаПодготовкиОтчетности);
	Если Не ТекущиеПарамтеры.Бланк = Неопределено Тогда
		НаборПолномочия.Отбор.Бланк.Установить(ТекущиеПарамтеры.Бланк);
	КонецЕсли;
	Если Не ТекущиеПарамтеры.Проект = Неопределено Тогда
		НаборПолномочия.Отбор.Проект.Установить(ТекущиеПарамтеры.Проект);
	КонецЕсли;
	Если Не ТекущиеПарамтеры.Организация = Неопределено Тогда
		НаборПолномочия.Отбор.Организация.Установить(ТекущиеПарамтеры.Организация);
	КонецЕсли;

	НаборПолномочия.Прочитать();
	Если НаборПолномочия.Количество() =0 Тогда
		Нзп = НаборПолномочия.Добавить();
	Иначе
		Нзп = НаборПолномочия[0];	
	КонецЕсли;
	ЗаполнитьЗначенияСвойств(Нзп,ТекущиеПарамтеры);
	Если  ТекущиеПарамтеры.Свойство("Исполняющий") Тогда
		Нзп.Исполняющий = Исполнитель;
	ИначеЕсли ТекущиеПарамтеры.Свойство("Согласование") Тогда	
		Нзп.Согласование = Согласование;
	КонецЕсли;
	НаборПолномочия.Записать(Истина);
	
КонецФункции	


