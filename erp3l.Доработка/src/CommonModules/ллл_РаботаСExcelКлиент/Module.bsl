#Область ОбщиеПроцедурыИФункции
Функция ВыбратьФайлExcel() экспорт
	Д=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	Д.Фильтр="Файл excel (*.xls*)|*.xls?";
	Если д.Выбрать() тогда
		возврат(д.ПолноеИмяФайла);
	КонецЕсли;	
	
КонецФункции


Функция ПолучитьАктивныйЛистЕксель(путь) экспорт 
	//exc=Новый COMОбъект("Excel.Application"); 
	
	//exc.WorkBooks.Open(Путь);
	exc=ПолучитьCOmОбъект(Путь);
	возврат(exc.ActiveSheet());

КонецФункции 


Функция ПолучитьИменаСтолбцовExcel(ws) экспорт
	МассивИменСтолбцов=новый Массив();
	
	Счетчик=0;
	
	текЗначение=ws.Cells(1,Счетчик+1).Value;
	пока ЗначениеЗаполнено(текЗначение) цикл 
		Если типЗнч(текЗначение)=тип("Строка") тогда
			МассивИменСтолбцов.Добавить(текЗначение);
		иначе
				МассивИменСтолбцов.Добавить("");
		КонецЕсли;
		
		Счетчик=Счетчик+1;                  
		текЗначение=ws.Cells(1,Счетчик+1).Value; 
		
	КонецЦикла;	
	
	возврат(МассивИменСтолбцов);	
	
	
	
КонецФункции	


#КонецОбласти


