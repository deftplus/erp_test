
&НаСервере
&Вместо("ОбновитьСведенияОЛимитах")
Процедура ллл_ОбновитьСведенияОЛимитах()
	
	Если Объект.Ссылка.Пустая() Тогда
		ЕстьПревышениеЛимитов = Ложь;
	Иначе
		
		Запрос = Новый Запрос;
		Запрос.Текст =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
		|	ЗаявкаНаРасходованиеДенежныхСредств.Ссылка КАК Ссылка
		|ИЗ
		|	Документ.ЗаявкаНаРасходованиеДенежныхСредств КАК ЗаявкаНаРасходованиеДенежныхСредств
		|ГДЕ
		|	ЗаявкаНаРасходованиеДенежныхСредств.Проведен
		|	И ЗаявкаНаРасходованиеДенежныхСредств.Проект = &Проект
		|	И ЗаявкаНаРасходованиеДенежныхСредств.ЕстьПревышениеЛимитов
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ ПЕРВЫЕ 1
		|	ЗаявкаНаРасход.Ссылка
		|ИЗ
		|	Документ.ЗаявкаНаРасход КАК ЗаявкаНаРасход
		|ГДЕ
		|	ЗаявкаНаРасход.Проведен
		|	И ЗаявкаНаРасход.Проект = &Проект
		|	И ЗаявкаНаРасход.ЕстьПревышениеЛимитов
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ ПЕРВЫЕ 1
		|	ПланируемыйДоход.Ссылка
		|ИЗ
		|	Документ.ПланируемыйДоход КАК ПланируемыйДоход
		|ГДЕ
		|	ПланируемыйДоход.Проведен
		|	И ПланируемыйДоход.Проект = &Проект
		|	И ПланируемыйДоход.ЕстьПревышениеЛимитов
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ ПЕРВЫЕ 1
		|	ОперативныйПланПоБюджетамОбороты.ДокументПланирования
		|ИЗ
		|	РегистрНакопления.ОперативныйПланПоБюджетам.Обороты(, , Период, Проект = &Проект) КАК ОперативныйПланПоБюджетамОбороты
		|ГДЕ
		|	ВЫРАЗИТЬ(ОперативныйПланПоБюджетамОбороты.ДокументПланирования КАК Документ.ОперативныйПлан).ЕстьПревышениеЛимитов = ИСТИНА";
		Запрос.УстановитьПараметр("Проект", Объект.Ссылка);
		УстановитьПривилегированныйРежим(ИСТИНА);//+++ ERP1C-234 Стрепков К. 09.08.2022
		ЕстьПревышениеЛимитов = Не Запрос.Выполнить().Пустой();
		УстановитьПривилегированныйРежим(ЛОЖЬ); //+++ ERP1C-234 Стрепков К. 09.08.2022
	КонецЕсли;
	
	Элементы.ГруппаЕстьПревышениеЛимитов.Видимость = ЕстьПревышениеЛимитов;
	Элементы.ГруппаНетПревышенияЛимитов.Видимость = Не ЕстьПревышениеЛимитов;

КонецПроцедуры
